(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["Doka"]=e(require("vue")):t["Doka"]=e(t["Vue"])})("undefined"!==typeof self?self:this,function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fae3")}({"014b":function(t,e,n){"use strict";var r=n("e53d"),i=n("07e3"),o=n("8e60"),a=n("63b6"),c=n("9138"),u=n("ebfd").KEY,l=n("294c"),s=n("dbdb"),f=n("45f2"),d=n("62a0"),h=n("5168"),p=n("ccb9"),v=n("6718"),g=n("47ee"),m=n("9003"),y=n("e4ae"),E=n("f772"),_=n("36c3"),w=n("1bc3"),T=n("aebd"),x=n("a159"),R=n("0395"),b=n("bf0b"),A=n("d9f6"),I=n("c3a1"),C=b.f,S=A.f,O=R.f,L=r.Symbol,M=r.JSON,P=M&&M.stringify,G="prototype",k=h("_hidden"),D=h("toPrimitive"),U={}.propertyIsEnumerable,N=s("symbol-registry"),V=s("symbols"),B=s("op-symbols"),F=Object[G],z="function"==typeof L,W=r.QObject,q=!W||!W[G]||!W[G].findChild,Y=o&&l(function(){return 7!=x(S({},"a",{get:function(){return S(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=C(F,e);r&&delete F[e],S(t,e,n),r&&t!==F&&S(F,e,r)}:S,H=function(t){var e=V[t]=x(L[G]);return e._k=t,e},j=z&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},Z=function(t,e,n){return t===F&&Z(B,e,n),y(t),e=w(e,!0),y(n),i(V,e)?(n.enumerable?(i(t,k)&&t[k][e]&&(t[k][e]=!1),n=x(n,{enumerable:T(0,!1)})):(i(t,k)||S(t,k,T(1,{})),t[k][e]=!0),Y(t,e,n)):S(t,e,n)},X=function(t,e){y(t);var n,r=g(e=_(e)),i=0,o=r.length;while(o>i)Z(t,n=r[i++],e[n]);return t},K=function(t,e){return void 0===e?x(t):X(x(t),e)},$=function(t){var e=U.call(this,t=w(t,!0));return!(this===F&&i(V,t)&&!i(B,t))&&(!(e||!i(this,t)||!i(V,t)||i(this,k)&&this[k][t])||e)},Q=function(t,e){if(t=_(t),e=w(e,!0),t!==F||!i(V,e)||i(B,e)){var n=C(t,e);return!n||!i(V,e)||i(t,k)&&t[k][e]||(n.enumerable=!0),n}},J=function(t){var e,n=O(_(t)),r=[],o=0;while(n.length>o)i(V,e=n[o++])||e==k||e==u||r.push(e);return r},tt=function(t){var e,n=t===F,r=O(n?B:_(t)),o=[],a=0;while(r.length>a)!i(V,e=r[a++])||n&&!i(F,e)||o.push(V[e]);return o};z||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===F&&e.call(B,n),i(this,k)&&i(this[k],t)&&(this[k][t]=!1),Y(this,t,T(1,n))};return o&&q&&Y(F,t,{configurable:!0,set:e}),H(t)},c(L[G],"toString",function(){return this._k}),b.f=Q,A.f=Z,n("6abf").f=R.f=J,n("355d").f=$,n("9aa9").f=tt,o&&!n("b8e3")&&c(F,"propertyIsEnumerable",$,!0),p.f=function(t){return H(h(t))}),a(a.G+a.W+a.F*!z,{Symbol:L});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)h(et[nt++]);for(var rt=I(h.store),it=0;rt.length>it;)v(rt[it++]);a(a.S+a.F*!z,"Symbol",{for:function(t){return i(N,t+="")?N[t]:N[t]=L(t)},keyFor:function(t){if(!j(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),a(a.S+a.F*!z,"Object",{create:K,defineProperty:Z,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:J,getOwnPropertySymbols:tt}),M&&a(a.S+a.F*(!z||l(function(){var t=L();return"[null]"!=P([t])||"{}"!=P({a:t})||"{}"!=P(Object(t))})),"JSON",{stringify:function(t){var e,n,r=[t],i=1;while(arguments.length>i)r.push(arguments[i++]);if(n=e=r[1],(E(e)||void 0!==t)&&!j(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!j(e))return e}),r[1]=e,P.apply(M,r)}}),L[G][D]||n("35e8")(L[G],D,L[G].valueOf),f(L,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},"01f9":function(t,e,n){"use strict";var r=n("2d00"),i=n("5ca1"),o=n("2aba"),a=n("32e9"),c=n("84f2"),u=n("41a0"),l=n("7f20"),s=n("38fd"),f=n("2b4c")("iterator"),d=!([].keys&&"next"in[].keys()),h="@@iterator",p="keys",v="values",g=function(){return this};t.exports=function(t,e,n,m,y,E,_){u(n,e,m);var w,T,x,R=function(t){if(!d&&t in C)return C[t];switch(t){case p:return function(){return new n(this,t)};case v:return function(){return new n(this,t)}}return function(){return new n(this,t)}},b=e+" Iterator",A=y==v,I=!1,C=t.prototype,S=C[f]||C[h]||y&&C[y],O=S||R(y),L=y?A?R("entries"):O:void 0,M="Array"==e&&C.entries||S;if(M&&(x=s(M.call(new t)),x!==Object.prototype&&x.next&&(l(x,b,!0),r||"function"==typeof x[f]||a(x,f,g))),A&&S&&S.name!==v&&(I=!0,O=function(){return S.call(this)}),r&&!_||!d&&!I&&C[f]||a(C,f,O),c[e]=O,c[b]=g,y)if(w={values:A?O:R(v),keys:E?O:R(p),entries:L},_)for(T in w)T in C||o(C,T,w[T]);else i(i.P+i.F*(d||I),e,w);return w}},"02f4":function(t,e,n){var r=n("4588"),i=n("be13");t.exports=function(t){return function(e,n){var o,a,c=String(i(e)),u=r(n),l=c.length;return u<0||u>=l?t?"":void 0:(o=c.charCodeAt(u),o<55296||o>56319||u+1===l||(a=c.charCodeAt(u+1))<56320||a>57343?t?c.charAt(u):o:t?c.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var r=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"0395":function(t,e,n){var r=n("36c3"),i=n("6abf").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?c(t):i(r(t))}},"03cc":function(t,e,n){t.exports=n("e5b8")},"07e3":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"09fa":function(t,e,n){var r=n("4588"),i=n("9def");t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},"0a0d":function(t,e,n){t.exports=n("e829")},"0a49":function(t,e,n){var r=n("9b43"),i=n("626a"),o=n("4bf8"),a=n("9def"),c=n("cd1c");t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,s=4==t,f=6==t,d=5==t||f,h=e||c;return function(e,c,p){for(var v,g,m=o(e),y=i(m),E=r(c,p,3),_=a(y.length),w=0,T=n?h(e,_):u?h(e,0):void 0;_>w;w++)if((d||w in y)&&(v=y[w],g=E(v,w,m),t))if(n)T[w]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return w;case 2:T.push(v)}else if(s)return!1;return f?-1:l||s?s:T}}},"0a90":function(t,e,n){var r=n("63b6"),i=n("10ff");r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},"0b21":function(t,e,n){var r=n("5ca1");r(r.S,"Math",{sign:n("96fb")})},"0bfb":function(t,e,n){"use strict";var r=n("cb7c");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,n){var r=n("ce10"),i=n("e11e");t.exports=Object.keys||function(t){return r(t,i)}},"0f88":function(t,e,n){var r,i=n("7726"),o=n("32e9"),a=n("ca5a"),c=a("typed_array"),u=a("view"),l=!(!i.ArrayBuffer||!i.DataView),s=l,f=0,d=9,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");while(f<d)(r=i[h[f++]])?(o(r.prototype,c,!0),o(r.prototype,u,!0)):s=!1;t.exports={ABV:l,CONSTR:s,TYPED:c,VIEW:u}},"0fc9":function(t,e,n){var r=n("3a38"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},"10ff":function(t,e,n){var r=n("e53d").parseFloat,i=n("a1ce").trim;t.exports=1/r(n("e692")+"-0")!==-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},1169:function(t,e,n){var r=n("2d95");t.exports=Array.isArray||function(t){return"Array"==r(t)}},1173:function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},"11e9":function(t,e,n){var r=n("52a7"),i=n("4630"),o=n("6821"),a=n("6a99"),c=n("69a8"),u=n("c69a"),l=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(n){}if(c(t,e))return i(!r.f.call(t,e),t[e])}},1271:function(t,e,n){n("ce7e")("getOwnPropertyNames",function(){return n("0395").f})},1495:function(t,e,n){var r=n("86cc"),i=n("cb7c"),o=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),c=a.length,u=0;while(c>u)r.f(t,n=a[u++],e[n]);return t}},1654:function(t,e,n){"use strict";var r=n("71c1")(!0);n("30f1")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},1691:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"1af6":function(t,e,n){var r=n("63b6");r(r.S,"Array",{isArray:n("9003")})},"1bc3":function(t,e,n){var r=n("f772");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(t,e,n){var r=n("f772"),i=n("e53d").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"20d6":function(t,e,n){"use strict";var r=n("5ca1"),i=n("0a49")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"20fd":function(t,e,n){"use strict";var r=n("d9f6"),i=n("aebd");t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},"214f":function(t,e,n){"use strict";n("b0c5");var r=n("2aba"),i=n("32e9"),o=n("79e5"),a=n("be13"),c=n("2b4c"),u=n("520a"),l=c("species"),s=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=c(t),h=!o(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),p=h?!o(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[l]=function(){return n}),n[d](""),!e}):void 0;if(!h||!p||"replace"===t&&!s||"split"===t&&!f){var v=/./[d],g=n(a,d,""[t],function(t,e,n,r,i){return e.exec===u?h&&!i?{done:!0,value:v.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),m=g[0],y=g[1];r(String.prototype,t,m),i(RegExp.prototype,d,2==e?function(t,e){return y.call(t,this,e)}:function(t){return y.call(t,this)})}}},"230e":function(t,e,n){var r=n("d3f4"),i=n("7726").document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},"23c6":function(t,e,n){var r=n("2d95"),i=n("2b4c")("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),i))?n:o?r(e):"Object"==(c=r(e))&&"function"==typeof e.callee?"Arguments":c}},"241e":function(t,e,n){var r=n("25eb");t.exports=function(t){return Object(r(t))}},"24c5":function(t,e,n){"use strict";var r,i,o,a,c=n("b8e3"),u=n("e53d"),l=n("d864"),s=n("40c3"),f=n("63b6"),d=n("f772"),h=n("79aa"),p=n("1173"),v=n("a22a"),g=n("f201"),m=n("4178").set,y=n("aba2")(),E=n("656e"),_=n("4439"),w=n("bc13"),T=n("cd78"),x="Promise",R=u.TypeError,b=u.process,A=b&&b.versions,I=A&&A.v8||"",C=u[x],S="process"==s(b),O=function(){},L=i=E.f,M=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[n("5168")("species")]=function(t){t(O,O)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(O)instanceof e&&0!==I.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(r){}}(),P=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},G=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,c=i?e.ok:e.fail,u=e.resolve,l=e.reject,s=e.domain;try{c?(i||(2==t._h&&U(t),t._h=1),!0===c?n=r:(s&&s.enter(),n=c(r),s&&(s.exit(),a=!0)),n===e.promise?l(R("Promise-chain cycle")):(o=P(n))?o.call(n,u,l):u(n)):l(r)}catch(f){s&&!a&&s.exit(),l(f)}};while(n.length>o)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&k(t)})}},k=function(t){m.call(u,function(){var e,n,r,i=t._v,o=D(t);if(o&&(e=_(function(){S?b.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=S||D(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},U=function(t){m.call(u,function(){var e;S?b.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},N=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),G(e,!0))},V=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw R("Promise can't be resolved itself");(e=P(t))?y(function(){var r={_w:n,_d:!1};try{e.call(t,l(V,r,1),l(N,r,1))}catch(i){N.call(r,i)}}):(n._v=t,n._s=1,G(n,!1))}catch(r){N.call({_w:n,_d:!1},r)}}};M||(C=function(t){p(this,C,x,"_h"),h(t),r.call(this);try{t(l(V,this,1),l(N,this,1))}catch(e){N.call(this,e)}},r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n("5c95")(C.prototype,{then:function(t,e){var n=L(g(this,C));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=S?b.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&G(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=l(V,t,1),this.reject=l(N,t,1)},E.f=L=function(t){return t===C||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!M,{Promise:C}),n("45f2")(C,x),n("4c95")(x),a=n("584a")[x],f(f.S+f.F*!M,x,{reject:function(t){var e=L(this),n=e.reject;return n(t),e.promise}}),f(f.S+f.F*(c||!M),x,{resolve:function(t){return T(c&&this===a?C:this,t)}}),f(f.S+f.F*!(M&&n("4ee1")(function(t){C.all(t)["catch"](O)})),x,{all:function(t){var e=this,n=L(e),r=n.resolve,i=n.reject,o=_(function(){var n=[],o=0,a=1;v(t,!1,function(t){var c=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[c]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=L(e),r=n.reject,i=_(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},"25eb":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},"268f":function(t,e,n){t.exports=n("fde4")},"27ee":function(t,e,n){var r=n("23c6"),i=n("2b4c")("iterator"),o=n("84f2");t.exports=n("8378").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},"28a5":function(t,e,n){"use strict";var r=n("aae3"),i=n("cb7c"),o=n("ebd6"),a=n("0390"),c=n("9def"),u=n("5f1b"),l=n("520a"),s=n("79e5"),f=Math.min,d=[].push,h="split",p="length",v="lastIndex",g=4294967295,m=!s(function(){RegExp(g,"y")});n("214f")("split",2,function(t,e,n,s){var y;return y="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[p]||2!="ab"[h](/(?:ab)*/)[p]||4!="."[h](/(.?)(.?)/)[p]||"."[h](/()()/)[p]>1||""[h](/.?/)[p]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);var o,a,c,u=[],s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,h=void 0===e?g:e>>>0,m=new RegExp(t.source,s+"g");while(o=l.call(m,i)){if(a=m[v],a>f&&(u.push(i.slice(f,o.index)),o[p]>1&&o.index<i[p]&&d.apply(u,o.slice(1)),c=o[0][p],f=a,u[p]>=h))break;m[v]===o.index&&m[v]++}return f===i[p]?!c&&m.test("")||u.push(""):u.push(i.slice(f)),u[p]>h?u.slice(0,h):u}:"0"[h](void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,i,r):y.call(String(i),n,r)},function(t,e){var r=s(y,t,this,e,y!==n);if(r.done)return r.value;var l=i(t),d=String(this),h=o(l,RegExp),p=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(m?"y":"g"),E=new h(m?l:"^(?:"+l.source+")",v),_=void 0===e?g:e>>>0;if(0===_)return[];if(0===d.length)return null===u(E,d)?[d]:[];var w=0,T=0,x=[];while(T<d.length){E.lastIndex=m?T:0;var R,b=u(E,m?d:d.slice(T));if(null===b||(R=f(c(E.lastIndex+(m?0:T)),d.length))===w)T=a(d,T,p);else{if(x.push(d.slice(w,T)),x.length===_)return x;for(var A=1;A<=b.length-1;A++)if(x.push(b[A]),x.length===_)return x;T=w=R}}return x.push(d.slice(w)),x}]})},"294c":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"2aba":function(t,e,n){var r=n("7726"),i=n("32e9"),o=n("69a8"),a=n("ca5a")("src"),c=n("fa5b"),u="toString",l=(""+c).split(u);n("8378").inspectSource=function(t){return c.call(t)},(t.exports=function(t,e,n,c){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:l.join(String(e)))),t===r?t[e]=n:c?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,u,function(){return"function"==typeof this&&this[a]||c.call(this)})},"2aeb":function(t,e,n){var r=n("cb7c"),i=n("1495"),o=n("e11e"),a=n("613b")("IE_PROTO"),c=function(){},u="prototype",l=function(){var t,e=n("230e")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),l=t.F;while(r--)delete l[u][o[r]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(c[u]=r(t),n=new c,c[u]=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},"2b4c":function(t,e,n){var r=n("5537")("wks"),i=n("ca5a"),o=n("7726").Symbol,a="function"==typeof o,c=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};c.store=r},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"2f21":function(t,e,n){"use strict";var r=n("79e5");t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},"2f37":function(t,e,n){var r=n("63b6");r(r.S,"Date",{now:function(){return(new Date).getTime()}})},"2fdb":function(t,e,n){"use strict";var r=n("5ca1"),i=n("d2c8"),o="includes";r(r.P+r.F*n("5147")(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},3024:function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},"30f1":function(t,e,n){"use strict";var r=n("b8e3"),i=n("63b6"),o=n("9138"),a=n("35e8"),c=n("481b"),u=n("8f60"),l=n("45f2"),s=n("53e2"),f=n("5168")("iterator"),d=!([].keys&&"next"in[].keys()),h="@@iterator",p="keys",v="values",g=function(){return this};t.exports=function(t,e,n,m,y,E,_){u(n,e,m);var w,T,x,R=function(t){if(!d&&t in C)return C[t];switch(t){case p:return function(){return new n(this,t)};case v:return function(){return new n(this,t)}}return function(){return new n(this,t)}},b=e+" Iterator",A=y==v,I=!1,C=t.prototype,S=C[f]||C[h]||y&&C[y],O=S||R(y),L=y?A?R("entries"):O:void 0,M="Array"==e&&C.entries||S;if(M&&(x=s(M.call(new t)),x!==Object.prototype&&x.next&&(l(x,b,!0),r||"function"==typeof x[f]||a(x,f,g))),A&&S&&S.name!==v&&(I=!0,O=function(){return S.call(this)}),r&&!_||!d&&!I&&C[f]||a(C,f,O),c[e]=O,c[b]=g,y)if(w={values:A?O:R(v),keys:E?O:R(p),entries:L},_)for(T in w)T in C||o(C,T,w[T]);else i(i.P+i.F*(d||I),e,w);return w}},"32a6":function(t,e,n){var r=n("241e"),i=n("c3a1");n("ce7e")("keys",function(){return function(t){return i(r(t))}})},"32e9":function(t,e,n){var r=n("86cc"),i=n("4630");t.exports=n("9e1e")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"32fc":function(t,e,n){var r=n("e53d").document;t.exports=r&&r.documentElement},"335c":function(t,e,n){var r=n("6b4c");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"33a4":function(t,e,n){var r=n("84f2"),i=n("2b4c")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},"34ef":function(t,e,n){n("ec30")("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},"355d":function(t,e){e.f={}.propertyIsEnumerable},"35e8":function(t,e,n){var r=n("d9f6"),i=n("aebd");t.exports=n("8e60")?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"36bd":function(t,e,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");t.exports=function(t){var e=r(this),n=o(e.length),a=arguments.length,c=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,l=void 0===u?n:i(u,n);while(l>c)e[c++]=t;return e}},"36c3":function(t,e,n){var r=n("335c"),i=n("25eb");t.exports=function(t){return r(i(t))}},3702:function(t,e,n){var r=n("481b"),i=n("5168")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},"386b":function(t,e,n){var r=n("5ca1"),i=n("79e5"),o=n("be13"),a=/"/g,c=function(t,e,n,r){var i=String(o(t)),c="<"+e;return""!==n&&(c+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),c+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(c),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},"38fd":function(t,e,n){var r=n("69a8"),i=n("4bf8"),o=n("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"3a38":function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"3b2b":function(t,e,n){var r=n("7726"),i=n("5dbc"),o=n("86cc").f,a=n("9093").f,c=n("aae3"),u=n("0bfb"),l=r.RegExp,s=l,f=l.prototype,d=/a/g,h=/a/g,p=new l(d)!==d;if(n("9e1e")&&(!p||n("79e5")(function(){return h[n("2b4c")("match")]=!1,l(d)!=d||l(h)==h||"/a/i"!=l(d,"i")}))){l=function(t,e){var n=this instanceof l,r=c(t),o=void 0===e;return!n&&r&&t.constructor===l&&o?t:i(p?new s(r&&!o?t.source:t,e):s((r=t instanceof l)?t.source:t,r&&o?u.call(t):e),n?this:f,l)};for(var v=function(t){t in l||o(l,t,{configurable:!0,get:function(){return s[t]},set:function(e){s[t]=e}})},g=a(s),m=0;g.length>m;)v(g[m++]);f.constructor=l,l.prototype=f,n("2aba")(r,"RegExp",l)}n("7a56")("RegExp")},"3c11":function(t,e,n){"use strict";var r=n("63b6"),i=n("584a"),o=n("e53d"),a=n("f201"),c=n("cd78");r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return c(e,t()).then(function(){return n})}:t,n?function(n){return c(e,t()).then(function(){throw n})}:t)}})},"40c3":function(t,e,n){var r=n("6b4c"),i=n("5168")("toStringTag"),o="Arguments"==r(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=a(e=Object(t),i))?n:o?r(e):"Object"==(c=r(e))&&"function"==typeof e.callee?"Arguments":c}},4178:function(t,e,n){var r,i,o,a=n("d864"),c=n("3024"),u=n("32fc"),l=n("1ec9"),s=n("e53d"),f=s.process,d=s.setImmediate,h=s.clearImmediate,p=s.MessageChannel,v=s.Dispatch,g=0,m={},y="onreadystatechange",E=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},_=function(t){E.call(t.data)};d&&h||(d=function(t){var e=[],n=1;while(arguments.length>n)e.push(arguments[n++]);return m[++g]=function(){c("function"==typeof t?t:Function(t),e)},r(g),g},h=function(t){delete m[t]},"process"==n("6b4c")(f)?r=function(t){f.nextTick(a(E,t,1))}:v&&v.now?r=function(t){v.now(a(E,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(r=function(t){s.postMessage(t+"","*")},s.addEventListener("message",_,!1)):r=y in l("script")?function(t){u.appendChild(l("script"))[y]=function(){u.removeChild(this),E.call(t)}}:function(t){setTimeout(a(E,t,1),0)}),t.exports={set:d,clear:h}},"41a0":function(t,e,n){"use strict";var r=n("2aeb"),i=n("4630"),o=n("7f20"),a={};n("32e9")(a,n("2b4c")("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},"43fc":function(t,e,n){"use strict";var r=n("63b6"),i=n("656e"),o=n("4439");r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},4439:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(e){return{e:!0,v:e}}}},"454f":function(t,e,n){n("46a7");var r=n("584a").Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},4588:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},"45f2":function(t,e,n){var r=n("d9f6").f,i=n("07e3"),o=n("5168")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"46a7":function(t,e,n){var r=n("63b6");r(r.S+r.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},"47ee":function(t,e,n){var r=n("c3a1"),i=n("9aa9"),o=n("355d");t.exports=function(t){var e=r(t),n=i.f;if(n){var a,c=n(t),u=o.f,l=0;while(c.length>l)u.call(t,a=c[l++])&&e.push(a)}return e}},"481b":function(t,e){t.exports={}},4917:function(t,e,n){"use strict";var r=n("cb7c"),i=n("9def"),o=n("0390"),a=n("5f1b");n("214f")("match",1,function(t,e,n,c){return[function(n){var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=c(n,t,this);if(e.done)return e.value;var u=r(t),l=String(this);if(!u.global)return a(u,l);var s=u.unicode;u.lastIndex=0;var f,d=[],h=0;while(null!==(f=a(u,l))){var p=String(f[0]);d[h]=p,""===p&&(u.lastIndex=o(l,i(u.lastIndex),s)),h++}return 0===h?null:d}]})},"4bf8":function(t,e,n){var r=n("be13");t.exports=function(t){return Object(r(t))}},"4c95":function(t,e,n){"use strict";var r=n("e53d"),i=n("584a"),o=n("d9f6"),a=n("8e60"),c=n("5168")("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:r[t];a&&e&&!e[c]&&o.f(e,c,{configurable:!0,get:function(){return this}})}},"4ee1":function(t,e,n){var r=n("5168")("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],c=o[r]();c.next=function(){return{done:n=!0}},o[r]=function(){return c},t(o)}catch(a){}return n}},"50ed":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},5147:function(t,e,n){var r=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(i){}}return!0}},5168:function(t,e,n){var r=n("dbdb")("wks"),i=n("62a0"),o=n("e53d").Symbol,a="function"==typeof o,c=t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))};c.store=r},5176:function(t,e,n){t.exports=n("51b6")},"51b6":function(t,e,n){n("a3c3"),t.exports=n("584a").Object.assign},"520a":function(t,e,n){"use strict";var r=n("0bfb"),i=RegExp.prototype.exec,o=String.prototype.replace,a=i,c="lastIndex",u=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t[c]||0!==e[c]}(),l=void 0!==/()??/.exec("")[1],s=u||l;s&&(a=function(t){var e,n,a,s,f=this;return l&&(n=new RegExp("^"+f.source+"$(?!\\s)",r.call(f))),u&&(e=f[c]),a=i.call(f,t),u&&a&&(f[c]=f.global?a.index+a[0].length:e),l&&a&&a.length>1&&o.call(a[0],n,function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(a[s]=void 0)}),a}),t.exports=a},"52a7":function(t,e){e.f={}.propertyIsEnumerable},"53e2":function(t,e,n){var r=n("07e3"),i=n("241e"),o=n("5559")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"549b":function(t,e,n){"use strict";var r=n("d864"),i=n("63b6"),o=n("241e"),a=n("b0dc"),c=n("3702"),u=n("b447"),l=n("20fd"),s=n("7cd6");i(i.S+i.F*!n("4ee1")(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,d=o(t),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,m=0,y=s(d);if(g&&(v=r(v,p>2?arguments[2]:void 0,2)),void 0==y||h==Array&&c(y))for(e=u(d.length),n=new h(e);e>m;m++)l(n,m,g?v(d[m],m):d[m]);else for(f=y.call(d),n=new h;!(i=f.next()).done;m++)l(n,m,g?a(f,v,[i.value,m],!0):i.value);return n.length=m,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},5537:function(t,e,n){var r=n("8378"),i=n("7726"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},5559:function(t,e,n){var r=n("dbdb")("keys"),i=n("62a0");t.exports=function(t){return r[t]||(r[t]=i(t))}},"55dd":function(t,e,n){"use strict";var r=n("5ca1"),i=n("d8e8"),o=n("4bf8"),a=n("79e5"),c=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n("2f21")(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},5755:function(t,e,n){},"584a":function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"59ad":function(t,e,n){t.exports=n("7be7")},"5b4e":function(t,e,n){var r=n("36c3"),i=n("b447"),o=n("0fc9");t.exports=function(t){return function(e,n,a){var c,u=r(e),l=i(u.length),s=o(a,l);if(t&&n!=n){while(l>s)if(c=u[s++],c!=c)return!0}else for(;l>s;s++)if((t||s in u)&&u[s]===n)return t||s||0;return!t&&-1}}},"5c95":function(t,e,n){var r=n("35e8");t.exports=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:r(t,i,e[i]);return t}},"5ca1":function(t,e,n){var r=n("7726"),i=n("8378"),o=n("32e9"),a=n("2aba"),c=n("9b43"),u="prototype",l=function(t,e,n){var s,f,d,h,p=t&l.F,v=t&l.G,g=t&l.S,m=t&l.P,y=t&l.B,E=v?r:g?r[e]||(r[e]={}):(r[e]||{})[u],_=v?i:i[e]||(i[e]={}),w=_[u]||(_[u]={});for(s in v&&(n=e),n)f=!p&&E&&void 0!==E[s],d=(f?E:n)[s],h=y&&f?c(d,r):m&&"function"==typeof d?c(Function.call,d):d,E&&a(E,s,d,t&l.U),_[s]!=d&&o(_,s,h),m&&w[s]!=d&&(w[s]=d)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"5cc5":function(t,e,n){var r=n("2b4c")("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],c=o[r]();c.next=function(){return{done:n=!0}},o[r]=function(){return c},t(o)}catch(a){}return n}},"5d58":function(t,e,n){t.exports=n("d8d6")},"5d6b":function(t,e,n){var r=n("e53d").parseInt,i=n("a1ce").trim,o=n("e692"),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},"5d73":function(t,e,n){t.exports=n("469f")},"5dbc":function(t,e,n){var r=n("d3f4"),i=n("8b97").set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},"5df3":function(t,e,n){"use strict";var r=n("02f4")(!0);n("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},"5f1b":function(t,e,n){"use strict";var r=n("23c6"),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"613b":function(t,e,n){var r=n("5537")("keys"),i=n("ca5a");t.exports=function(t){return r[t]||(r[t]=i(t))}},"626a":function(t,e,n){var r=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},"62a0":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},"63b6":function(t,e,n){var r=n("e53d"),i=n("584a"),o=n("d864"),a=n("35e8"),c=n("07e3"),u="prototype",l=function(t,e,n){var s,f,d,h=t&l.F,p=t&l.G,v=t&l.S,g=t&l.P,m=t&l.B,y=t&l.W,E=p?i:i[e]||(i[e]={}),_=E[u],w=p?r:v?r[e]:(r[e]||{})[u];for(s in p&&(n=e),n)f=!h&&w&&void 0!==w[s],f&&c(E,s)||(d=f?w[s]:n[s],E[s]=p&&"function"!=typeof w[s]?n[s]:m&&f?o(d,r):y&&w[s]==d?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[u]=t[u],e}(d):g&&"function"==typeof d?o(Function.call,d):d,g&&((E.virtual||(E.virtual={}))[s]=d,t&l.R&&_&&!_[s]&&a(_,s,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"63d9":function(t,e,n){n("ec30")("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},"656e":function(t,e,n){"use strict";var r=n("79aa");function i(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},6718:function(t,e,n){var r=n("e53d"),i=n("584a"),o=n("b8e3"),a=n("ccb9"),c=n("d9f6").f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||c(e,t,{value:a.f(t)})}},"673e":function(t,e,n){"use strict";n("386b")("sub",function(t){return function(){return t(this,"sub","","")}})},6762:function(t,e,n){"use strict";var r=n("5ca1"),i=n("c366")(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"67bb":function(t,e,n){t.exports=n("f921")},6821:function(t,e,n){var r=n("626a"),i=n("be13");t.exports=function(t){return r(i(t))}},"68a3":function(t,e,n){"use strict";var r=n("5755"),i=n.n(r);i.a},"696e":function(t,e,n){n("c207"),n("1654"),n("6c1c"),n("24c5"),n("3c11"),n("43fc"),t.exports=n("584a").Promise},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"69d3":function(t,e,n){n("6718")("asyncIterator")},"6a99":function(t,e,n){var r=n("d3f4");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"6aa2":function(t,e,n){n("ec30")("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},"6abf":function(t,e,n){var r=n("e6f3"),i=n("1691").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},"6b4c":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"6b54":function(t,e,n){"use strict";n("3846");var r=n("cb7c"),i=n("0bfb"),o=n("9e1e"),a="toString",c=/./[a],u=function(t){n("2aba")(RegExp.prototype,a,t,!0)};n("79e5")(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?u(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=a&&u(function(){return c.call(this)})},"6c1c":function(t,e,n){n("c367");for(var r=n("e53d"),i=n("35e8"),o=n("481b"),a=n("5168")("toStringTag"),c="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<c.length;u++){var l=c[u],s=r[l],f=s&&s.prototype;f&&!f[a]&&i(f,a,l),o[l]=o.Array}},"6c7b":function(t,e,n){var r=n("5ca1");r(r.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"71c1":function(t,e,n){var r=n("3a38"),i=n("25eb");t.exports=function(t){return function(e,n){var o,a,c=String(i(e)),u=r(n),l=c.length;return u<0||u>=l?t?"":void 0:(o=c.charCodeAt(u),o<55296||o>56319||u+1===l||(a=c.charCodeAt(u+1))<56320||a>57343?t?c.charAt(u):o:t?c.slice(u,u+2):a-56320+(o-55296<<10)+65536)}}},7445:function(t,e,n){var r=n("63b6"),i=n("5d6b");r(r.G+r.F*(parseInt!=i),{parseInt:i})},7514:function(t,e,n){"use strict";var r=n("5ca1"),i=n("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"765d":function(t,e,n){n("6718")("observable")},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"774e":function(t,e,n){t.exports=n("d2d5")},"77f1":function(t,e,n){var r=n("4588"),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},7872:function(t,e,n){var r=n("5ca1");r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},"794b":function(t,e,n){t.exports=!n("8e60")&&!n("294c")(function(){return 7!=Object.defineProperty(n("1ec9")("div"),"a",{get:function(){return 7}}).a})},"795b":function(t,e,n){t.exports=n("696e")},"79aa":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7a56":function(t,e,n){"use strict";var r=n("7726"),i=n("86cc"),o=n("9e1e"),a=n("2b4c")("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},"7be7":function(t,e,n){n("0a90"),t.exports=n("584a").parseFloat},"7cd6":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},"7d7b":function(t,e,n){var r=n("e4ae"),i=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},"7e90":function(t,e,n){var r=n("d9f6"),i=n("e4ae"),o=n("c3a1");t.exports=n("8e60")?Object.defineProperties:function(t,e){i(t);var n,a=o(e),c=a.length,u=0;while(c>u)r.f(t,n=a[u++],e[n]);return t}},"7f20":function(t,e,n){var r=n("86cc").f,i=n("69a8"),o=n("2b4c")("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},"7f7f":function(t,e,n){var r=n("86cc").f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n("9e1e")&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},8378:function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},8436:function(t,e){t.exports=function(){}},8449:function(t,e,n){"use strict";n("386b")("anchor",function(t){return function(e){return t(this,"a","name",e)}})},"84f2":function(t,e){t.exports={}},"85f2":function(t,e,n){t.exports=n("454f")},"86cc":function(t,e,n){var r=n("cb7c"),i=n("c69a"),o=n("6a99"),a=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"8aae":function(t,e,n){n("32a6"),t.exports=n("584a").Object.keys},"8b97":function(t,e,n){var r=n("d3f4"),i=n("cb7c"),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},"8bbf":function(e,n){e.exports=t},"8e60":function(t,e,n){t.exports=!n("294c")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"8f60":function(t,e,n){"use strict";var r=n("a159"),i=n("aebd"),o=n("45f2"),a={};n("35e8")(a,n("5168")("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},9003:function(t,e,n){var r=n("6b4c");t.exports=Array.isArray||function(t){return"Array"==r(t)}},9093:function(t,e,n){var r=n("ce10"),i=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},9138:function(t,e,n){t.exports=n("35e8")},9306:function(t,e,n){"use strict";var r=n("c3a1"),i=n("9aa9"),o=n("355d"),a=n("241e"),c=n("335c"),u=Object.assign;t.exports=!u||n("294c")(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){var n=a(t),u=arguments.length,l=1,s=i.f,f=o.f;while(u>l){var d,h=c(arguments[l++]),p=s?r(h).concat(s(h)):r(h),v=p.length,g=0;while(v>g)f.call(h,d=p[g++])&&(n[d]=h[d])}return n}:u},"95d5":function(t,e,n){var r=n("40c3"),i=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},"96e3":function(t,e,n){},"96fb":function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},"9aa9":function(t,e){e.f=Object.getOwnPropertySymbols},"9b43":function(t,e,n){var r=n("d8e8");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var r=n("2b4c")("unscopables"),i=Array.prototype;void 0==i[r]&&n("32e9")(i,r,{}),t.exports=function(t){i[r][t]=!0}},"9def":function(t,e,n){var r=n("4588"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},a159:function(t,e,n){var r=n("e4ae"),i=n("7e90"),o=n("1691"),a=n("5559")("IE_PROTO"),c=function(){},u="prototype",l=function(){var t,e=n("1ec9")("iframe"),r=o.length,i="<",a=">";e.style.display="none",n("32fc").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),l=t.F;while(r--)delete l[u][o[r]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(c[u]=r(t),n=new c,c[u]=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},a1ce:function(t,e,n){var r=n("63b6"),i=n("25eb"),o=n("294c"),a=n("e692"),c="["+a+"]",u="​",l=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),f=function(t,e,n){var i={},c=o(function(){return!!a[t]()||u[t]()!=u}),l=i[t]=c?e(d):a[t];n&&(i[n]=l),r(r.P+r.F*c,"String",i)},d=f.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(s,"")),t};t.exports=f},a21f:function(t,e,n){var r=n("584a"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},a22a:function(t,e,n){var r=n("d864"),i=n("b0dc"),o=n("3702"),a=n("e4ae"),c=n("b447"),u=n("7cd6"),l={},s={};e=t.exports=function(t,e,n,f,d){var h,p,v,g,m=d?function(){return t}:u(t),y=r(n,f,e?2:1),E=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(o(m)){for(h=c(t.length);h>E;E++)if(g=e?y(a(p=t[E])[0],p[1]):y(t[E]),g===l||g===s)return g}else for(v=m.call(t);!(p=v.next()).done;)if(g=i(v,y,p.value,e),g===l||g===s)return g};e.BREAK=l,e.RETURN=s},a3c3:function(t,e,n){var r=n("63b6");r(r.S+r.F,"Object",{assign:n("9306")})},a481:function(t,e,n){"use strict";var r=n("cb7c"),i=n("4bf8"),o=n("9def"),a=n("4588"),c=n("0390"),u=n("5f1b"),l=Math.max,s=Math.min,f=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,function(t,e,n,v){return[function(r,i){var o=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=v(n,t,this,e);if(i.done)return i.value;var f=r(t),d=String(this),h="function"===typeof e;h||(e=String(e));var m=f.global;if(m){var y=f.unicode;f.lastIndex=0}var E=[];while(1){var _=u(f,d);if(null===_)break;if(E.push(_),!m)break;var w=String(_[0]);""===w&&(f.lastIndex=c(d,o(f.lastIndex),y))}for(var T="",x=0,R=0;R<E.length;R++){_=E[R];for(var b=String(_[0]),A=l(s(a(_.index),d.length),0),I=[],C=1;C<_.length;C++)I.push(p(_[C]));var S=_.groups;if(h){var O=[b].concat(I,A,d);void 0!==S&&O.push(S);var L=String(e.apply(void 0,O))}else L=g(b,d,A,I,S,e);A>=x&&(T+=d.slice(x,A)+L,x=A+b.length)}return T+d.slice(x)}];function g(t,e,r,o,a,c){var u=r+t.length,l=o.length,s=h;return void 0!==a&&(a=i(a),s=d),n.call(c,s,function(n,i){var c;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":c=a[i.slice(1,-1)];break;default:var s=+i;if(0===s)return n;if(s>l){var d=f(s/10);return 0===d?n:d<=l?void 0===o[d-1]?i.charAt(1):o[d-1]+i.charAt(1):n}c=o[s-1]}return void 0===c?"":c})}})},a4bb:function(t,e,n){t.exports=n("8aae")},a745:function(t,e,n){t.exports=n("f410")},aae3:function(t,e,n){var r=n("d3f4"),i=n("2d95"),o=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},aba2:function(t,e,n){var r=n("e53d"),i=n("4178").set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,c=r.Promise,u="process"==n("6b4c")(a);t.exports=function(){var t,e,n,l=function(){var r,i;u&&(r=a.domain)&&r.exit();while(t){i=t.fn,t=t.next;try{i()}catch(o){throw t?n():e=void 0,o}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(l)};else if(!o||r.navigator&&r.navigator.standalone)if(c&&c.resolve){var s=c.resolve(void 0);n=function(){s.then(l)}}else n=function(){i.call(r,l)};else{var f=!0,d=document.createTextNode("");new o(l).observe(d,{characterData:!0}),n=function(){d.data=f=!f}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},ac6a:function(t,e,n){for(var r=n("cadf"),i=n("0d58"),o=n("2aba"),a=n("7726"),c=n("32e9"),u=n("84f2"),l=n("2b4c"),s=l("iterator"),f=l("toStringTag"),d=u.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(h),v=0;v<p.length;v++){var g,m=p[v],y=h[m],E=a[m],_=E&&E.prototype;if(_&&(_[s]||c(_,s,d),_[f]||c(_,f,m),u[m]=d,y))for(g in r)_[g]||o(_,g,r[g],!0)}},aebd:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},b0c5:function(t,e,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},b0dc:function(t,e,n){var r=n("e4ae");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw void 0!==o&&r(o.call(t)),a}}},b447:function(t,e,n){var r=n("3a38"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},b8e3:function(t,e){t.exports=!0},b9e9:function(t,e,n){n("7445"),t.exports=n("584a").parseInt},ba92:function(t,e,n){"use strict";var r=n("4bf8"),i=n("77f1"),o=n("9def");t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),c=i(t,a),u=i(e,a),l=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===l?a:i(l,a))-u,a-c),f=1;u<c&&c<u+s&&(f=-1,u+=s-1,c+=s-1);while(s-- >0)u in n?n[c]=n[u]:delete n[c],c+=f,u+=f;return n}},bc13:function(t,e,n){var r=n("e53d"),i=r.navigator;t.exports=i&&i.userAgent||""},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},bf0b:function(t,e,n){var r=n("355d"),i=n("aebd"),o=n("36c3"),a=n("1bc3"),c=n("07e3"),u=n("794b"),l=Object.getOwnPropertyDescriptor;e.f=n("8e60")?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(n){}if(c(t,e))return i(!r.f.call(t,e),t[e])}},bf90:function(t,e,n){var r=n("36c3"),i=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},c207:function(t,e){},c366:function(t,e,n){var r=n("6821"),i=n("9def"),o=n("77f1");t.exports=function(t){return function(e,n,a){var c,u=r(e),l=i(u.length),s=o(a,l);if(t&&n!=n){while(l>s)if(c=u[s++],c!=c)return!0}else for(;l>s;s++)if((t||s in u)&&u[s]===n)return t||s||0;return!t&&-1}}},c367:function(t,e,n){"use strict";var r=n("8436"),i=n("50ed"),o=n("481b"),a=n("36c3");t.exports=n("30f1")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},c3a1:function(t,e,n){var r=n("e6f3"),i=n("1691");t.exports=Object.keys||function(t){return r(t,i)}},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")(function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a})},c8bb:function(t,e,n){t.exports=n("54a1")},ca5a:function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},cadf:function(t,e,n){"use strict";var r=n("9c6c"),i=n("d53b"),o=n("84f2"),a=n("6821");t.exports=n("01f9")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},cb7c:function(t,e,n){var r=n("d3f4");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},ccb9:function(t,e,n){e.f=n("5168")},cd1c:function(t,e,n){var r=n("e853");t.exports=function(t,e){return new(r(t))(e)}},cd78:function(t,e,n){var r=n("e4ae"),i=n("f772"),o=n("656e");t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t),a=n.resolve;return a(e),n.promise}},ce10:function(t,e,n){var r=n("69a8"),i=n("6821"),o=n("c366")(!1),a=n("613b")("IE_PROTO");t.exports=function(t,e){var n,c=i(t),u=0,l=[];for(n in c)n!=a&&r(c,n)&&l.push(n);while(e.length>u)r(c,n=e[u++])&&(~o(l,n)||l.push(n));return l}},ce7e:function(t,e,n){var r=n("63b6"),i=n("584a"),o=n("294c");t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},d2c8:function(t,e,n){var r=n("aae3"),i=n("be13");t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d864:function(t,e,n){var r=n("79aa");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},d8d6:function(t,e,n){n("1654"),n("6c1c"),t.exports=n("ccb9").f("iterator")},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d9f6:function(t,e,n){var r=n("e4ae"),i=n("794b"),o=n("1bc3"),a=Object.defineProperty;e.f=n("8e60")?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},dbdb:function(t,e,n){var r=n("584a"),i=n("e53d"),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("b8e3")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},dcbc:function(t,e,n){var r=n("2aba");t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e265:function(t,e,n){t.exports=n("ed33")},e4ae:function(t,e,n){var r=n("f772");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},e53d:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},e5b8:function(t,e,n){n("1271");var r=n("584a").Object;t.exports=function(t){return r.getOwnPropertyNames(t)}},e692:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e6f3:function(t,e,n){var r=n("07e3"),i=n("36c3"),o=n("5b4e")(!1),a=n("5559")("IE_PROTO");t.exports=function(t,e){var n,c=i(t),u=0,l=[];for(n in c)n!=a&&r(c,n)&&l.push(n);while(e.length>u)r(c,n=e[u++])&&(~o(l,n)||l.push(n));return l}},e814:function(t,e,n){t.exports=n("b9e9")},e829:function(t,e,n){n("2f37"),t.exports=n("584a").Date.now},e853:function(t,e,n){var r=n("d3f4"),i=n("1169"),o=n("2b4c")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},ebd6:function(t,e,n){var r=n("cb7c"),i=n("d8e8"),o=n("2b4c")("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},ebfd:function(t,e,n){var r=n("62a0")("meta"),i=n("f772"),o=n("07e3"),a=n("d9f6").f,c=0,u=Object.isExtensible||function(){return!0},l=!n("294c")(function(){return u(Object.preventExtensions({}))}),s=function(t){a(t,r,{value:{i:"O"+ ++c,w:{}}})},f=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";s(t)}return t[r].i},d=function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;s(t)}return t[r].w},h=function(t){return l&&p.NEED&&u(t)&&!o(t,r)&&s(t),t},p=t.exports={KEY:r,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},ec30:function(t,e,n){"use strict";if(n("9e1e")){var r=n("2d00"),i=n("7726"),o=n("79e5"),a=n("5ca1"),c=n("0f88"),u=n("ed0b"),l=n("9b43"),s=n("f605"),f=n("4630"),d=n("32e9"),h=n("dcbc"),p=n("4588"),v=n("9def"),g=n("09fa"),m=n("77f1"),y=n("6a99"),E=n("69a8"),_=n("23c6"),w=n("d3f4"),T=n("4bf8"),x=n("33a4"),R=n("2aeb"),b=n("38fd"),A=n("9093").f,I=n("27ee"),C=n("ca5a"),S=n("2b4c"),O=n("0a49"),L=n("c366"),M=n("ebd6"),P=n("cadf"),G=n("84f2"),k=n("5cc5"),D=n("7a56"),U=n("36bd"),N=n("ba92"),V=n("86cc"),B=n("11e9"),F=V.f,z=B.f,W=i.RangeError,q=i.TypeError,Y=i.Uint8Array,H="ArrayBuffer",j="Shared"+H,Z="BYTES_PER_ELEMENT",X="prototype",K=Array[X],$=u.ArrayBuffer,Q=u.DataView,J=O(0),tt=O(2),et=O(3),nt=O(4),rt=O(5),it=O(6),ot=L(!0),at=L(!1),ct=P.values,ut=P.keys,lt=P.entries,st=K.lastIndexOf,ft=K.reduce,dt=K.reduceRight,ht=K.join,pt=K.sort,vt=K.slice,gt=K.toString,mt=K.toLocaleString,yt=S("iterator"),Et=S("toStringTag"),_t=C("typed_constructor"),wt=C("def_constructor"),Tt=c.CONSTR,xt=c.TYPED,Rt=c.VIEW,bt="Wrong length!",At=O(1,function(t,e){return Lt(M(t,t[wt]),e)}),It=o(function(){return 1===new Y(new Uint16Array([1]).buffer)[0]}),Ct=!!Y&&!!Y[X].set&&o(function(){new Y(1).set({})}),St=function(t,e){var n=p(t);if(n<0||n%e)throw W("Wrong offset!");return n},Ot=function(t){if(w(t)&&xt in t)return t;throw q(t+" is not a typed array!")},Lt=function(t,e){if(!(w(t)&&_t in t))throw q("It is not a typed array constructor!");return new t(e)},Mt=function(t,e){return Pt(M(t,t[wt]),e)},Pt=function(t,e){var n=0,r=e.length,i=Lt(t,r);while(r>n)i[n]=e[n++];return i},Gt=function(t,e,n){F(t,e,{get:function(){return this._d[n]}})},kt=function(t){var e,n,r,i,o,a,c=T(t),u=arguments.length,s=u>1?arguments[1]:void 0,f=void 0!==s,d=I(c);if(void 0!=d&&!x(d)){for(a=d.call(c),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);c=r}for(f&&u>2&&(s=l(s,arguments[2],2)),e=0,n=v(c.length),i=Lt(this,n);n>e;e++)i[e]=f?s(c[e],e):c[e];return i},Dt=function(){var t=0,e=arguments.length,n=Lt(this,e);while(e>t)n[t]=arguments[t++];return n},Ut=!!Y&&o(function(){mt.call(new Y(1))}),Nt=function(){return mt.apply(Ut?vt.call(Ot(this)):Ot(this),arguments)},Vt={copyWithin:function(t,e){return N.call(Ot(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return nt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return U.apply(Ot(this),arguments)},filter:function(t){return Mt(this,tt(Ot(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return rt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Ot(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){J(Ot(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return at(Ot(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Ot(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ht.apply(Ot(this),arguments)},lastIndexOf:function(t){return st.apply(Ot(this),arguments)},map:function(t){return At(Ot(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ft.apply(Ot(this),arguments)},reduceRight:function(t){return dt.apply(Ot(this),arguments)},reverse:function(){var t,e=this,n=Ot(e).length,r=Math.floor(n/2),i=0;while(i<r)t=e[i],e[i++]=e[--n],e[n]=t;return e},some:function(t){return et(Ot(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Ot(this),t)},subarray:function(t,e){var n=Ot(this),r=n.length,i=m(t,r);return new(M(n,n[wt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},Bt=function(t,e){return Mt(this,vt.call(Ot(this),t,e))},Ft=function(t){Ot(this);var e=St(arguments[1],1),n=this.length,r=T(t),i=v(r.length),o=0;if(i+e>n)throw W(bt);while(o<i)this[e+o]=r[o++]},zt={entries:function(){return lt.call(Ot(this))},keys:function(){return ut.call(Ot(this))},values:function(){return ct.call(Ot(this))}},Wt=function(t,e){return w(t)&&t[xt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},qt=function(t,e){return Wt(t,e=y(e,!0))?f(2,t[e]):z(t,e)},Yt=function(t,e,n){return!(Wt(t,e=y(e,!0))&&w(n)&&E(n,"value"))||E(n,"get")||E(n,"set")||n.configurable||E(n,"writable")&&!n.writable||E(n,"enumerable")&&!n.enumerable?F(t,e,n):(t[e]=n.value,t)};Tt||(B.f=qt,V.f=Yt),a(a.S+a.F*!Tt,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Yt}),o(function(){gt.call({})})&&(gt=mt=function(){return ht.call(this)});var Ht=h({},Vt);h(Ht,zt),d(Ht,yt,zt.values),h(Ht,{slice:Bt,set:Ft,constructor:function(){},toString:gt,toLocaleString:Nt}),Gt(Ht,"buffer","b"),Gt(Ht,"byteOffset","o"),Gt(Ht,"byteLength","l"),Gt(Ht,"length","e"),F(Ht,Et,{get:function(){return this[xt]}}),t.exports=function(t,e,n,u){u=!!u;var l=t+(u?"Clamped":"")+"Array",f="get"+t,h="set"+t,p=i[l],m=p||{},y=p&&b(p),E=!p||!c.ABV,T={},x=p&&p[X],I=function(t,n){var r=t._d;return r.v[f](n*e+r.o,It)},C=function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[h](n*e+i.o,r,It)},S=function(t,e){F(t,e,{get:function(){return I(this,e)},set:function(t){return C(this,e,t)},enumerable:!0})};E?(p=n(function(t,n,r,i){s(t,p,l,"_d");var o,a,c,u,f=0,h=0;if(w(n)){if(!(n instanceof $||(u=_(n))==H||u==j))return xt in n?Pt(p,n):kt.call(p,n);o=n,h=St(r,e);var m=n.byteLength;if(void 0===i){if(m%e)throw W(bt);if(a=m-h,a<0)throw W(bt)}else if(a=v(i)*e,a+h>m)throw W(bt);c=a/e}else c=g(n),a=c*e,o=new $(a);d(t,"_d",{b:o,o:h,l:a,e:c,v:new Q(o)});while(f<c)S(t,f++)}),x=p[X]=R(Ht),d(x,"constructor",p)):o(function(){p(1)})&&o(function(){new p(-1)})&&k(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=n(function(t,n,r,i){var o;return s(t,p,l),w(n)?n instanceof $||(o=_(n))==H||o==j?void 0!==i?new m(n,St(r,e),i):void 0!==r?new m(n,St(r,e)):new m(n):xt in n?Pt(p,n):kt.call(p,n):new m(g(n))}),J(y!==Function.prototype?A(m).concat(A(y)):A(m),function(t){t in p||d(p,t,m[t])}),p[X]=x,r||(x.constructor=p));var O=x[yt],L=!!O&&("values"==O.name||void 0==O.name),M=zt.values;d(p,_t,!0),d(x,xt,l),d(x,Rt,!0),d(x,wt,p),(u?new p(1)[Et]==l:Et in x)||F(x,Et,{get:function(){return l}}),T[l]=p,a(a.G+a.W+a.F*(p!=m),T),a(a.S,l,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){m.of.call(p,1)}),l,{from:kt,of:Dt}),Z in x||d(x,Z,e),a(a.P,l,Vt),D(l),a(a.P+a.F*Ct,l,{set:Ft}),a(a.P+a.F*!L,l,zt),r||x.toString==gt||(x.toString=gt),a(a.P+a.F*o(function(){new p(1).slice()}),l,{slice:Bt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!o(function(){x.toLocaleString.call([1,2])})),l,{toLocaleString:Nt}),G[l]=L?O:M,r||L||d(x,yt,M)}}else t.exports=function(){}},ed0b:function(t,e,n){"use strict";var r=n("7726"),i=n("9e1e"),o=n("2d00"),a=n("0f88"),c=n("32e9"),u=n("dcbc"),l=n("79e5"),s=n("f605"),f=n("4588"),d=n("9def"),h=n("09fa"),p=n("9093").f,v=n("86cc").f,g=n("36bd"),m=n("7f20"),y="ArrayBuffer",E="DataView",_="prototype",w="Wrong length!",T="Wrong index!",x=r[y],R=r[E],b=r.Math,A=r.RangeError,I=r.Infinity,C=x,S=b.abs,O=b.pow,L=b.floor,M=b.log,P=b.LN2,G="buffer",k="byteLength",D="byteOffset",U=i?"_b":G,N=i?"_l":k,V=i?"_o":D;function B(t,e,n){var r,i,o,a=new Array(n),c=8*n-e-1,u=(1<<c)-1,l=u>>1,s=23===e?O(2,-24)-O(2,-77):0,f=0,d=t<0||0===t&&1/t<0?1:0;for(t=S(t),t!=t||t===I?(i=t!=t?1:0,r=u):(r=L(M(t)/P),t*(o=O(2,-r))<1&&(r--,o*=2),t+=r+l>=1?s/o:s*O(2,1-l),t*o>=2&&(r++,o/=2),r+l>=u?(i=0,r=u):r+l>=1?(i=(t*o-1)*O(2,e),r+=l):(i=t*O(2,l-1)*O(2,e),r=0));e>=8;a[f++]=255&i,i/=256,e-=8);for(r=r<<e|i,c+=e;c>0;a[f++]=255&r,r/=256,c-=8);return a[--f]|=128*d,a}function F(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,c=i-7,u=n-1,l=t[u--],s=127&l;for(l>>=7;c>0;s=256*s+t[u],u--,c-=8);for(r=s&(1<<-c)-1,s>>=-c,c+=e;c>0;r=256*r+t[u],u--,c-=8);if(0===s)s=1-a;else{if(s===o)return r?NaN:l?-I:I;r+=O(2,e),s-=a}return(l?-1:1)*r*O(2,s-e)}function z(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function W(t){return[255&t]}function q(t){return[255&t,t>>8&255]}function Y(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function H(t){return B(t,52,8)}function j(t){return B(t,23,4)}function Z(t,e,n){v(t[_],e,{get:function(){return this[n]}})}function X(t,e,n,r){var i=+n,o=h(i);if(o+e>t[N])throw A(T);var a=t[U]._b,c=o+t[V],u=a.slice(c,c+e);return r?u:u.reverse()}function K(t,e,n,r,i,o){var a=+n,c=h(a);if(c+e>t[N])throw A(T);for(var u=t[U]._b,l=c+t[V],s=r(+i),f=0;f<e;f++)u[l+f]=s[o?f:e-f-1]}if(a.ABV){if(!l(function(){x(1)})||!l(function(){new x(-1)})||l(function(){return new x,new x(1.5),new x(NaN),x.name!=y})){x=function(t){return s(this,x),new C(h(t))};for(var $,Q=x[_]=C[_],J=p(C),tt=0;J.length>tt;)($=J[tt++])in x||c(x,$,C[$]);o||(Q.constructor=x)}var et=new R(new x(2)),nt=R[_].setInt8;et.setInt8(0,2147483648),et.setInt8(1,2147483649),!et.getInt8(0)&&et.getInt8(1)||u(R[_],{setInt8:function(t,e){nt.call(this,t,e<<24>>24)},setUint8:function(t,e){nt.call(this,t,e<<24>>24)}},!0)}else x=function(t){s(this,x,y);var e=h(t);this._b=g.call(new Array(e),0),this[N]=e},R=function(t,e,n){s(this,R,E),s(t,x,E);var r=t[N],i=f(e);if(i<0||i>r)throw A("Wrong offset!");if(n=void 0===n?r-i:d(n),i+n>r)throw A(w);this[U]=t,this[V]=i,this[N]=n},i&&(Z(x,k,"_l"),Z(R,G,"_b"),Z(R,k,"_l"),Z(R,D,"_o")),u(R[_],{getInt8:function(t){return X(this,1,t)[0]<<24>>24},getUint8:function(t){return X(this,1,t)[0]},getInt16:function(t){var e=X(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=X(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return z(X(this,4,t,arguments[1]))},getUint32:function(t){return z(X(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return F(X(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return F(X(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){K(this,1,t,W,e)},setUint8:function(t,e){K(this,1,t,W,e)},setInt16:function(t,e){K(this,2,t,q,e,arguments[2])},setUint16:function(t,e){K(this,2,t,q,e,arguments[2])},setInt32:function(t,e){K(this,4,t,Y,e,arguments[2])},setUint32:function(t,e){K(this,4,t,Y,e,arguments[2])},setFloat32:function(t,e){K(this,4,t,j,e,arguments[2])},setFloat64:function(t,e){K(this,8,t,H,e,arguments[2])}});m(x,y),m(R,E),c(R[_],a.VIEW,!0),e[y]=x,e[E]=R},ed33:function(t,e,n){n("014b"),t.exports=n("584a").Object.getOwnPropertySymbols},f201:function(t,e,n){var r=n("e4ae"),i=n("79aa"),o=n("5168")("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f499:function(t,e,n){t.exports=n("a21f")},f605:function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},f772:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},f921:function(t,e,n){n("014b"),n("c207"),n("69d3"),n("765d"),t.exports=n("584a").Symbol},fa5b:function(t,e,n){t.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,n){var r=n("7726").document;t.exports=r&&r.documentElement},fae3:function(t,e,n){"use strict";var r;(n.r(e),"undefined"!==typeof window)&&((r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(n.p=r[1]));var i=n("03cc"),o=n.n(i),a=(n("3b2b"),n("63d9"),n("f499")),c=n.n(a),u=(n("8449"),n("cadf"),n("5df3"),n("0a0d")),l=n.n(u),s=(n("6c7b"),n("6aa2"),n("795b")),f=n.n(s),d=(n("34ef"),n("7872"),n("0b21"),n("673e"),n("7514"),n("2fdb"),n("4917"),n("59ad")),h=n.n(d),p=(n("a481"),n("28a5"),n("55dd"),n("7f7f"),n("e814")),v=n.n(p),g=n("5176"),m=n.n(g),y=(n("20d6"),n("6762"),n("5d73")),E=n.n(y),_=n("774e"),w=n.n(_),T=(n("6b54"),n("c8bb")),x=n.n(T),R=n("a745"),b=n.n(R),A=(n("ac6a"),n("268f")),I=n.n(A),C=n("e265"),S=n.n(C),O=n("a4bb"),L=n.n(O),M=n("85f2"),P=n.n(M),G=n("5d58"),k=n.n(G),D=n("67bb"),U=n.n(D);function N(t){return N="function"===typeof U.a&&"symbol"===typeof k.a?function(t){return typeof t}:function(t){return t&&"function"===typeof U.a&&t.constructor===U.a&&t!==U.a.prototype?"symbol":typeof t},N(t)}function V(t){return V="function"===typeof U.a&&"symbol"===N(k.a)?function(t){return N(t)}:function(t){return t&&"function"===typeof U.a&&t.constructor===U.a&&t!==U.a.prototype?"symbol":N(t)},V(t)}
/*!
 * Doka 6.4.0
 * Copyright 2019 PQINA Inc - All Rights Reserved
 * Please visit https://pqina.nl/doka/ for further information
 */function B(t){return(B="function"==typeof U.a&&"symbol"==V(k.a)?function(t){return V(t)}:function(t){return t&&"function"==typeof U.a&&t.constructor===U.a&&t!==U.a.prototype?"symbol":V(t)})(t)}function F(t,e,n){return e in t?P()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=L()(n);"function"==typeof S.a&&(r=r.concat(S()(n).filter(function(t){return I()(n,t).enumerable}))),r.forEach(function(e){F(t,e,n[e])})}return t}function W(t){throw new Error('"'+t+'" is read-only')}function q(t,e){return j(t)||X(t,e)||$()}function Y(t){return H(t)||Z(t)||K()}function H(t){if(b()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function j(t){if(b()(t))return t}function Z(t){if(x()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return w()(t)}function X(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=E()(t);!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}function K(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function $(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var Q=function(t){return t instanceof HTMLElement},J=function(t,e){return e.parentNode.insertBefore(t,e)},tt=function(t,e){return e.parentNode.insertBefore(t,e.nextSibling)},et=function(t){return"object"===B(t)&&null!==t},nt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=z({},t),i=[],o=[],a=function(t,e,n){n?o.push({type:t,data:e}):(s[t]&&s[t](e),i.push({type:t,data:e}))},c=function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return l[t]?(e=l)[t].apply(e,r):null},u={getState:function(){return z({},r)},processActionQueue:function(){var t=[].concat(i);return i.length=0,t},processDispatchQueue:function(){var t=[].concat(o);o.length=0,t.forEach(function(t){var e=t.type,n=t.data;a(e,n)})},dispatch:a,query:c},l={};e.forEach(function(t){l=z({},t(r),l)});var s={};return n.forEach(function(t){s=z({},t(a,c,r),s)}),u},rt=function(t,e,n){"function"!=typeof n?P()(t,e,n):t[e]=n},it=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])},ot=function(t){var e={};return it(t,function(n){rt(e,n,t[n])}),e},at=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===n)return t.getAttribute(e)||t.hasAttribute(e);t.setAttribute(e,n)},ct="http://www.w3.org/2000/svg",ut=["svg","path"],lt=function(t){return ut.includes(t)},st=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"===B(e)&&(n=e,e=null);var r=lt(t)?document.createElementNS(ct,t):document.createElement(t);return e&&(lt(t)?at(r,"class",e):r.className=e),it(n,function(t,e){at(r,t,e)}),r},ft=function(t){return function(e,n){void 0!==n&&t.children[n]?t.insertBefore(e,t.children[n]):t.appendChild(e)}},dt=function(t,e){return function(t,n){return void 0!==n?e.splice(n,0,t):e.push(t),t}},ht=function(t,e){return function(n){return e.splice(e.indexOf(n),1),n.element.parentNode&&t.removeChild(n.element),n}},pt=function(t,e,n,r){var i=n[0]||t.left,o=n[1]||t.top,a=i+t.width,c=o+t.height*(r[1]||1),u={element:z({},t),inner:{left:t.left,top:t.top,right:t.right,bottom:t.bottom},outer:{left:i,top:o,right:a,bottom:c}};return e.filter(function(t){return!t.isRectIgnored()}).map(function(t){return t.rect}).forEach(function(t){vt(u.inner,z({},t.inner)),vt(u.outer,z({},t.outer))}),gt(u.inner),u.outer.bottom+=u.element.marginBottom,u.outer.right+=u.element.marginRight,gt(u.outer),u},vt=function(t,e){e.top+=t.top,e.right+=t.left,e.bottom+=t.top,e.left+=t.left,e.bottom>t.bottom&&(t.bottom=e.bottom),e.right>t.right&&(t.right=e.right)},gt=function(t){t.width=t.right-t.left,t.height=t.bottom-t.top},mt=function(t){return"number"==typeof t},yt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return Math.abs(t-e)<r&&Math.abs(n)<r},Et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.stiffness,n=void 0===e?.5:e,r=t.damping,i=void 0===r?.75:r,o=t.mass,a=void 0===o?10:o,c=t.delay,u=void 0===c?0:c,l=null,s=null,f=0,d=!1,h=null,p=ot({interpolate:function(t){if(null===h&&(h=t),!(t-u<h||d)){if(!mt(l)||!mt(s))return d=!0,void(f=0);yt(s+=f+=-(s-l)*n/a,l,f*=i)?(s=l,f=0,d=!0,p.onupdate(s),p.oncomplete(s)):p.onupdate(s)}},target:{set:function(t){if(mt(t)&&!mt(s)&&(s=t,h=null),null===l&&(l=t,s=t,h=null),d&&(h=null),s===(l=t)||void 0===l)return d=!0,f=0,h=null,p.onupdate(s),void p.oncomplete(s);d=!1},get:function(){return l}},resting:{get:function(){return d}},onupdate:function(){},oncomplete:function(){},position:{get:function(){return s}}});return p},_t=function(t){return t<.5?2*t*t:(4-2*t)*t-1},wt=function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.duration,i=void 0===r?500:r,o=n.easing,a=void 0===o?_t:o,c=n.delay,u=void 0===c?0:c,l=null,s=!0,f=!1,d=null,h=ot({interpolate:function(n){s||null===d||(null===l&&(l=n),n-l<u||((t=n-l-u)<i?(e=t/i,h.onupdate((t>=0?a(f?1-e:e):0)*d)):(t=1,e=f?0:1,h.onupdate(e*d),h.oncomplete(e*d),s=!0)))},target:{get:function(){return f?0:d},set:function(t){if(null===d)return d=t,h.onupdate(t),void h.oncomplete(t);t<d?(d=1,f=!0):(f=!1,d=t),s=!1,l=null}},resting:{get:function(){return s}},onupdate:function(){},oncomplete:function(){}});return h},Tt={spring:Et,tween:wt},xt=function(t,e,n){var r=t[e]&&"object"===B(t[e][n])?t[e][n]:t[e]||t,i="string"==typeof r?r:r.type,o="object"===B(r)?z({},r):{};return Tt[i]?Tt[i](o):null},Rt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(e=b()(e)?e:[e]).forEach(function(e){t.forEach(function(t){var i=t,o=function(){return n[t]},a=function(e){return n[t]=e};"object"===B(t)&&(i=t.key,o=t.getter||o,a=t.setter||a),e[i]&&!r||(e[i]={get:o,set:a})})})},bt=function(t){var e=t.mixinConfig,n=t.viewProps,r=t.viewInternalAPI,i=t.viewExternalAPI,o=z({},n),a=[];return it(e,function(t,e){var c=xt(e);c&&(c.onupdate=function(e){n[t]=e},c.target=o[t],Rt([{key:t,setter:function(t){c.target!==t&&(c.target=t)},getter:function(){return n[t]}}],[r,i],n,!0),a.push(c))}),{write:function(t){var e=!0;return a.forEach(function(n){n.resting||(e=!1),n.interpolate(t)}),e},destroy:function(){}}},At=function(t){return function(e,n){t.addEventListener(e,n)}},It=function(t){return function(e,n){t.removeEventListener(e,n)}},Ct=function(t){var e=t.viewExternalAPI,n=t.view,r=[],i=At(n.element),o=It(n.element);return e.on=function(t,e){r.push({type:t,fn:e}),i(t,e)},e.off=function(t,e){r.splice(r.findIndex(function(n){return n.type===t&&n.fn===e}),1),o(t,e)},{write:function(){return!0},destroy:function(){r.forEach(function(t){o(t.type,t.fn)})}}},St=function(t){var e=t.mixinConfig,n=t.viewProps,r=t.viewExternalAPI;Rt(e,r,n)},Ot={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},Lt=function(t){var e=t.mixinConfig,n=t.viewProps,r=t.viewInternalAPI,i=t.viewExternalAPI,o=t.view,a=z({},n),c={};Rt(e,[r,i],n);var u=function(){return o.rect?pt(o.rect,o.childViews,[n.translateX||0,n.translateY||0],[n.scaleX||0,n.scaleY||0]):null};return r.rect={get:u},i.rect={get:u},e.forEach(function(t){n[t]=void 0===a[t]?Ot[t]:a[t]}),{write:function(){if(Mt(c,n))return Pt(o.element,n),m()(c,z({},n)),!0},destroy:function(){}}},Mt=function(t,e){if(L()(t).length!==L()(e).length)return!0;for(var n in e)if(e[n]!==t[n])return!0;return!1},Pt=function(t,e){var n=e.opacity,r=e.perspective,i=e.translateX,o=e.translateY,a=e.scaleX,c=e.scaleY,u=e.rotateX,l=e.rotateY,s=e.rotateZ,f=e.originX,d=e.originY,h=e.width,p=e.height,v="",g="";null==f&&null==d||(g+="transform-origin: ".concat(f||0,"px ").concat(d||0,"px;")),null!=r&&(v+="perspective(".concat(r,"px) ")),null==i&&null==o||(v+="translate3d(".concat(i||0,"px, ").concat(o||0,"px, 0) ")),null==a&&null==c||(v+="scale3d(".concat(null!=a?a:1,", ").concat(null!=c?c:1,", 1) ")),null!=s&&(v+="rotateZ(".concat(s,"rad) ")),null!=u&&(v+="rotateX(".concat(u,"rad) ")),null!=l&&(v+="rotateY(".concat(l,"rad) ")),""!=v&&(g+="transform:".concat(v,";")),null!=n&&(g+="opacity:".concat(n,";"),n<1&&(g+="pointer-events:none;"),0===n&&"BUTTON"===t.nodeName&&(g+="visibility:hidden;")),null!=h&&(g+="width:".concat(h,"px;")),null!=p&&(g+="height:".concat(p,"px;"));var m=t.elementCurrentStyle||"";g.length===m.length&&g===m||(t.style.cssText=g,t.elementCurrentStyle=g)},Gt={styles:Lt,listeners:Ct,animations:bt,apis:St},kt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.layoutCalculated||(t.paddingTop=v()(n.paddingTop,10)||0,t.marginTop=v()(n.marginTop,10)||0,t.marginRight=v()(n.marginRight,10)||0,t.marginBottom=v()(n.marginBottom,10)||0,t.marginLeft=v()(n.marginLeft,10)||0,e.layoutCalculated=!0),t.left=e.offsetLeft||0,t.top=e.offsetTop||0,t.width=e.offsetWidth||0,t.height=e.offsetHeight||0,t.right=t.left+t.width,t.bottom=t.top+t.height,t.scrollTop=e.scrollTop,t.hidden=null===e.offsetParent&&"fixed"!==n.position,t},Dt="undefined"!=typeof window&&void 0!==window.document,Ut=function(){return Dt},Nt=Ut()?st("svg"):{},Vt="children"in Nt?function(t){return t.children.length}:function(t){return t.childNodes.length},Bt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tag,n=void 0===e?"div":e,r=t.name,i=void 0===r?null:r,o=t.attributes,a=void 0===o?{}:o,c=t.read,u=void 0===c?function(){}:c,l=t.write,s=void 0===l?function(){}:l,f=t.create,d=void 0===f?function(){}:f,h=t.destroy,p=void 0===h?function(){}:h,v=t.filterFrameActionsForChild,g=void 0===v?function(t,e){return e}:v,m=t.didCreateView,y=void 0===m?function(){}:m,E=t.didWriteView,_=void 0===E?function(){}:E,w=t.shouldUpdateChildViews,T=void 0===w?function(){return!0}:w,x=t.ignoreRect,R=void 0!==x&&x,b=t.ignoreRectUpdate,A=void 0!==b&&b,I=t.mixins,C=void 0===I?[]:I;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=st(n,i?"doka--".concat(i):null,a),o=window.getComputedStyle(r,null),c=kt(),l=null,f=!1,h=[],v=[],m={},E={},w=[s],x=[u],b=[p],I=function(){return r},S=function(){return[].concat(h)},O=function(){return l||(l=pt(c,h,[0,0],[1,1]))},M=function(){return r.layoutCalculated=!1},P={element:{get:I},style:{get:function(){return o}},childViews:{get:S}},G=z({},P,{rect:{get:O},ref:{get:function(){return m}},is:function(t){return i===t},appendChild:ft(r),createChildView:function(t){return function(e,n){return e(t,n)}}(t),linkView:function(t){return h.push(t),t},unlinkView:function(t){h.splice(h.indexOf(t),1)},appendChildView:dt(r,h),removeChildView:ht(r,h),registerWriter:function(t){return w.push(t)},registerReader:function(t){return x.push(t)},registerDestroyer:function(t){return b.push(t)},invalidateLayout:M,dispatch:t.dispatch,query:t.query}),k={element:{get:I},childViews:{get:S},rect:{get:O},resting:{get:function(){return f}},isRectIgnored:function(){return R},invalidateLayout:M,_read:function(){l=null,T({root:U,props:e})&&h.forEach(function(t){return t._read()}),!(A&&c.width&&c.height)&&kt(c,r,o);var t={root:U,props:e,rect:c};x.forEach(function(e){return e(t)})},_write:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0===n.length;return w.forEach(function(i){!1===i({props:e,root:U,actions:n,timestamp:t})&&(r=!1)}),v.forEach(function(e){!1===e.write(t)&&(r=!1)}),T({props:e,root:U,actions:n,timestamp:t})&&(h.filter(function(t){return!!t.element.parentNode}).forEach(function(e){e._write(t,g(e,n))||(r=!1)}),h.forEach(function(e,i){e.element.parentNode||(U.appendChild(e.element,i),e._read(),e._write(t,g(e,n)),r=!1)})),f=r,_({props:e,root:U,actions:n,timestamp:t}),r},_destroy:function(){v.forEach(function(t){return t.destroy()}),b.forEach(function(t){t({root:U})}),h.forEach(function(t){return t._destroy()})}},D=z({},P,{rect:{get:function(){return c}}});L()(C).sort(function(t,e){return"styles"===t?1:"styles"===e?-1:0}).forEach(function(t){var n=Gt[t]({mixinConfig:C[t],viewProps:e,viewState:E,viewInternalAPI:G,viewExternalAPI:k,view:ot(D)});n&&v.push(n)});var U=ot(G);d({root:U,props:e});var N=Vt(r)||0;return h.forEach(function(t,e){U.appendChild(t.element,N+e)}),y(U),ot(k,e)}},Ft=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r="__framePainter";if(window[r])return window[r].readers.push(t),void window[r].writers.push(e);window[r]={readers:[t],writers:[e]};var i=window[r],o=1e3/n,a=null,c=null,u=null,l=null,s=function(){document.hidden?(u=function(){return window.setTimeout(function(){return f(performance.now())},o)},l=function(){return window.clearTimeout(c)}):(u=function(){return window.requestAnimationFrame(f)},l=function(){return window.cancelAnimationFrame(c)})};document.addEventListener("visibilitychange",function(){l&&l(),s(),f(performance.now())});var f=function t(e){c=u(t),a||(a=e);var n=e-a;n<=o||(a=e-n%o,i.readers.forEach(function(t){return t()}),i.writers.forEach(function(t){return t(e)}))};return s(),f(performance.now()),{pause:function(){l(c)}}},zt=function(t,e){return function(n){var r=n.root,i=n.props,o=n.actions,a=void 0===o?[]:o,c=n.timestamp;if(a.filter(function(e){return t[e.type]}).forEach(function(e){return t[e.type]({root:r,props:i,action:e.data,timestamp:c})}),e)return e({root:r,props:i,actions:a,timestamp:c})}},Wt=function(t){return b()(t)},qt=function(t){return null==t},Yt=function(t){return t.trim()},Ht=function(t){return""+t},jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return qt(t)?[]:Wt(t)?t:Ht(t).split(e).map(Yt).filter(function(t){return t.length})},Zt=function(t){return"boolean"==typeof t},Xt=function(t){return Zt(t)?t:"true"===t},Kt=function(t){return"string"==typeof t},$t=function(t){return mt(t)?t:Kt(t)?Ht(t).replace(/[a-z]+/gi,""):0},Qt=function(t){return v()($t(t),10)},Jt=function(t){return h()($t(t))},te=function(t){return mt(t)&&isFinite(t)&&Math.floor(t)===t},ee=function(t){if(te(t))return t;var e=Ht(t).trim();return/MB$/i.test(e)?(e=e.replace(/MB$i/,"").trim(),1e3*Qt(e)*1e3):/KB/i.test(e)?(e=e.replace(/KB$i/,"").trim(),1e3*Qt(e)):Qt(e)},ne=function(t){return"function"==typeof t},re=function(t){for(var e=self,n=t.split("."),r=null;r=n.shift();)if(!(e=e[r]))return null;return e},ie=function(t){return null===t},oe=function(t){return Wt(t)?"array":ie(t)?"null":te(t)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(t)?"bytes":B(t)},ae=function(t){return t.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",')},ce={array:jt,boolean:Xt,int:function(t){return"bytes"===oe(t)?ee(t):Qt(t)},float:Jt,bytes:ee,string:function(t){return ne(t)?t:Ht(t)},object:function(t){try{return JSON.parse(ae(t))}catch(e){return t}},file:function(t){return t},function:function(t){return re(t)}},ue=function(t,e){return ce[e](t)},le=function(t,e,n){if(t===e)return t;var r=oe(t);if(r!==n){var i=ue(t,n);if(r=oe(i),null===i)throw'Trying to assign value with incorrect type, allowed type: "'.concat(n,'"');t=i}return t},se=function(t,e){var n=t;return{enumerable:!0,get:function(){return n},set:function(r){n=le(r,t,e)}}},fe=function(t){var e={};return it(t,function(n){var r=Kt(t[n])?t[n]:n,i=t[r];e[n]=r===n?se(i[0],i[1]):e[r]}),ot(e)},de=function(t){t.file=null,t.activeView=null,t.markup=[],t.markupToolValues={},t.rootRect={x:0,y:0,left:0,top:0,width:0,height:0},t.stage=null,t.stageOffset=null,t.image=null,t.zoomTimeoutId=null,t.instantUpdate=!1,t.filePromise=null,t.fileLoader=null,t.instructions={size:null,crop:null,filter:null,color:null},t.filter=null,t.filterName=null,t.filterValue=null,t.colorValues={},t.colorMatrices={},t.size={width:!1,height:!1,aspectRatioLocked:!0,aspectRatioPrevious:!1},t.crop={rectangle:null,transforms:null,rotation:null,flip:null,aspectRatio:null,isRotating:!1,isDirty:!1,limitToImageBounds:!0,draft:{rectangle:null,transforms:null}}},he=function(t){var e={noImageTimeout:null,options:fe(t)};return de(e),e},pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t.split(/(?=[A-Z])/).map(function(t){return t.toLowerCase()}).join(e)},ve=function(t,e){var n={};return it(e,function(r){var i=Kt(e[r])?e[r]:r;n[r]={get:function(){return t.getState().options[i]},set:function(e){t.dispatch("SET_".concat(pe(i,"_").toUpperCase()),{value:e})}}}),n},ge=function(t){return function(e,n,r){var i={};return it(t,function(t){var n=pe(t,"_").toUpperCase();i["SET_".concat(n)]=function(i){var o;try{o=r.options[t],r.options[t]=i.value}catch(t){}e("DID_SET_".concat(n),{value:r.options[t],prevValue:o})}}),i}},me=function(t){return function(e){var n={};return it(t,function(t){n["GET_".concat(pe(t,"_").toUpperCase())]=function(){return e.options[t]}}),n}},ye=function(){return Math.random().toString(36).substr(2,9)},Ee=function(t,e){return t.splice(e,1)},_e=function(){var t=[],e=function(e,n){Ee(t,t.findIndex(function(t){return t.event===e&&(t.cb===n||!n)}))};return{fire:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.filter(function(t){return t.event===e}).map(function(t){return t.cb}).forEach(function(t){setTimeout(function(){t.apply(void 0,r)},0)})},on:function(e,n){t.push({event:e,cb:n})},onOnce:function(n,r){t.push({event:n,cb:function(){e(n,r),r.apply(void 0,arguments)}})},off:e}},we={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",FILE:"file"},Te=null,xe=function(){return null===Te&&(Te=(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream),Te},Re=function(){return z({},Ce)},be=function(t){it(t,function(t,e){Ce[t]&&Ie(t,e)})},Ae=function(t){return Kt(Ce[t])?Ce[t]:t},Ie=function(t,e){t=Ae(t),Ce[t][0]=le(e,Ce[t][0],Ce[t][1])},Ce={id:[null,we.STRING],className:[null,we.STRING],src:[null,we.FILE],storageName:["doka",we.STRING],maxImagePreviewWidth:[1500,we.INT],maxImagePreviewHeight:[1500,we.INT],imagePreviewScaleMode:["stage",we.STRING],allowPreviewFitToView:[!0,we.BOOLEAN],allowButtonCancel:[!0,we.BOOLEAN],allowButtonConfirm:[!0,we.BOOLEAN],allowDropFiles:[!1,we.BOOLEAN],allowBrowseFiles:[!0,we.BOOLEAN],allowAutoClose:[!0,we.BOOLEAN],allowAutoDestroy:[!1,we.BOOLEAN],utils:[["crop","filter","color","markup"],we.ARRAY],util:[null,we.STRING],initialState:[null,we.OBJECT],outputData:[!1,we.BOOLEAN],outputFile:[!0,we.BOOLEAN],outputCorrectImageExifOrientation:[!0,we.BOOLEAN],outputStripImageHead:[!0,we.BOOLEAN],outputType:[null,we.STRING],outputQuality:[null,we.INT],outputFit:["cover",we.STRING],outputUpscale:[!0,we.BOOLEAN],outputWidth:[null,we.INT],outputHeight:[null,we.INT],outputCanvasBackgroundColor:[null,we.STRING],outputCanvasMemoryLimit:[Ut()&&xe()?16777216:null,we.INT],size:[null,we.OBJECT],sizeMin:[{width:1,height:1},we.OBJECT],sizeMax:[{width:9999,height:9999},we.OBJECT],filter:[null,we.OBJECT],filters:[{original:{label:"Original",matrix:function(){return null}},chrome:{label:"Chrome",matrix:function(){return[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0]}},fade:{label:"Fade",matrix:function(){return[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0]}},mono:{label:"Mono",matrix:function(){return[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0]}},noir:{label:"Noir",matrix:function(){return[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0]}}},we.OBJECT],crop:[null,we.OBJECT],cropShowSize:[!1,we.BOOLEAN],cropZoomTimeout:[null,we.INT],cropMask:[null,we.FUNCTION],cropMaskInset:[0,we.INT],cropAllowResizeRect:[!0,we.BOOLEAN],cropAllowImageTurnLeft:[!0,we.BOOLEAN],cropAllowImageTurnRight:[!1,we.BOOLEAN],cropAllowImageFlipHorizontal:[!0,we.BOOLEAN],cropAllowImageFlipVertical:[!0,we.BOOLEAN],cropAllowToggleLimit:[!1,we.BOOLEAN],cropLimitToImageBounds:[!0,we.BOOLEAN],cropAllowInstructionZoom:[!1,we.BOOLEAN],cropAllowRotate:[!0,we.BOOLEAN],cropResizeMatchImageAspectRatio:[!1,we.BOOLEAN],cropResizeKeyCodes:[[18,91,92,93],we.ARRAY],cropResizeScrollRectOnly:[!1,we.BOOLEAN],cropAspectRatio:[null,we.STRING],cropAspectRatioOptions:[null,we.ARRAY],cropMinImageWidth:[1,we.INT],cropMinImageHeight:[1,we.INT],colorBrightness:[0,we.NUMBER],colorBrightnessRange:[[-.25,.25],we.ARRAY],colorContrast:[1,we.NUMBER],colorContrastRange:[[.5,1.5],we.ARRAY],colorExposure:[1,we.NUMBER],colorExposureRange:[[.5,1.5],we.ARRAY],colorSaturation:[1,we.NUMBER],colorSaturationRange:[[0,2],we.ARRAY],markup:[null,we.ARRAY],markupUtil:["select",we.STRING],markupFilter:[function(){return!0},we.FUNCTION],markupAllowAddMarkup:[!0,we.BOOLEAN],markupAllowCustomColor:[!0,we.BOOLEAN],markupDrawDistance:[4,we.NUMBER],markupColor:["#000",we.STRING],markupColorOptions:[[["White","#fff","#f6f6f6"],["Silver","#9e9e9e"],["Black","#000","#333"],["Red","#f44336"],["Orange","#ff9800"],["Yellow","#ffeb3b"],["Green","#4caf50"],["Blue","#2196f3"],["Violet","#3f51b5"],["Purple","#9c27b0"]],we.ARRAY],markupFontSize:[.1,we.NUMBER],markupFontSizeOptions:[[["XL",.15],["L",.125],["M",.1],["S",.075],["XS",.05]],we.ARRAY],markupFontFamily:["Helvetica, Arial, Verdana",we.STRING],markupFontFamilyOptions:[[["Serif","Palatino, 'Times New Roman', serif"],["Sans Serif","Helvetica, Arial, Verdana"],["Monospaced","Monaco, 'Lucida Console', monospaced"]],we.ARRAY],markupShapeStyle:[[.015,null],we.ARRAY],markupShapeStyleOptions:[[["Fill",0,null,0],["Outline thick",.025,null,4],["Outline default",.015,null,2],["Outline thin",.005,null,1],["Outline dashed",.005,[.01],1]],we.ARRAY],markupLineStyle:[[.015,null],we.ARRAY],markupLineStyleOptions:[[["Thick",.025,null,4],["Default",.015,null,2],["Thin",.005,null,1],["Dashed",.005,[.01],1]],we.ARRAY],markupLineDecoration:[["arrow-end"],we.ARRAY],markupLineDecorationOptions:[[["None",[]],["Single arrow",["arrow-end"]],["Double arrow",["arrow-begin","arrow-end"]]],we.ARRAY],beforeCreateBlob:[null,we.FUNCTION],afterCreateBlob:[null,we.FUNCTION],afterCreateOutput:[null,we.FUNCTION],onconfirm:[null,we.FUNCTION],oncancel:[null,we.FUNCTION],onclose:[null,we.FUNCTION],onloadstart:[null,we.FUNCTION],onload:[null,we.FUNCTION],onloaderror:[null,we.FUNCTION],onupdate:[null,we.FUNCTION],oninit:[null,we.FUNCTION],ondestroy:[null,we.FUNCTION],labelButtonReset:["Reset",we.STRING],labelButtonCancel:["Cancel",we.STRING],labelButtonConfirm:["Done",we.STRING],labelButtonUtilCrop:["Crop",we.STRING],labelButtonUtilResize:["Resize",we.STRING],labelButtonUtilFilter:["Filter",we.STRING],labelButtonUtilColor:["Colors",we.STRING],labelButtonUtilMarkup:["Markup",we.STRING],labelStatusMissingWebGL:["WebGL is required but is disabled on your browser",we.STRING],labelStatusAwaitingImage:["Waiting for image…",we.STRING],labelStatusLoadImageError:["Error loading image…",we.STRING],labelStatusLoadingImage:["Loading image…",we.STRING],labelStatusProcessingImage:["Processing image…",we.STRING],labelColorBrightness:["Brightness",we.STRING],labelColorContrast:["Contrast",we.STRING],labelColorExposure:["Exposure",we.STRING],labelColorSaturation:["Saturation",we.STRING],labelMarkupTypeRectangle:["Square",we.STRING],labelMarkupTypeEllipse:["Circle",we.STRING],labelMarkupTypeText:["Text",we.STRING],labelMarkupTypeLine:["Arrow",we.STRING],labelMarkupSelectFontSize:["Size",we.STRING],labelMarkupSelectFontFamily:["Font",we.STRING],labelMarkupSelectLineDecoration:["Decoration",we.STRING],labelMarkupSelectLineStyle:["Style",we.STRING],labelMarkupSelectShapeStyle:["Style",we.STRING],labelMarkupRemoveShape:["Remove",we.STRING],labelMarkupToolSelect:["Select",we.STRING],labelMarkupToolDraw:["Draw",we.STRING],labelMarkupToolLine:["Arrow",we.STRING],labelMarkupToolText:["Text",we.STRING],labelMarkupToolRect:["Square",we.STRING],labelMarkupToolEllipse:["Circle",we.STRING],labelResizeWidth:["Width",we.STRING],labelResizeHeight:["Height",we.STRING],labelResizeApplyChanges:["Apply",we.STRING],labelCropInstructionZoom:["Zoom in and out with your scroll wheel or touchpad.",we.STRING],labelButtonCropZoom:["Zoom",we.STRING],labelButtonCropRotateLeft:["Rotate left",we.STRING],labelButtonCropRotateRight:["Rotate right",we.STRING],labelButtonCropRotateCenter:["Center rotation",we.STRING],labelButtonCropFlipHorizontal:["Flip horizontal",we.STRING],labelButtonCropFlipVertical:["Flip vertical",we.STRING],labelButtonCropAspectRatio:["Aspect ratio",we.STRING],labelButtonCropToggleLimit:["Crop selection",we.STRING],labelButtonCropToggleLimitEnable:["Limited to image",we.STRING],labelButtonCropToggleLimitDisable:["Select outside image",we.STRING],pointerEventsPolyfillScope:["root",we.STRING],styleCropCorner:["circle",we.STRING],styleFullscreenSafeArea:[Ut()&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?"bottom":"none",we.STRING],styleLayoutMode:[null,we.STRING]},Se=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(n,Math.max(e,t))},Oe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return h()(t.toFixed(e))},Le=function(t,e){return Oe(t.x)===Oe(e.x)&&Oe(t.y)===Oe(e.y)},Me=function(t,e){return{x:Oe(t.x,e),y:Oe(t.y,e)}},Pe=function(t,e){return Be(t.x-e.x,t.y-e.y)},Ge=function(t,e){return t.x*e.x+t.y*e.y},ke=function(t,e){return Ge(Pe(t,e),Pe(t,e))},De=function(t,e){return Math.sqrt(ke(t,e))},Ue=function(t,e){var n=Pe(t,e);return Math.atan2(n.y,n.x)},Ne=function(t,e){return Be(Se(t.x,e.x,e.x+e.width),Se(t.y,e.y,e.y+e.height))},Ve=function(t,e,n){var r=Math.cos(e),i=Math.sin(e),o=Be(t.x-n.x,t.y-n.y);return Be(n.x+r*o.x-i*o.y,n.y+i*o.x+r*o.y)},Be=function(){return{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}},Fe=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},ze=function(t,e){var n=Ke(t),r=Ke(e);return n.left>=r.left&&n.top>=r.top&&n.bottom<=r.bottom&&n.right<=r.right},We=function(t,e,n){return 0===e?{tl:t.tl,tr:t.tr,br:t.br,bl:t.bl}:{tl:Ve(t.tl,e,n),tr:Ve(t.tr,e,n),br:Ve(t.br,e,n),bl:Ve(t.bl,e,n)}},qe=function(t,e,n){var r=We(Je(t),e,n),i=r.tl,o=r.tr,a=r.br,c=r.bl,u=Math.min(i.x,o.x,a.x,c.x),l=Math.min(i.y,o.y,a.y,c.y),s=Math.max(i.x,o.x,a.x,c.x),f=Math.max(i.y,o.y,a.y,c.y);return tn(u,l,s-u,f-l)},Ye=function(t,e,n){return tn(e*(t.x-n.x)+n.x,e*(t.y-n.y)+n.y,e*t.width,e*t.height)},He=function(t,e){return tn(t.x+e.x,t.y+e.y,t.width,t.height)},je={translate:He,rotate:qe,scale:Ye},Ze=function(t,e,n){return e.reduce(function(t,e){return(0,je[e[0]])(t,e[1],n)},t)},Xe=function(t){return tn(t.x,t.y,t.width,t.height)},Ke=function(t){return{top:t.y,right:t.x+t.width,bottom:t.y+t.height,left:t.x}},$e=function(t){var e=t.top,n=t.right,r=t.bottom,i=t.left;return{x:i,y:e,width:n-i,height:r-e}},Qe=function(t){return Be(t.x+.5*t.width,t.y+.5*t.height)},Je=function(t){return{tl:{x:t.x,y:t.y},tr:{x:t.x+t.width,y:t.y},br:{x:t.x+t.width,y:t.y+t.height},bl:{x:t.x,y:t.y+t.height}}},tn=function(t,e,n,r){return{x:t,y:e,width:n,height:r}},en=function(t){if(qt(t))return t;if(/:/.test(t)){var e=t.split(":"),n=e[0];return e[1]/n}return h()(t)},nn=function(t,e){var n=t.width,r=n*e;return r>t.height&&(n=(r=t.height)/e),{x:.5*(t.width-n),y:.5*(t.height-r),width:n,height:r}},rn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t.height/t.width,i=e,o=1,a=r;a>i&&(o=(a=i)/r);var c=Math.max(1/o,i/a),u=t.width/(n*c*o);return{width:u,height:u*e}},on=function(t,e){return{x:t,y:e}},an=function(t,e){return t.x*e.x+t.y*e.y},cn=function(t,e){return on(t.x-e.x,t.y-e.y)},un=function(t,e){return an(cn(t,e),cn(t,e))},ln=function(t,e){return Math.sqrt(un(t,e))},sn=function(t,e){var n=t,r=e,i=1.5707963267948966-e,o=Math.sin(1.5707963267948966),a=Math.sin(r),c=Math.sin(i),u=Math.cos(i),l=n/o;return on(u*(l*a),u*(l*c))},fn=function(t,e){var n=t.width,r=t.height,i=sn(n,e),o=sn(r,e),a=on(t.x+Math.abs(i.x),t.y-Math.abs(i.y)),c=on(t.x+t.width+Math.abs(o.y),t.y+Math.abs(o.x)),u=on(t.x-Math.abs(o.y),t.y+t.height-Math.abs(o.x));return{width:ln(a,c),height:ln(a,u)}},dn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:.5,y:.5},i=r.x>.5?1-r.x:r.x,o=r.y>.5?1-r.y:r.y,a=2*i*t.width,c=2*o*t.height,u=fn(e,n);return Math.max(u.width/a,u.height/c)},hn=function(t,e){var n=e.origin,r=e.translation,i=e.scale;return Ze(t,[["scale",i],["translate",r]],n)},pn=function(t,e){var n=t,r=e,i=1.5707963267948966-e,o=Math.sin(1.5707963267948966),a=Math.sin(r),c=Math.sin(i),u=Math.cos(i),l=n/o;return Be(u*(l*a),u*(l*c))},vn=function(t,e){var n=t.width,r=t.height,i=e%(Math.PI/2),o=pn(n,i),a=pn(r,i),c=Je(t);return{tl:Be(c.tl.x+Math.abs(o.x),c.tl.y-Math.abs(o.y)),tr:Be(c.tr.x+Math.abs(a.y),c.tr.y+Math.abs(a.x)),br:Be(c.br.x-Math.abs(o.x),c.br.y+Math.abs(o.y)),bl:Be(c.bl.x-Math.abs(a.y),c.bl.y-Math.abs(a.x))}},gn=function(t,e,n,r){var i={x:t.x+e.x,y:t.y+e.y},o=vn(r,n),a=Ve(o.tl,-n,i),c=Ve(o.tr,-n,i),u=Ve(o.br,-n,i);return tn(Math.min(a.x,c.x,u.x),Math.min(a.y,c.y,u.y),Math.max(a.x,c.x,u.x)-Math.min(a.x,c.x,u.x),Math.max(a.y,c.y,u.y)-Math.min(a.y,c.y,u.y))},mn=function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=n.origin,o=n.translation,a=hn(t,n),c=2*Math.PI+n.rotation%(2*Math.PI),u=gn(i,o,c,e),l=Qe(u),s=e.height/e.width,f={x:(l.x-a.x)/a.width,y:(l.y-a.y)/a.height},d=f.y>.5?1-f.y:f.y,h=2*(f.x>.5?1-f.x:f.x)*a.width,p=2*d*a.height;return{center:f,zoom:r?Math.min(h/u.width,p/u.height):Math.min(a.width/u.width,a.height/u.height),rotation:n.rotation,aspectRatio:s,scaleToFit:r}},yn=function(t,e){var n=En(t,e);return{center:{x:Oe(n.center.x),y:Oe(n.center.y)},rotation:Oe(n.rotation),zoom:Oe(n.zoom),aspectRatio:Oe(n.aspectRatio),flip:z({},e.flip),scaleToFit:n.scaleToFit}},En=function(t,e){var n=mn(t,e.rectangle,e.transforms,e.limitToImageBounds);return{center:{x:n.center.x,y:n.center.y},rotation:n.rotation,zoom:n.zoom,aspectRatio:n.aspectRatio,flip:z({},e.flip),scaleToFit:n.scaleToFit}},_n=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"width",o=t.width,a=t.height;return o||a?(o=o&&Se(o,e.width,n.width),a=a&&Se(a,e.height,n.height),r?(a?o?"width"===i?a=o/r:"height"===i?o=a*r:(a*r<e.width?a=(o=e.width)/r:o/r<e.height&&(o=(a=e.height)*r),a*r>n.width?a=(o=n.width)/r:o/r>n.height&&(o=(a=n.height)*r)):a=Se(a*r,e.width,n.width)/r:o=Se(o/r,e.height,n.height)*r,{width:o,height:a}):{width:o,height:a}):{width:o,height:a}},wn=function(t,e){var n=new Array(20);return n[0]=t[0]*e[0]+t[1]*e[5]+t[2]*e[10]+t[3]*e[15],n[1]=t[0]*e[1]+t[1]*e[6]+t[2]*e[11]+t[3]*e[16],n[2]=t[0]*e[2]+t[1]*e[7]+t[2]*e[12]+t[3]*e[17],n[3]=t[0]*e[3]+t[1]*e[8]+t[2]*e[13]+t[3]*e[18],n[4]=t[0]*e[4]+t[1]*e[9]+t[2]*e[14]+t[3]*e[19]+t[4],n[5]=t[5]*e[0]+t[6]*e[5]+t[7]*e[10]+t[8]*e[15],n[6]=t[5]*e[1]+t[6]*e[6]+t[7]*e[11]+t[8]*e[16],n[7]=t[5]*e[2]+t[6]*e[7]+t[7]*e[12]+t[8]*e[17],n[8]=t[5]*e[3]+t[6]*e[8]+t[7]*e[13]+t[8]*e[18],n[9]=t[5]*e[4]+t[6]*e[9]+t[7]*e[14]+t[8]*e[19]+t[9],n[10]=t[10]*e[0]+t[11]*e[5]+t[12]*e[10]+t[13]*e[15],n[11]=t[10]*e[1]+t[11]*e[6]+t[12]*e[11]+t[13]*e[16],n[12]=t[10]*e[2]+t[11]*e[7]+t[12]*e[12]+t[13]*e[17],n[13]=t[10]*e[3]+t[11]*e[8]+t[12]*e[13]+t[13]*e[18],n[14]=t[10]*e[4]+t[11]*e[9]+t[12]*e[14]+t[13]*e[19]+t[14],n[15]=t[15]*e[0]+t[16]*e[5]+t[17]*e[10]+t[18]*e[15],n[16]=t[15]*e[1]+t[16]*e[6]+t[17]*e[11]+t[18]*e[16],n[17]=t[15]*e[2]+t[16]*e[7]+t[17]*e[12]+t[18]*e[17],n[18]=t[15]*e[3]+t[16]*e[8]+t[17]*e[13]+t[18]*e[18],n[19]=t[15]*e[4]+t[16]*e[9]+t[17]*e[14]+t[18]*e[19]+t[19],n},Tn=function(t){var e;if(/^#/.test(t)){if(4===t.length){var n=t.split("");t="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]}var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);e=[v()(r[1],16),v()(r[2],16),v()(r[3],16)]}else/^rgb/.test(t)&&((e=t.match(/\d+/g).map(function(t){return v()(t,10)})).length=3);return e},xn=[],Rn=function(t){var e=[];return it(t,function(t,n){return e.push(n)}),e.length?e.reduce(function(t,e){return wn(Y(t),e)},e.shift()):[]},bn=function(t){return t.crop.draft.transforms?t.crop.draft.transforms.scale:t.crop.transforms.scale},An=function(t){var e=t.image.width/t.image.naturalWidth,n=bn(t);return{width:t.options.cropMinImageWidth*n*e,height:t.options.cropMinImageHeight*n*e}},In=function(t){var e=bn(t);return{width:t.image.width*e,height:t.image.height*e}},Cn=function(t){return t.options.size?t.options.size.width:null},Sn=function(t){return t.options.size?t.options.size.height:null},On=function(t){return!1===t.size.width?Cn(t):t.size.width},Ln=function(t){return!1===t.size.height?Sn(t):t.size.height},Mn=function(t){return t.options.cropAspectRatioOptions?t.options.cropAspectRatioOptions.map(function(t){var e={aspectRatio:null,width:null,height:null};return"number"==typeof t.value&&(e.aspectRatio=t.value),"string"==typeof t.value&&(e.aspectRatio=en(t.value)),"object"===B(t.value)&&null!==t.value&&(e.width=t.value.width,e.height=t.value.height,e.aspectRatio=e.height/e.width),{label:t.label,value:e}}):null},Pn=function(t,e){e.aspectRatio||(e.aspectRatio=t.image.height/t.image.width);var n=Vn(t.image,e,e.scaleToFit),r=n.width/n.height;return t.stage.width<n.width&&(n.width=t.stage.width,n.height=n.width/r),t.stage.height<n.height&&(n.height=t.stage.height,n.width=n.height*r),tn(.5*t.stage.width-.5*n.width,.5*t.stage.height-.5*n.height,n.width,n.height)},Gn=function(t){var e=t.image.naturalWidth,n=t.image.naturalHeight,r=n/e;return t.stage.width<e&&(n=r*(e=t.stage.width)),t.stage.height<n&&(e=(n=t.stage.height)/r),tn(.5*t.stage.width-.5*e,.5*t.stage.height-.5*n,e,n)},kn=function(t){return{ALLOW_MANUAL_RESIZE:function(){return t.options.utils.includes("resize")},GET_SIZE:function(){return!1!==t.size.width&&!1!==t.size.height?{width:t.size.width,height:t.size.height}:{width:null,height:null}},GET_SIZE_INPUT:function(){return{width:t.size.width,height:t.size.height}},GET_SIZE_ASPECT_RATIO_LOCK:function(){return t.size.aspectRatioLocked},IS_ACTIVE_VIEW:function(e){return t.activeView===e},GET_ACTIVE_VIEW:function(){return t.activeView},GET_STYLES:function(){return L()(t.options).filter(function(t){return/^style/.test(t)}).map(function(e){return{name:e,value:t.options[e]}})},GET_FILE:function(){return t.file},GET_IMAGE:function(){return t.image},GET_STAGE:function(){return z({},t.stage,t.stageOffset)},GET_STAGE_RECT:function(e){var n,r=t.options.imagePreviewScaleMode;return(n="crop"===r?e?Pn(t,e):Gn(t):"image"===r?Gn(t):z({},t.stage)).fits=n.width<t.stage.width&&n.height<t.stage.height,n.mode=r,n},GET_IMAGE_STAGE_RECT:function(){return Gn(t)},GET_ROOT:function(){return t.rootRect},GET_ROOT_SIZE:function(){return{width:t.rootRect.width,height:t.rootRect.height}},GET_MIN_IMAGE_SIZE:function(){return{width:t.options.cropMinImageWidth,height:t.options.cropMinImageHeight}},GET_IMAGE_PREVIEW_SCALE_FACTOR:function(){return t.image.width/t.image.naturalWidth},GET_MIN_PREVIEW_IMAGE_SIZE:function(){var e=t.image.width/t.image.naturalWidth;return{width:t.options.cropMinImageWidth*e,height:t.options.cropMinImageHeight*e}},GET_MIN_CROP_SIZE:function(){return An(t)},GET_MAX_CROP_SIZE:function(){return In(t)},GET_MIN_PIXEL_CROP_SIZE:function(){var e=t.crop.transforms.scale,n=An(t);return{width:n.width/e,height:n.height/e}},GET_MAX_PIXEL_CROP_SIZE:function(){var e=t.crop.transforms.scale,n=In(t);return{width:n.width/e,height:n.height/e}},GET_CROP_ASPECT_RATIO_OPTIONS:function(){return Mn(t)},GET_ACTIVE_CROP_ASPECT_RATIO:function(){var e=t.crop.aspectRatio;return Kt(e)?en(e):e},GET_CROP_ASPECT_RATIO:function(){var e=Kt(t.options.cropAspectRatio)?en(t.options.cropAspectRatio):t.options.cropAspectRatio,n=Mn(t);return!n||n&&!n.length?e:n.find(function(t){return t.value.aspectRatio===e})?e:n[0].value.aspectRatio},GET_CROP_RECTANGLE_ASPECT_RATIO:function(){var e=t.crop,n=e.rectangle,r=e.aspectRatio;return n?n.width/n.height:r},GET_CROP:function(e,n){var r=xn[e];if(r&&r.ts===n)return r;var i=Fn(t);return i&&(i.ts=n,xn[e]=i),i},GET_COLOR_MATRIX:function(){return Rn(t.colorMatrices)},GET_COLOR_VALUES:function(){return z({exposure:t.options.colorExposure,brightness:t.options.colorBrightness,contrast:t.options.colorContrast,saturation:t.options.colorSaturation},t.colorValues)},GET_MARKUP_TOOL_VALUES:function(){return z({color:t.options.markupColor,fontFamily:t.options.markupFontFamily,fontSize:t.options.markupFontSize,shapeStyle:t.options.markupShapeStyle,lineStyle:t.options.markupLineStyle,lineDecoration:t.options.markupLineDecoration},t.markupToolValues)},GET_PREVIEW_IMAGE_DATA:function(){return t.file.preview},GET_THUMB_IMAGE_DATA:function(){return t.file.thumb},GET_FILTER:function(){return t.filter},GET_UID:function(){return t.uid},GET_MARKUP_BY_ID:function(e){return t.markup.find(function(t){return t[1].id===e})},GET_BACKGROUND_COLOR:function(){var e=t.options.outputCanvasBackgroundColor;if(!e)return Un;if(Dn[e])return Dn[e];var n=Tn(e);return Dn[e]=n.concat(1),Dn[e]}}},Dn={},Un=[0,0,0,0],Nn=function(t,e){var n=On(t),r=Ln(t),i=e.width/e.height;return _n({width:n,height:r},t.options.sizeMin,t.options.sizeMax,i)},Vn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.zoom,i=e.rotation,o=e.center,a=e.aspectRatio,c=rn(t,a,r),u={x:.5*c.width,y:.5*c.height},l={x:0,y:0,width:c.width,height:c.height,center:u},s=r*dn(t,nn(l,a),i,n?o:{x:.5,y:.5});return{widthFloat:c.width/s,heightFloat:c.height/s,width:Math.round(c.width/s),height:Math.round(c.height/s)}},Bn=function(t,e){var n=Qe(e),r=Qe(t);return!Le(r,n)},Fn=function(t){if(!t.stage||!t.image)return null;var e=t.crop.draft.rectangle||{free:t.crop.rectangle,limited:t.crop.rectangle},n=t.crop.draft.transforms||t.crop.transforms,r=n.origin,i=n.translation,o=n.scale,a=n.interaction,c=t.crop.rotation,u=t.crop.flip,l=!(!t.crop.draft.rectangle&&!t.crop.draft.transforms),s=l||t.instantUpdate,f=Bn(e.limited,t.stage),d=t.crop.isDirty||l,h=t.crop.isRotating,p=void 0===t.crop.limitToImageBounds||t.crop.limitToImageBounds,v={width:t.image.naturalWidth,height:t.image.naturalHeight},g=Rn(t.colorMatrices),m=En(t.image,{rectangle:e.limited,transforms:{origin:r,translation:i,scale:o,rotation:c.main+c.sub},flip:u,limitToImageBounds:t.crop.limitToImageBounds}),y={props:m,crop:Vn(v,m,t.crop.limitToImageBounds),image:Nn(t,e.limited)},E=y.image,_=y.crop,w=_.width,T=_.height,x=_.widthFloat/_.heightFloat;E.width&&E.height?(w=E.width,T=E.height):E.width&&!E.height?(w=E.width,T=E.width/x):E.height&&!E.width&&(T=E.height,w=E.height*x),y.currentWidth=Math.round(w),y.currentHeight=Math.round(T);var R={x:0,y:0},b=0,A=0;if(s&&a){if(a.translation){var I=a.translation.x-i.x,C=a.translation.y-i.y;R.x=100*Math.sign(I)*Math.log10(1+Math.abs(I)/100),R.y=100*Math.sign(C)*Math.log10(1+Math.abs(C)/100)}if(a.scale){var S=a.scale-o;b=.25*Math.sign(S)*Math.log10(1+Math.abs(S)/.25)}if(a.rotation){var O=a.rotation-(c.main+c.sub);A=.05*Math.sign(O)*Math.log10(1+Math.abs(O)/.05)}}var L={},M=e.free,P=Ke(M),G=Ke(e.limited);return it(P,function(t){var e=P[t]-G[t];L[t]=G[t]+5*Math.sign(e)*Math.log10(1+Math.abs(e)/5)}),{canRecenter:f,canReset:d,isDraft:s,isRotating:h,isLimitedToImageBounds:p,cropRect:{x:L.left,y:L.top,width:L.right-L.left,height:L.bottom-L.top},origin:r,translation:i,translationBand:R,scale:o,scaleBand:b,rotation:c,rotationBand:A,flip:u,interaction:a,cropStatus:y,colorMatrix:g,markup:t.markup}},zn=function(t){return/^image/.test(t.type)},Wn={1:function(){return[1,0,0,1,0,0]},2:function(t){return[-1,0,0,1,t,0]},3:function(t,e){return[-1,0,0,-1,t,e]},4:function(t,e){return[1,0,0,-1,0,e]},5:function(){return[0,1,1,0,0,0]},6:function(t,e){return[0,1,-1,0,e,0]},7:function(t,e){return[0,-1,-1,0,e,t]},8:function(t){return[0,-1,1,0,0,t]}},qn=function(t,e,n){return-1===n&&(n=1),Wn[n](t,e)},Yn=function(t){t.width=1,t.height=1,t.getContext("2d").clearRect(0,0,1,1)},Hn=function(t){return t&&(t.horizontal||t.vertical)},jn=function(t,e,n){if(e<=1&&!Hn(n))return t.width=t.naturalWidth,t.height=t.naturalHeight,t;var r=document.createElement("canvas"),i=t.naturalWidth,o=t.naturalHeight,a=e>=5&&e<=8;a?(r.width=o,r.height=i):(r.width=i,r.height=o);var c=r.getContext("2d");if(e&&c.transform.apply(c,qn(i,o,e)),Hn(n)){var u=[1,0,0,1,0,0];(!a&&n.horizontal||a&n.vertical)&&(u[0]=-1,u[4]=i),(!a&&n.vertical||a&&n.horizontal)&&(u[3]=-1,u[5]=o),c.transform.apply(c,u)}return c.drawImage(t,0,0,i,o),r},Zn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.canvasMemoryLimit,o=r.background,a=void 0===o?null:o,c=n.zoom||1,u=jn(t,e,n.flip),l={width:u.width,height:u.height},s=n.aspectRatio||l.height/l.width,f=rn(l,s,c);if(i){var d=f.width*f.height;if(d>i){var h=Math.sqrt(i)/Math.sqrt(d);l.width=Math.floor(l.width*h),l.height=Math.floor(l.height*h),f=rn(l,s,c)}}var p=document.createElement("canvas"),v={x:.5*f.width,y:.5*f.height},g={x:0,y:0,width:f.width,height:f.height,center:v},m=void 0===n.scaleToFit||n.scaleToFit,y=c*dn(l,nn(g,s),n.rotation,m?n.center:{x:.5,y:.5});p.width=Math.round(f.width/y),p.height=Math.round(f.height/y),v.x/=y,v.y/=y;var E=v.x-l.width*(n.center?n.center.x:.5),_=v.y-l.height*(n.center?n.center.y:.5),w=p.getContext("2d");a&&(w.fillStyle=a,w.fillRect(0,0,p.width,p.height)),w.translate(v.x,v.y),w.rotate(n.rotation||0),w.drawImage(u,E-v.x,_-v.y,l.width,l.height);var T=w.getImageData(0,0,p.width,p.height);return Yn(p),T},Xn="undefined"!=typeof window&&void 0!==window.document;Xn&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){var r=this.toDataURL(e,n).split(",")[1];setTimeout(function(){for(var n=atob(r),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);t(new Blob([o],{type:e||"image/png"}))})}}));var Kn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new f.a(function(r){var i=n?n(t):t;f.a.resolve(i).then(function(t){t.toBlob(r,e.type,e.quality)})})},$n=function(t,e){return er(t.x*e,t.y*e)},Qn=function(t,e){return er(t.x+e.x,t.y+e.y)},Jn=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return 0===e?{x:0,y:0}:er(t.x/e,t.y/e)},tr=function(t,e,n){var r=Math.cos(e),i=Math.sin(e),o=er(t.x-n.x,t.y-n.y);return er(n.x+r*o.x-i*o.y,n.y+i*o.x+r*o.y)},er=function(){return{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}},nr=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0;return"string"==typeof t?h()(t)*n:"number"==typeof t?t*(r?e[r]:Math.min(e.width,e.height)):void 0},rr=function(t,e,n){var r=t.borderStyle||t.lineStyle||"solid",i=t.backgroundColor||t.fontColor||"transparent",o=t.borderColor||t.lineColor||"transparent",a=nr(t.borderWidth||t.lineWidth,e,n);return{"stroke-linecap":t.lineCap||"round","stroke-linejoin":t.lineJoin||"round","stroke-width":a||0,"stroke-dasharray":"string"==typeof r?"":r.map(function(t){return nr(t,e,n)}).join(","),stroke:o,fill:i,opacity:t.opacity||1}},ir=function(t){return null!=t},or=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=nr(t.x,e,n,"width")||nr(t.left,e,n,"width"),i=nr(t.y,e,n,"height")||nr(t.top,e,n,"height"),o=nr(t.width,e,n,"width"),a=nr(t.height,e,n,"height"),c=nr(t.right,e,n,"width"),u=nr(t.bottom,e,n,"height");return ir(i)||(i=ir(a)&&ir(u)?e.height-a-u:u),ir(r)||(r=ir(o)&&ir(c)?e.width-o-c:c),ir(o)||(o=ir(r)&&ir(c)?e.width-r-c:0),ir(a)||(a=ir(i)&&ir(u)?e.height-i-u:0),{x:r||0,y:i||0,width:o||0,height:a||0}},ar=function(t){return t.map(function(t,e){return"".concat(0===e?"M":"L"," ").concat(t.x," ").concat(t.y)}).join(" ")},cr=function(t,e){return L()(e).forEach(function(n){return t.setAttribute(n,e[n])})},ur="http://www.w3.org/2000/svg",lr=function(t,e){var n=document.createElementNS(ur,t);return e&&cr(n,e),n},sr=function(t){return cr(t,z({},t.rect,t.styles))},fr=function(t){var e=t.rect.x+.5*t.rect.width,n=t.rect.y+.5*t.rect.height,r=.5*t.rect.width,i=.5*t.rect.height;return cr(t,z({cx:e,cy:n,rx:r,ry:i},t.styles))},dr={contain:"xMidYMid meet",cover:"xMidYMid slice"},hr=function(t,e){cr(t,z({},t.rect,t.styles,{preserveAspectRatio:dr[e.fit]||"none"}))},pr={left:"start",center:"middle",right:"end"},vr=function(t,e,n,r){var i=nr(e.fontSize,n,r),o=e.fontFamily||"sans-serif",a=e.fontWeight||"normal",c=pr[e.textAlign]||"start";cr(t,z({},t.rect,t.styles,{"stroke-width":0,"font-weight":a,"font-size":i,"font-family":o,"text-anchor":c})),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},gr=function(t,e,n,r){cr(t,z({},t.rect,t.styles,{fill:"none"}));var i=t.childNodes[0],o=t.childNodes[1],a=t.childNodes[2],c=t.rect,u={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(cr(i,{x1:c.x,y1:c.y,x2:u.x,y2:u.y}),e.lineDecoration){o.style.display="none",a.style.display="none";var l=Jn({x:u.x-c.x,y:u.y-c.y}),s=nr(.05,n,r);if(-1!==e.lineDecoration.indexOf("arrow-begin")){var f=$n(l,s),d=Qn(c,f),h=tr(c,2,d),p=tr(c,-2,d);cr(o,{style:"display:block;",d:"M".concat(h.x,",").concat(h.y," L").concat(c.x,",").concat(c.y," L").concat(p.x,",").concat(p.y)})}if(-1!==e.lineDecoration.indexOf("arrow-end")){var v=$n(l,-s),g=Qn(u,v),m=tr(u,2,g),y=tr(u,-2,g);cr(a,{style:"display:block;",d:"M".concat(m.x,",").concat(m.y," L").concat(u.x,",").concat(u.y," L").concat(y.x,",").concat(y.y)})}}},mr=function(t,e,n,r){cr(t,z({},t.styles,{fill:"none",d:ar(e.points.map(function(t){return{x:nr(t.x,n,r,"width"),y:nr(t.y,n,r,"height")}}))}))},yr=function(t){return function(e){return lr(t,{id:e.id})}},Er=function(t){var e=lr("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=function(){e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},_r=function(t){var e=lr("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=lr("line");e.appendChild(n);var r=lr("path");e.appendChild(r);var i=lr("path");return e.appendChild(i),e},wr={image:Er,rect:yr("rect"),ellipse:yr("ellipse"),text:yr("text"),path:yr("path"),line:_r},Tr={rect:sr,ellipse:fr,image:hr,text:vr,path:mr,line:gr},xr=function(t,e){return wr[t](e)},Rr=function(t,e,n,r,i){"path"!==e&&(t.rect=or(n,r,i)),t.styles=rr(n,r,i),Tr[e](t,n,r,i)},br=function(t,e){return t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0},Ar=function(t,e,n,r){return new f.a(function(i){var o=r.background,a=void 0===o?null:o,c=new FileReader;c.onloadend=function(){var t=c.result,r=document.createElement("div");r.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;",r.innerHTML=t;var o=r.querySelector("svg");document.body.appendChild(r);var u=o.getBBox();r.parentNode.removeChild(r);var l=r.querySelector("title"),s=o.getAttribute("viewBox")||"",f=o.getAttribute("width")||"",d=o.getAttribute("height")||"",p=h()(f)||null,v=h()(d)||null,g=(f.match(/[a-z]+/)||[])[0]||"",m=(d.match(/[a-z]+/)||[])[0]||"",y=s.split(" ").map(h.a),E=y.length?{x:y[0],y:y[1],width:y[2],height:y[3]}:u,_=null!=p?p:E.width,w=null!=v?v:E.height;o.style.overflow="visible",o.setAttribute("width",_),o.setAttribute("height",w);var T="";if(n&&n.length){var x={width:_,height:w};T=n.sort(br).reduce(function(t,e){var n=xr(e[0],e[1]);return Rr(n,e[0],e[1],x),n.removeAttribute("id"),1===n.getAttribute("opacity")&&n.removeAttribute("opacity"),t+"\n"+n.outerHTML+"\n"},""),T="\n\n<g>".concat(T.replace(/&nbsp;/g," "),"</g>\n\n")}var R=e.aspectRatio||w/_,b=_,A=b*R,I=void 0===e.scaleToFit||e.scaleToFit,C=dn({width:_,height:w},nn({width:b,height:A},R),e.rotation,I?e.center:{x:.5,y:.5}),S=e.zoom*C,O=e.rotation*(180/Math.PI),L={x:.5*b,y:.5*A},M={x:L.x-_*e.center.x,y:L.y-w*e.center.y},P=["rotate(".concat(O," ").concat(L.x," ").concat(L.y,")"),"translate(".concat(L.x," ").concat(L.y,")"),"scale(".concat(S,")"),"translate(".concat(-L.x," ").concat(-L.y,")"),"translate(".concat(M.x," ").concat(M.y,")")],G=["scale(".concat(e.flip.horizontal?-1:1," ").concat(e.flip.vertical?-1:1,")"),"translate(".concat(e.flip.horizontal?-_:0," ").concat(e.flip.vertical?-w:0,")")],k='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'.concat(b).concat(g,'" height="').concat(A).concat(m,'" \nviewBox="0 0 ').concat(b," ").concat(A,'" ').concat(a?'style="background:'+a+'" ':"",'\npreserveAspectRatio="xMinYMin"\nxmlns:xlink="http://www.w3.org/1999/xlink"\nxmlns="http://www.w3.org/2000/svg">\n\x3c!-- Generated by PQINA - https://pqina.nl/ --\x3e\n<title>').concat(l?l.textContent:"",'</title>\n<g transform="').concat(P.join(" "),'">\n<g transform="').concat(G.join(" "),'">\n').concat(o.outerHTML).concat(T,"\n</g>\n</g>\n</svg>");i(k)},c.readAsText(t)})},Ir=function(t){var e;try{e=new ImageData(t.width,t.height)}catch(n){e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},Cr=function(){var t={resize:function(t,e){var r=e.mode,a=void 0===r?"contain":r,c=e.upscale,u=void 0!==c&&c,l=e.width,s=e.height,f=e.matrix;if(f=!f||i(f)?null:f,!l&&!s)return o(t,f);if(null===l?l=s:null===s&&(s=l),"force"!==a){var d=l/t.width,h=s/t.height,p=1;if("cover"===a?p=Math.max(d,h):"contain"===a&&(p=Math.min(d,h)),p>1&&!1===u)return o(t,f);l=t.width*p,s=t.height*p}for(var v=t.width,g=t.height,m=Math.round(l),y=Math.round(s),E=t.data,_=new Uint8ClampedArray(m*y*4),w=v/m,T=g/y,x=Math.ceil(.5*w),R=Math.ceil(.5*T),b=0;b<y;b++)for(var A=0;A<m;A++){for(var I=4*(A+b*m),C=0,S=0,O=0,L=0,M=0,P=0,G=0,k=(b+.5)*T,D=Math.floor(b*T);D<(b+1)*T;D++)for(var U=Math.abs(k-(D+.5))/R,N=(A+.5)*w,V=U*U,B=Math.floor(A*w);B<(A+1)*w;B++){var F=Math.abs(N-(B+.5))/x,z=Math.sqrt(V+F*F);if(z>=-1&&z<=1&&(C=2*z*z*z-3*z*z+1)>0){var W=E[3+(F=4*(B+D*v))];G+=C*W,O+=C,W<255&&(C=C*W/250),L+=C*E[F],M+=C*E[F+1],P+=C*E[F+2],S+=C}}_[I]=L/S,_[I+1]=M/S,_[I+2]=P/S,_[I+3]=G/O,f&&n(I,_,f)}return{data:_,width:m,height:y}},filter:o},e=function(e,n){var r=e.transforms,i=null;if(r.forEach(function(t){"filter"===t.type&&(i=t)}),i){var o=null;r.forEach(function(t){"resize"===t.type&&(o=t)}),o&&(o.data.matrix=i.data,r=r.filter(function(t){return"filter"!==t.type}))}n(function(e,n){return e.forEach(function(e){n=t[e.type](n,e.data)}),n}(r,e.imageData))};function n(t,e,n){for(var r=0,i=0,o=0,a=e[t]/255,c=e[t+1]/255,u=e[t+2]/255,l=e[t+3]/255;r<4;r++)o=255*(a*n[i=5*r]+c*n[i+1]+u*n[i+2]+l*n[i+3]+n[i+4]),e[t+r]=Math.max(0,Math.min(o,255))}self.onmessage=function(t){e(t.data.message,function(e){self.postMessage({id:t.data.id,message:e},[e.data.buffer])})};var r=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function i(t){return self.JSON.stringify(t||[])===r}function o(t,e){if(!e||i(e))return t;for(var n=t.data,r=n.length,o=e[0],a=e[1],c=e[2],u=e[3],l=e[4],s=e[5],f=e[6],d=e[7],h=e[8],p=e[9],v=e[10],g=e[11],m=e[12],y=e[13],E=e[14],_=e[15],w=e[16],T=e[17],x=e[18],R=e[19],b=0,A=0,I=0,C=0,S=0;b<r;b+=4)A=n[b]/255,I=n[b+1]/255,C=n[b+2]/255,S=n[b+3]/255,n[b]=Math.max(0,Math.min(255*(A*o+I*a+C*c+S*u+l),255)),n[b+1]=Math.max(0,Math.min(255*(A*s+I*f+C*d+S*h+p),255)),n[b+2]=Math.max(0,Math.min(255*(A*v+I*g+C*m+S*y+E),255)),n[b+3]=Math.max(0,Math.min(255*(A*_+I*w+C*T+S*x+R),255));return t}},Sr=function(t,e){if(1165519206===t.getUint32(e+4,!1)){e+=4;var n=18761===t.getUint16(e+=6,!1);e+=t.getUint32(e+4,n);var r=t.getUint16(e,n);e+=2;for(var i=0;i<r;i++)if(274===t.getUint16(e+12*i,n))return t.setUint16(e+12*i+8,1,n),!0;return!1}},Or=function(t){var e=new DataView(t);if(65496!==e.getUint16(0))return null;for(var n,r,i=2,o=!1;i<e.byteLength;){if(n=e.getUint16(i,!1),r=e.getUint16(i+2,!1)+2,!(n>=65504&&n<=65519||65534===n))break;if(o||(o=Sr(e,i,r)),i+r>e.byteLength)break;i+=r}return t.slice(0,i)},Lr=function(t){return new f.a(function(e){var n=new FileReader;n.onload=function(){return e(Or(n.result)||null)},n.readAsArrayBuffer(t.slice(0,262144))})},Mr=function(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder},Pr=function(t,e){var n=Mr();if(n){var r=new n;return r.append(t),r.getBlob(e)}return new Blob([t],{type:e})},Gr=function(){return Math.random().toString(36).substr(2,9)},kr=function(t){var e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(e),r=new Worker(n),i=[];return{transfer:function(){},post:function(t,e,n){var o=Gr();i[o]=e,r.onmessage=function(t){var e=i[t.data.id];e&&(e(t.data.message),delete i[t.data.id])},r.postMessage({id:o,message:t},n)},terminate:function(){r.terminate(),URL.revokeObjectURL(n)}}},Dr=function(t){return new f.a(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=function(t){n(t)},r.src=t})},Ur=function(t){return t.reduce(function(t,e){return t.then(function(t){return e().then(Array.prototype.concat.bind(t))})},f.a.resolve([]))},Nr=function(t,e){return new f.a(function(n){var r={width:t.width,height:t.height},i=t.getContext("2d"),o=e.sort(br).map(function(t){return function(){return new f.a(function(e){jr[t[0]](i,r,t[1],e)&&e()})}});Ur(o).then(function(){return n(t)})})},Vr=function(t,e){t.beginPath(),t.lineCap=e["stroke-linecap"],t.lineJoin=e["stroke-linejoin"],t.lineWidth=e["stroke-width"],e["stroke-dasharray"].length&&t.setLineDash(e["stroke-dasharray"].split(",")),t.fillStyle=e.fill,t.strokeStyle=e.stroke,t.globalAlpha=e.opacity||1},Br=function(t){t.fill(),t.stroke(),t.globalAlpha=1},Fr=function(t,e,n){var r=or(n,e),i=rr(n,e);return Vr(t,i),t.rect(r.x,r.y,r.width,r.height),Br(t,i),!0},zr=function(t,e,n){var r=or(n,e),i=rr(n,e);Vr(t,i);var o=r.x,a=r.y,c=r.width,u=r.height,l=c/2*.5522848,s=u/2*.5522848,f=o+c,d=a+u,h=o+c/2,p=a+u/2;return t.moveTo(o,p),t.bezierCurveTo(o,p-s,h-l,a,h,a),t.bezierCurveTo(h+l,a,f,p-s,f,p),t.bezierCurveTo(f,p+s,h+l,d,h,d),t.bezierCurveTo(h-l,d,o,p+s,o,p),Br(t,i),!0},Wr=function(t,e,n,r){var i=or(n,e),o=rr(n,e);Vr(t,o);var a=new Image;a.onload=function(){if("cover"===n.fit){var e=i.width/i.height,c=e>1?a.width:a.height*e,u=e>1?a.width/e:a.height,l=.5*a.width-.5*c,s=.5*a.height-.5*u;t.drawImage(a,l,s,c,u,i.x,i.y,i.width,i.height)}else if("contain"===n.fit){var f=Math.min(i.width/a.width,i.height/a.height),d=f*a.width,h=f*a.height,p=i.x+.5*i.width-.5*d,v=i.y+.5*i.height-.5*h;t.drawImage(a,0,0,a.width,a.height,p,v,d,h)}else t.drawImage(a,0,0,a.width,a.height,i.x,i.y,i.width,i.height);Br(t,o),r()},a.src=n.src},qr=function(t,e,n){var r=or(n,e),i=rr(n,e);Vr(t,i);var o=nr(n.fontSize,e),a=n.fontFamily||"sans-serif",c=n.fontWeight||"normal",u=n.textAlign||"left";return t.font="".concat(c," ").concat(o,"px ").concat(a),t.textAlign=u,t.fillText(n.text,r.x,r.y),Br(t,i),!0},Yr=function(t,e,n){var r=rr(n,e);Vr(t,r),t.beginPath();var i=n.points.map(function(t){return{x:nr(t.x,e,1,"width"),y:nr(t.y,e,1,"height")}});t.moveTo(i[0].x,i[0].y);for(var o=i.length,a=1;a<o;a++)t.lineTo(i[a].x,i[a].y);return Br(t,r),!0},Hr=function(t,e,n){var r=or(n,e),i=rr(n,e);Vr(t,i),t.beginPath();var o={x:r.x,y:r.y},a={x:r.x+r.width,y:r.y+r.height};t.moveTo(o.x,o.y),t.lineTo(a.x,a.y);var c=Jn({x:a.x-o.x,y:a.y-o.y}),u=.04*Math.min(e.width,e.height);if(-1!==n.lineDecoration.indexOf("arrow-begin")){var l=$n(c,u),s=Qn(o,l),f=tr(o,2,s),d=tr(o,-2,s);t.moveTo(f.x,f.y),t.lineTo(o.x,o.y),t.lineTo(d.x,d.y)}if(-1!==n.lineDecoration.indexOf("arrow-end")){var h=$n(c,-u),p=Qn(a,h),v=tr(a,2,p),g=tr(a,-2,p);t.moveTo(v.x,v.y),t.lineTo(a.x,a.y),t.lineTo(g.x,g.y)}return Br(t,i),!0},jr={rect:Fr,ellipse:zr,image:Wr,text:qr,line:Hr,path:Yr},Zr=function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e},Xr=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new f.a(function(r,i){if(!t||!zn(t))return i({status:"not an image file",file:t});var o=n.stripImageHead,a=n.beforeCreateBlob,c=n.afterCreateBlob,u=n.canvasMemoryLimit,l=e.crop,s=e.size,d=e.filter,h=e.markup,p=e.output,v=e.image&&e.image.orientation?Math.max(1,Math.min(8,e.image.orientation)):null,g=p&&p.quality,m=null===g?null:g/100,y=p&&p.type||null,E=p&&p.background||null,_=[];!s||"number"!=typeof s.width&&"number"!=typeof s.height||_.push({type:"resize",data:s}),d&&20===d.length&&_.push({type:"filter",data:d});var w=function(t){var e=c?c(t):t;f.a.resolve(e).then(r)},T=function(e,n){var r=Zr(e),c=h.length?Nr(r,h):r;f.a.resolve(c).then(function(e){Kn(e,n,a).then(function(n){if(Yn(e),o)return w(n);Lr(t).then(function(t){null!==t&&(n=new Blob([t,n.slice(20)],{type:n.type})),w(n)})}).catch(i)})};if(/svg/.test(t.type)&&null===y)return Ar(t,l,h,{background:E}).then(function(t){r(Pr(t,"image/svg+xml"))});var x=URL.createObjectURL(t);Dr(x).then(function(e){URL.revokeObjectURL(x);var n=Zn(e,v,l,{canvasMemoryLimit:u,background:E}),r={quality:m,type:y||t.type};if(!_.length)return T(n,r);var i=kr(Cr);i.post({transforms:_,imageData:n},function(t){T(Ir(t),r),i.terminate()},[n.data.buffer])}).catch(i)})},Kr=function(t,e){if(1165519206!==t.getUint32(e+=2,!1))return-1;var n=18761===t.getUint16(e+=6,!1);e+=t.getUint32(e+4,n);var r=t.getUint16(e,n);e+=2;for(var i=0;i<r;i++)if(274===t.getUint16(e+12*i,n))return t.getUint16(e+12*i+8,n)},$r=function(t){var e=new DataView(t);if(65496!=e.getUint16(0,!1))return null;for(var n,r=e.byteLength,i=2;i<r;){if(e.getUint16(i+2,!1)<=8)return-1;if(n=e.getUint16(i,!1),i+=2,65505===n)return Kr(e,i);if(65280!=(65280&n))return null;i+=e.getUint16(i,!1)}},Qr=function(t){return new f.a(function(e){var n=new FileReader;n.onload=function(){return e($r(n.result)||-1)},n.readAsArrayBuffer(t.slice(0,262144))})},Jr={HORIZONTAL:1,VERTICAL:2},ti=function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.center,o=t.zoom,a=t.aspectRatio,c=Qe(e),u={x:c.x-n.width*i.x,y:c.y-n.height*i.y},l=2*Math.PI+t.rotation%(2*Math.PI),s=o*dn(n,nn(e,a||n.height/n.width),l,r?i:{x:.5,y:.5});return{origin:{x:i.x*n.width,y:i.y*n.height},translation:u,scale:s,rotation:t.rotation}},ei=function(t){return{origin:z({},t.origin),translation:z({},t.translation),rotation:t.rotation,scale:t.scale}},ni=function(t,e,n,r){var i=n.translation,o=n.scale,a=n.rotation,c=n.origin,u={origin:z({},c),translation:z({},i),scale:o,rotation:2*Math.PI+a%(2*Math.PI)},l=t.height/t.width,s=gn(c,i,u.rotation,e),f=Qe(s),d=Ke(s),h=hn(t,n),p=Qe(h),v={x:h.x,y:h.y},g={x:p.x,y:p.y},m=f.x,y=f.y,E={x:v.x,y:v.y,width:h.width,height:h.height};if(!ze(s,h))if("moving"===r){E.y>s.y?E.y=s.y:E.y+E.height<d.bottom&&(E.y=d.bottom-E.height),E.x>s.x?E.x=s.x:E.x+E.width<d.right&&(E.x=d.right-E.width);var _=hn(t,z({},n,{scale:u.scale})),w=Qe(_);g.x=w.x,g.y=w.y,v.x=_.x,v.y=_.y,E.x=g.x-.5*E.width,E.y=g.y-.5*E.height,E.y>s.y?E.y=s.y:E.y+E.height<d.bottom&&(E.y=d.bottom-E.height),E.x>s.x?E.x=s.x:E.x+E.width<d.right&&(E.x=d.right-E.width);var T={x:E.x-v.x,y:E.y-v.y},x={x:T.x*Math.cos(u.rotation)-T.y*Math.sin(u.rotation),y:T.x*Math.sin(u.rotation)+T.y*Math.cos(u.rotation)};u.translation.x+=x.x,u.translation.y+=x.y}else if("resizing"===r){h.width<s.width&&(E.width=s.width,E.height=E.width*l,E.height<s.height&&(E.height=s.height,E.width=E.height/l)),h.height<s.height&&(E.height=s.height,E.width=E.height/l,E.width<s.width&&(E.width=s.width,E.height=E.width*l)),E.x=g.x-.5*E.width,E.y=g.y-.5*E.height,E.y>s.y?E.y=s.y:E.y+E.height<d.bottom&&(E.y=d.bottom-E.height),E.x>s.x?E.x=s.x:E.x+E.width<d.right&&(E.x=d.right-E.width),u.scale=dn(t,e,u.rotation,{x:(m-E.x)/E.width,y:(y-E.y)/E.height});var R=hn(t,z({},n,{scale:u.scale})),b=Qe(R);g.x=b.x,g.y=b.y,v.x=R.x,v.y=R.y,E.x=g.x-.5*E.width,E.y=g.y-.5*E.height,E.y>s.y?E.y=s.y:E.y+E.height<d.bottom&&(E.y=d.bottom-E.height),E.x>s.x?E.x=s.x:E.x+E.width<d.right&&(E.x=d.right-E.width);var A={x:E.x-v.x,y:E.y-v.y},I={x:A.x*Math.cos(u.rotation)-A.y*Math.sin(u.rotation),y:A.x*Math.sin(u.rotation)+A.y*Math.cos(u.rotation)};u.translation.x+=I.x,u.translation.y+=I.y}else if("rotating"===r){var C=!1;if(E.y>s.y){var S=E.y-s.y;E.y=s.y,E.height+=2*S,C=!0}if(E.y+E.height<d.bottom){var O=d.bottom-(E.y+E.height);E.y=d.bottom-E.height,E.height+=2*O,C=!0}if(E.x>s.x){var L=E.x-s.x;E.x=s.x,E.width+=2*L,C=!0}if(E.x+E.width<d.right){var M=d.right-(E.x+E.width);E.x=d.right-E.width,E.width+=2*M,C=!0}C&&(u.scale=dn(t,e,u.rotation,{x:(m-h.x)/h.width,y:(y-h.y)/h.height}))}return z({},u,{rotation:n.rotation})},ri=function(t,e,n){var r=n.origin,i=n.translation,o=n.scale,a=2*Math.PI+n.rotation%(2*Math.PI),c={x:r.x+i.x,y:r.y+i.y},u=gn(r,i,a,e),l=hn(t,n),s=Je(l),f=Qe(l),d=Ve(s.tl,a,c),h=Ve(s.br,a,c),p=d.x+.5*(h.x-d.x),v=d.y+.5*(h.y-d.y),g=He(l,{x:p-f.x,y:v-f.y}),m=He(u,{x:p-f.x,y:v-f.y}),y=Qe(m),E={x:g.x,y:g.y},_=g.width,w=g.height,T=(y.x-E.x)/_,x=(y.y-E.y)/w,R={x:T*t.width,y:x*t.height},b=1-o,A=R.x*b,I=R.y*b,C={x:E.x+_*T,y:E.y+w*x},S=Ve(E,a,{x:E.x+.5*_,y:E.y+.5*w}),O=Ve(E,a,C),L=S.x-O.x,M=S.y-O.y;return{origin:Me(R),translation:Me({x:E.x-A+L,y:E.y-I+M})}},ii={n:function(t){return{x:t.x+.5*t.width,y:t.y}},e:function(t){return{x:t.x+t.width,y:t.y+.5*t.height}},s:function(t){return{x:t.x+.5*t.width,y:t.y+t.height}},w:function(t){return{x:t.x,y:t.y+.5*t.height}}},oi=function(t,e){return ii[t](e)},ai=function(t,e,n){var r=n.origin,i=n.translation,o=2*Math.PI+n.rotation%(2*Math.PI),a=hn(t,n),c={x:r.x+i.x,y:r.y+i.y},u=gn(r,i,o,e),l=Ke(u),s=Ke(a),f=a;if(l.top<s.top||l.right>s.right||l.bottom>s.bottom||l.left<s.left){var d=z({},s);if(l.top<=d.top){var h=d.bottom-d.top,p=d.right-d.left,v=Math.max(1,u.height/h),g=h*v,m=p*v-p;d.bottom=l.top+g,d.top=l.top,d.left-=.5*m,d.right+=.5*m}if(l.bottom>=d.bottom){var y=d.bottom-d.top,E=d.right-d.left,_=Math.max(1,u.height/y),w=y*_,T=E*_-E;d.bottom=l.bottom,d.top=l.bottom-w,d.left-=.5*T,d.right+=.5*T}if(l.left<=d.left){var x=d.bottom-d.top,R=d.right-d.left,b=Math.max(1,u.width/R),A=R*b,I=x*b-x;d.right=l.left+A,d.left=l.left,d.top-=.5*I,d.bottom+=.5*I}if(l.right>=d.right){var C=d.bottom-d.top,S=d.right-d.left,O=Math.max(1,u.width/S),L=S*O,M=C*O-C;d.right=l.right,d.left=l.right-L,d.top-=.5*M,d.bottom+=.5*M}f=tn(d.left,d.top,d.right-d.left,d.bottom-d.top)}var P=Je(f),G=Qe(f),k=Ve(P.tl,o,c),D=Ve(P.br,o,c),U=k.x+.5*(D.x-k.x),N=k.y+.5*(D.y-k.y),V=He(f,{x:U-G.x,y:N-G.y}),B=He(u,{x:U-G.x,y:N-G.y}),F=Qe(B),W={x:V.x,y:V.y},q=V.width,Y=V.height,H=(F.x-W.x)/q,j=(F.y-W.y)/Y,Z=q/t.width,X={x:H*t.width,y:j*t.height},K=1-Z,$=X.x*K,Q=X.y*K,J={x:W.x+q*H,y:W.y+Y*j},tt=Ve(W,o,{x:W.x+.5*q,y:W.y+.5*Y}),et=Ve(W,o,J),nt=tt.x-et.x,rt=tt.y-et.y;return{origin:X,translation:{x:W.x-$+nt,y:W.y-Q+rt},scale:Z,rotation:n.rotation}},ci=function(t,e,n,r,i,o,a,c,u){var l=o.left,s=o.right,f=o.top,d=o.bottom,h=s-l,p=d-f,v=i.left,g=i.right,m=i.top,y=i.bottom;if(n===Jr.VERTICAL){if(m=t.y>0?r.y:Math.min(r.y,Math.max(e.y,f)),y=t.y>0?Math.max(r.y,Math.min(e.y,d)):r.y,a){var E=(y-m)/a;v=r.x-.5*E,g=r.x+.5*E}}else if(v=t.x>0?r.x:Math.min(r.x,Math.max(e.x,l)),g=t.x>0?Math.max(r.x,Math.min(e.x,s)):r.x,a){var _=(g-v)*a;m=r.y-.5*_,y=r.y+.5*_}var w,T,x,R,b=c.width,A=c.height;if(n===Jr.VERTICAL?(w=r.x-.5*b,T=r.x+.5*b,t.y<0?(x=r.y-A,R=r.y):t.y>0&&(x=r.y,R=r.y+A)):(x=r.y-.5*A,R=r.y+.5*A,t.x<0?(w=r.x-b,T=r.x):t.x>0&&(w=r.x,T=r.x+b)),a)if(n===Jr.VERTICAL){var I=Math.min((y-m)/a,h),C=I*a;v<l&&(g=(v=l)+I),g>s&&(v=(g=s)-I),r.x=v+.5*I,t.y<0?m=r.y-C:t.y>0&&(y=r.y+C)}else{var S=Math.min((g-v)*a,p),O=S/a;m<f&&(y=(m=f)+S),y>d&&(m=(y=d)-S),r.y=m+.5*S,t.x<0?v=r.x-O:t.x>0&&(g=r.x+O)}var L=$e({top:m,right:g,bottom:y,left:v}),M=function(){var e=b*a;n===Jr.HORIZONTAL?(m=r.y-.5*e,y=r.y+.5*e):t.y<0?(y=r.y,m=y-e):t.y>0&&(m=r.y,y=m+e)},P=function(){var e=A/a;n===Jr.VERTICAL?(v=r.x-.5*e,g=r.x+.5*e):t.x<0?(g=r.x,v=g-e):t.x>0&&(v=r.x,g=v+e)};g<T&&(g=T,v=T-b,a&&M()),v>w&&(v=w,g=w+b,a&&M()),m>x&&(m=x,y=x+A,a&&P()),y<R&&(y=R,m=R-A,a&&P());var G=u.width,k=u.height;if(a&&(a<1?G=k/a:k=G*a),g-v>G&&(t.x<0?v=r.x-G:g=r.x+G),y-m>k&&(t.y<0?m=r.y-k:y=r.y+k),g-v==0&&(t.x>0?g=r.x+2:v=r.x-2),y-m==0&&(t.y>0?y=r.y+2:m=r.y-2),Math.round(v)<l||Math.round(g)>s||Math.round(m)<f||Math.round(y)>d){var D=d-f,U=s-l;if(v<l){v=l;var N=Math.min(g-v,U);g=v+N}if(g>s){g=s;var V=Math.min(g-v,U);v=g-V}if(m<f){m=f;var B=Math.min(y-m,D);y=m+B}if(y>d){y=d;var F=Math.min(y-m,D);m=y-F}L=$e({top:m,right:g,bottom:y,left:v})}return{free:L,limited:$e({top:m,right:g,bottom:y,left:v})}},ui={nw:function(t){return{x:t.x,y:t.y}},ne:function(t){return{x:t.x+t.width,y:t.y}},se:function(t){return{x:t.x+t.width,y:t.y+t.height}},sw:function(t){return{x:t.x,y:t.y+t.height}}},li=function(t,e){return ui[t](e)},si=function(t,e,n,r,i,o,a){var c=Ke(r),u=c.left,l=c.right,s=c.top,f=c.bottom,d=Ne({x:e.x,y:e.y},r),h=t.x>0?n.x:Math.min(d.x,n.x),p=t.x>0?Math.max(n.x,d.x):n.x,v=t.y>0?n.y:Math.min(d.y,n.y),g=t.y>0?Math.max(n.y,d.y):n.y;if(i){var m=d.x-n.x;t.x>0?p=Math.max(n.x,n.x+t.x*m):h=Math.min(n.x,n.x-t.x*m),t.y>0?g=Math.max(n.y,n.y+t.x*m*i):v=Math.min(n.y,n.y-t.x*m*i)}var y=$e({top:v,right:p,bottom:g,left:h});if($e({top:v,right:p,bottom:g,left:h}),o.width&&o.height){var E=o.width,_=o.height;i&&(1===i?_=E=Math.max(E,_):E<_?E=_/i:E>_?_=E*i:E=_/i),p-h<E&&(t.x>0?p=n.x+E:h=n.x-E),g-v<_&&(t.y>0?g=n.y+_:v=n.y-_);var w=a.width,T=a.height;i&&(i<1?w=T/i:T=w*i),p-h>w&&(t.x<0?h=n.x-w:p=n.x+w),g-v>T&&(t.y<0?v=n.y-T:g=n.y+T)}if(p-h==0&&(t.x>0?p=n.x+2:h=n.x-2),g-v==0&&(t.y>0?g=n.y+2:v=n.y-2),Math.round(h)<u||Math.round(p)>l||Math.round(v)<s||Math.round(g)>f){var x=f-s,R=l-u;if(h<u){h=u;var b=Math.min(p-h,R);p=h+b,i&&(t.y>0&&(g=n.y+b*i),t.y<0&&(v=n.y-b*i))}if(p>l){p=l;var A=Math.min(p-h,R);h=p-A,i&&(t.y>0&&(g=n.y+A*i),t.y<0&&(v=n.y-A*i))}if(v<s){v=s;var I=Math.min(g-v,x);g=v+I,i&&(t.x>0&&(p=n.x+I/i),t.x<0&&(h=n.x-I/i))}if(g>f){g=f;var C=Math.min(g-v,x);v=g-C,i&&(t.x>0&&(p=n.x+C/i),t.x<0&&(h=n.x-C/i))}y=$e({top:v,right:p,bottom:g,left:h})}return{free:y,limited:$e({top:v,right:p,bottom:g,left:h})}},fi=function(t,e,n){var r=Xe(t);return r.width=Math.min(r.height,r.width),r.height=r.width,r.height=r.width*e,r.height<n.height&&(r.height=n.height,r.width=r.height/e),r.width<n.width&&(r.width=n.width,r.height=r.width*e),r},di=Math.PI/2,hi=Math.PI/4,pi=function(t){var e=Oe(hi),n=Oe(di),r=t/n,i=Math.floor(r)*n,o=t-i;return o>e&&(o-=n,i+=n),{main:i,sub:o}},vi=function(t){return new f.a(function(e,n){var r=new Image;r.src=URL.createObjectURL(t),r.onerror=function(t){clearInterval(i),n(t)};var i=setInterval(function(){r.naturalWidth&&r.naturalHeight&&(clearInterval(i),URL.revokeObjectURL(r.src),e({width:r.naturalWidth,height:r.naturalHeight}))},1)})},gi=function(t,e){var n={width:t.width,height:t.height};if(t.width>e.width||t.height>e.height){var r=t.height/t.width,i=e.width/t.width,o=e.height/t.height;i<o?(n.width=t.width*i,n.height=n.width*r):(n.height=t.height*o,n.width=n.height/r)}return n},mi=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(e+t).slice(-e.length)},yi=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return"".concat(t.getFullYear(),"-").concat(mi(t.getMonth()+1,"00"),"-").concat(mi(t.getDate(),"00"),"_").concat(mi(t.getHours(),"00"),"-").concat(mi(t.getMinutes(),"00"),"-").concat(mi(t.getSeconds(),"00"))},Ei=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t("GET_CROP_ASPECT_RATIO"),o={center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null};n?m()(o,n):e.options.crop?m()(o,e.options.crop):o.aspectRatio=i;var a=r.width,c=r.height;if(a&&c)o.aspectRatio=c/a;else if(e.instructions.size){var u=e.instructions.size,l=u.width,s=u.height;l&&s&&(o.aspectRatio=s/l)}return o},_i=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},wi=function(t){return t.split(".").pop()},Ti=function(t){if("string"!=typeof t)return"";var e=t.split("/").pop();return/svg/.test(e)?"svg":/zip|compressed/.test(e)?"zip":/plain/.test(e)?"txt":/msword/.test(e)?"doc":/[a-z]+/.test(e)?"jpeg"===e?"jpg":e:""},xi=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i="string"==typeof n?t.slice(0,t.size,n):t.slice(0,t.size,t.type);return i.lastModifiedDate=new Date,Kt(e)||(e=yi()),e&&null===r&&wi(e)?i.name=e:(r=r||Ti(i.type),i.name=e+(r?"."+r:"")),i},Ri=function(t){return t.substr(0,t.lastIndexOf("."))||t},bi={jpeg:"jpg","svg+xml":"svg"},Ai=function(t,e){var n=Ri(t),r=e.split("/")[1],i=bi[r]||r;return"".concat(n,".").concat(i)},Ii=function(t){return/jpeg|png|svg\+xml/.test(t)?t:"image/jpeg"},Ci=function(t){return b()(t)&&20===t.length},Si=["x","y","left","top","right","bottom","width","height"],Oi=function(t){return"string"==typeof t&&/%/.test(t)?h()(t)/100:t},Li=function(){return Math.random().toString(36).substr(2,9)},Mi=function(t){var e=q(t,2),n=e[0],r=e[1],i=!1!==r.allowSelect,o=!1!==r.allowMove,a=!1!==r.allowResize,c=!1!==r.allowInput,u=!1!==r.allowDestroy,l=void 0===r.allowEdit||r.allowEdit;(!0===r.allowResize||!0===r.allowMove||!0===r.allowInput||r.allowEdit)&&(i=!0),!1===r.allowMove&&(a=!1),!0===r.allowResize&&(o=!0);var s=r.points?{}:Si.reduce(function(t,e){return t[e]=Oi(r[e]),t},{});return r.points&&(a=!1),[n,z({zIndex:0,id:Li()},r,s,{isDestroyed:!1,isSelected:!1,isDirty:!0,allowDestroy:u,allowSelect:i,allowMove:o,allowResize:a,allowInput:c,allowEdit:l})]},Pi=function(t){if(!t)return null;var e=t.split(/filename=|filename\*=.+''/).splice(1).map(function(t){return t.trim().replace(/^["']|[;"']{0,2}$/g,"")}).filter(function(t){return t.length});return e.length?decodeURI(e[e.length-1]):null},Gi=function(t){return[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0]},ki=function(t){return[t,0,0,0,.5*(1-t),0,t,0,0,.5*(1-t),0,0,t,0,.5*(1-t),0,0,0,1,0]},Di=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return[.213+.787*t,.715-.715*t,.072-.072*t,0,0,.213-.213*t,.715+.285*t,.072-.072*t,0,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,0,1,0]},Ui=function(t){return[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0]},Ni={contrast:ki,exposure:Ui,brightness:Gi,saturation:Di},Vi=function(t){return t.borderWidth?"borderColor":t.lineWidth?"lineColor":t.fontColor?"fontColor":t.backgroundColor?"backgroundColor":void 0},Bi=function(t){var e=t.fontColor,n=t.backgroundColor,r=t.lineColor,i=t.borderColor;return e||n||r||i},Fi=Math.PI/2,zi=function(t){var e={upscale:t("GET_OUTPUT_UPSCALE"),mode:t("GET_OUTPUT_FIT"),width:t("GET_OUTPUT_WIDTH"),height:t("GET_OUTPUT_HEIGHT")},n=t("GET_SIZE_INPUT");if(t("ALLOW_MANUAL_RESIZE")&&(n.width||n.height)){var r=n.width,i=n.height,o=t("GET_CROP_RECTANGLE_ASPECT_RATIO");r&&!i?i=r/o:i&&!r&&(r=i*o),e.width=r,e.height=i,e.upscale=!0,e.mode="force"}return e},Wi=function(t,e){var n=e("GET_UID"),r=e("GET_CROP",n,l()()),i={width:r.cropStatus.currentWidth,height:r.cropStatus.currentHeight},o=t.mode,a=t.width,c=t.height,u=t.upscale;if(!a&&!c)return i;if(null===a?a=c:null===c&&(c=a),"force"!==o){var s=a/i.width,f=c/i.height,d=1;if("cover"===o?d=Math.max(s,f):"contain"===o&&(d=Math.min(s,f)),d>1&&!1===u)return i;a=i.width*d,c=i.height*d}return{width:Math.round(a),height:Math.round(c)}},qi=function(t){return t.markup.filter(function(t){return!t[1].isDestroyed})},Yi=function(t,e,n){return new f.a(function(r,i){var o={data:null,file:null},a=yn(e.image,e.crop),c=zi(n),u={crop:a,image:z({},Wi(c,n),{orientation:e.file.orientation}),size:c,output:{type:n("GET_OUTPUT_TYPE"),quality:n("GET_OUTPUT_QUALITY"),background:e.options.outputCanvasBackgroundColor},filter:e.colorMatrices.filter?{id:e.filterName,value:e.filterValue,matrix:e.colorMatrices.filter}:null,color:L()(e.colorValues).length?L()(e.colorValues).reduce(function(t,n){return t[n]={value:e.colorValues[n],matrix:e.colorMatrices[n].map(function(t){return Oe(t,5)})},t},{}):null,markup:qi(e).map(function(t){return[t[0],z({},t[1])]}),colorMatrix:n("GET_COLOR_MATRIX")};if(t.data&&(o.data=u),t.file){var l={beforeCreateBlob:n("GET_BEFORE_CREATE_BLOB"),afterCreateBlob:n("GET_AFTER_CREATE_BLOB"),stripImageHead:n("GET_OUTPUT_STRIP_IMAGE_HEAD"),canvasMemoryLimit:n("GET_OUTPUT_CANVAS_MEMORY_LIMIT")},s=e.file.data,f=z({},u,{filter:u.colorMatrix,markup:u.markup});Xr(s,f,l).then(function(t){o.file=xi(t,Ai(s.name,Ii(t.type))),r(o)}).catch(i)}else r(o)})},Hi=function(t){t.crop.draft.rotateMinScale=null},ji=function(t){t.crop.draft.rotateMinScale||(t.crop.draft.rotateMinScale=t.crop.transforms.scale)},Zi=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];ji(t);var o=z({},t.crop.transforms,{scale:t.crop.draft.rotateMinScale});t.crop.draft.transforms=ro(t.image,t.crop.rectangle,o,e.main+e.sub,n,t.crop.draft.transforms?t.crop.draft.transforms.rotation:t.crop.rotation.main+t.crop.rotation.sub,r,i),t.crop.rotation=pi(t.crop.draft.transforms.rotation)},Xi=function(t,e,n){if(null!==t.stage){Ji(t),t.size.width=!!t.instructions.size&&t.instructions.size.width,t.size.height=!!t.instructions.size&&t.instructions.size.height,t.size.aspectRatioLocked=!0,t.size.aspectRatioPrevious=!1;var r=void 0===t.instructions.crop.scaleToFit?void 0===t.crop.limitToImageBounds?t.options.cropLimitToImageBounds:t.crop.limitToImageBounds:t.instructions.crop.scaleToFit,i=e("GET_STAGE_RECT",t.instructions.crop);t.crop.rectangle=nn(i.fits?i:t.stage,t.instructions.crop.aspectRatio||t.image.aspectRatio),t.crop.draft.rectangle=null,"stage"!==i.mode&&i.fits&&(t.crop.rectangle.x=i.x,t.crop.rectangle.y=i.y),t.crop.transforms=ti(t.instructions.crop,i,t.image,r),t.crop.draft.transforms=null,t.crop.rotation=pi(t.instructions.crop.rotation),t.crop.flip=z({},t.instructions.crop.flip);var o=e("GET_CROP_ASPECT_RATIO_OPTIONS")||[],a=o.map(function(t){return t.value.aspectRatio}).find(function(e){return e===t.instructions.crop.aspectRatio}),c=o.find(function(t){return null===t.value.aspectRatio});a?t.crop.aspectRatio=a:c&&o.length?t.crop.aspectRatio=null:t.crop.aspectRatio=e("GET_CROP_ASPECT_RATIO"),t.crop.isDirty=!1,t.instructions.markup&&n("MARKUP_SET_VALUE",{value:t.instructions.markup.map(Mi).sort(br)}),n("CROP_SET_LIMIT",{value:r,silent:!0}),L()(t.instructions.color).forEach(function(e){return n("COLOR_SET_VALUE",{key:e,value:t.instructions.color[e]})}),n("FILTER_SET_VALUE",{value:t.instructions.filter}),Hi(t)}},Ki=function(t,e){if(t.stage){Ji(t);var n=t.crop.rectangle,r=n.height/n.width,i=t.crop.aspectRatio;if(null!==i&&Oe(r,3)!==Oe(i,3)){var o=e("GET_MIN_CROP_SIZE");o.width=Oe(o.width),o.height=Oe(o.height);var a=Math.min(n.width,n.height);Math.min(a*i,a/i)<Math.max(o.width,o.height)&&(t.crop.rectangle=fi(z({},t.crop.rectangle),i,o),t.crop.draft.transforms=ai(t.image,t.crop.rectangle,t.crop.transforms))}var c=t.crop.draft.transforms||t.crop.transforms,u=mn(t.image,t.crop.rectangle,c,t.crop.limitToImageBounds);t.crop.aspectRatio&&(u.aspectRatio=t.crop.aspectRatio);var l=e("GET_STAGE_RECT",u);t.crop.transforms=ti(u,l,t.image,u.scaleToFit),t.crop.draft.transforms=null;var s=t.crop.aspectRatio||t.crop.rectangle.height/t.crop.rectangle.width;t.crop.rectangle=nn(l,s),t.crop.draft.rectangle=null,"stage"!==l.mode&&(t.crop.rectangle.x+=l.x,t.crop.rectangle.y+=l.y),Hi(t)}},$i=function(t,e,n){var r=e("GET_CROP_ZOOM_TIMEOUT");r&&(clearTimeout(t.zoomTimeoutId),t.zoomTimeoutId=setTimeout(function(){n("CROP_ZOOM")},r))},Qi=function(t,e,n){Ji(t),$i(t,e,n)},Ji=function(t){clearTimeout(t.zoomTimeoutId)},to=function(t){t.crop.rectangle=t.crop.draft.rectangle.limited,t.crop.draft.rectangle=null,co(t),Hi(t)},eo=function(t){t.crop.draft.transforms=ei(t.crop.transforms),t.crop.draft.rectangle={limited:Xe(t.crop.rectangle),free:Xe(t.crop.rectangle)},Ji(t)},no=function(t,e){return Math.min(t.width/e.width,t.height/e.height)},ro=function(t,e,n,r,i,o,a,c){var u=z({},ei(n),{rotation:r}),l=c?ni(t,e,u,"rotating"):u,s=no(e,i);return Oe(l.scale,5)>Oe(s,5)?(a&&(o+=2*a),z({},ei(n),{rotation:o,interaction:{rotation:l.rotation}})):(l.scale=Math.min(s,l.scale),l.interaction={rotation:l.rotation},l)},io=function(t,e,n,r,i,o){var a=Math.max(1e-10,r),c=z({},ei(n),{scale:a}),u=o?ni(t,e,c,"resizing"):c,l=no(e,i);return u.scale=Math.min(l,u.scale),u.interaction={scale:a},u},oo=function(t,e,n,r,i){var o={x:n.translation.x+r.x,y:n.translation.y+r.y},a=z({},ei(n),{translation:o}),c=i?ni(t,e,a,"moving"):a;return c.interaction={translation:o},c},ao=function(t,e){var n=Oe(t.crop.draft.transforms.scale,5);if(!(Oe(t.crop.draft.targetSize,5)<n))return!1;if(null!==t.crop.aspectRatio)return!1;if(!1===t.crop.limitToImageBounds)return!1;if(0!==Oe(t.crop.rotation.sub,5))return!1;var r=Oe(t.crop.rotation.main/Fi,5)%2!=0?t.image.width/t.image.height:t.image.height/t.image.width;if(r===t.crop.rectangle.height/t.crop.rectangle.width)return!1;var i=t.stage.x+.5*t.stage.width,o=t.stage.y+.5*t.stage.height,a=t.crop.rectangle.x+.5*t.crop.rectangle.width,c=t.crop.rectangle.y+.5*t.crop.rectangle.height;if(a!==i||c!==o)return!1;var u=e("GET_STAGE_RECT");return t.crop.rectangle=nn(u,r),"stage"!==u.mode&&(t.crop.rectangle.x+=u.x,t.crop.rectangle.y+=u.y),t.crop.transforms=ti({center:{x:.5,y:.5},rotation:t.crop.transforms.rotation,zoom:1,aspectRatio:r},u,t.image,!0),t.crop.draft.transforms=null,!0},co=function(t){t.crop.draft.rectangle=null,t.crop.transforms=t.crop.draft.transforms||t.crop.transforms,t.crop.transforms.interaction=null,t.crop.draft.transforms=null,t.crop.transforms=z({},t.crop.transforms,ri(t.image,t.crop.rectangle,t.crop.transforms)),t.crop.isRotating=!1,t.crop.isDirty=!0},uo=function(t,e){return t.getAllResponseHeaders().indexOf(e)>=0?t.getResponseHeader(e):null},lo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.progress,r=void 0===n?function(t){}:n,i=e.load,o=void 0===i?function(t,e){}:i,a=e.error,c=void 0===a?function(){}:a,u=new XMLHttpRequest;u.onprogress=function(t){return r(t.lengthComputable?t.loaded/t.total:null)},u.onerror=function(){return c(u)},u.onload=function(){var t=u.response;if(!t)return c(u);var e=u.getResponseHeader("Content-Type"),n=uo(u,"Content-Disposition"),r=n?Pi(n):null,i=uo(u,"Content-Doka"),a=null;if(i)try{a=JSON.parse(i)}catch(t){}!t.type.length&&e&&(W("blob"),t=t.slice(0,t.size,e)),r&&(t.name=r),o(t,a)},u.open("GET",t),u.responseType="blob",u.send()},so=function(t,e){var n=e.progress;return new f.a(function(e,r){if(Kt(t))lo(t,{progress:/^data:/.test(t)?function(){}:n,error:r,load:function(t,n){return e({file:t,fileInstructions:n})}});else if(t instanceof Blob)e({file:t});else{if("IMG"===t.nodeName){var i=function(t){var n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d").drawImage(t,0,0),n.toBlob(function(t){return e({file:t})})};return t.complete?void i(t):void(t.onload=function(){return i(t)})}"CANVAS"!==t.nodeName?r(t):t.toBlob(function(t){return e({file:t})})}})},fo=function(t){return!1===t.file},ho=function(t,e,n){return z({SET_UID:function(t){var e=t.id;n.uid=e},AWAIT_IMAGE:function(){n.file||(n.noImageTimeout=setTimeout(function(){t("AWAITING_IMAGE")},250))},REQUEST_REMOVE_IMAGE:function(){t("UNLOAD_IMAGE"),n.file=!1,n.noImageTimeout=setTimeout(function(){t("AWAITING_IMAGE")},500)},DID_UNLOAD_IMAGE:function(){t("ABORT_IMAGE")},REQUEST_ABORT_IMAGE:function(e){t("UNLOAD_IMAGE"),n.file=!1,n.queuedFile=e},DID_SET_SRC:function(e){e.value!==e.prevValue&&(clearTimeout(n.noImageTimeout),t("REQUEST_LOAD_IMAGE",{source:e.value}))},ABORT_IMAGE:function(){if(n.file=null,n.queuedFile){var e=n.queuedFile;n.queuedFile=null,t("REQUEST_LOAD_IMAGE",e)}},REQUEST_LOAD_IMAGE:function(e){var r=e.source,i=e.success,o=void 0===i?function(){}:i,a=e.failure,c=void 0===a?function(t){}:a,u=e.options,l=e.resolveOnConfirm,s=void 0!==l&&l;if(clearTimeout(n.noImageTimeout),!r)return c("no-image-source");null===n.file?(de(n),n.file={uid:ye()},t("DID_REQUEST_LOAD_IMAGE",{source:r}),so(r,{progress:function(e){return null!==e&&t("DID_MAKE_PROGRESS",{progress:e})}}).then(function(e){var r=e.file,i=e.fileInstructions;if(!u&&i){var a=i.crop,l=i.filter,f=i.colorMatrix,d=i.color,h=i.markup,p=i.size;u={crop:a,filter:l?l.id||l.matrix:f,color:d,markup:h,size:p}}if(fo(n))return t("ABORT_IMAGE");r.name||(r.name=yi()),n.file.orientation=-1,n.file.data=r,t("LOAD_IMAGE",{success:o,failure:c,options:u,resolveOnConfirm:s},!0),t("KICK")}).catch(function(e){if(fo(n))return t("ABORT_IMAGE");t("DID_LOAD_IMAGE_ERROR",{error:{status:"IMAGE_LOAD_ERROR",data:e}}),c(e)})):t("REQUEST_ABORT_IMAGE",{source:r,success:o,failure:c,options:u,resolveOnConfirm:s})},LOAD_IMAGE:function(r){var i=r.success,o=r.failure,a=r.options,c=void 0===a?{}:a,u=r.resolveOnConfirm;if(fo(n))return t("ABORT_IMAGE");var l=n.file.data;f.a.all([vi(l),Qr(l)]).then(function(r){var a=q(r,2),l=a[0],s=a[1];if(fo(n))return t("ABORT_IMAGE");if(n.file.orientation=e("GET_OUTPUT_CORRECT_IMAGE_EXIF_ORIENTATION")?s:-1,n.file.orientation>-1){var f=l.width,d=l.height;s>=5&&s<=8&&(l.width=d,l.height=f)}var h=e("GET_MIN_IMAGE_SIZE");if(l.width<h.width||l.height<h.height)return t("DID_LOAD_IMAGE_ERROR",{error:{status:"IMAGE_MIN_SIZE_VALIDATION_ERROR",data:{size:l,minImageSize:h}}}),de(n),void o();var p=gi(l,{width:e("GET_MAX_IMAGE_PREVIEW_WIDTH"),height:e("GET_MAX_IMAGE_PREVIEW_HEIGHT")});if(n.image={x:0,y:0,width:p.width,height:p.height,naturalWidth:l.width,naturalHeight:l.height,aspectRatio:l.height/l.width},e("ALLOW_MANUAL_RESIZE")&&c.size&&(n.size.width=c.size.width,n.size.height=c.size.height,n.size.aspectRatioLocked=!0,n.size.aspectRatioPrevious=!1,n.instructions.size={width:c.size.width,height:c.size.height}),n.instructions.crop=Ei(e,n,c.crop?z({},c.crop):null,n.size),n.crop.limitToImageBounds=n.options.cropLimitToImageBounds,!1===n.instructions.crop.scaleToFit&&(n.crop.limitToImageBounds=n.instructions.crop.scaleToFit),void 0===c.filter)n.instructions.filter=n.options.filter;else{var v=c.filter;n.instructions.filter=null===v?v:v.id||v.matrix||v}var g=n.options.markup||[];n.instructions.markup=g.concat(c.markup||[]),n.instructions.color=L()(Ni).reduce(function(t,e){return t[e]=c.color&&void 0!==c.color[e]?"number"==typeof c.color[e]?c.color[e]:c.color[e].value:n.options["color".concat(_i(e))],t},{}),t("DID_LOAD_IMAGE",{image:z({size:n.file.data.size,name:n.file.data.name,type:n.file.data.type,orientation:s},l)}),n.filePromise={resolveOnConfirm:u,success:i,failure:o}}).catch(function(e){if(fo(n))return t("ABORT_IMAGE");t("DID_LOAD_IMAGE_ERROR",{error:{status:"IMAGE_UNKNOWN_ERROR",data:e}}),de(n),o()})},CHANGE_VIEW:function(e){var r=e.id;n.activeView=r,t("SHOW_VIEW",{id:r})},UPDATE_ROOT_RECT:function(t){var e=t.rect;n.rootRect=e},DID_RESIZE_STAGE:function(r){var i=r.size,o=r.offset,a=r.animate,c=null===n.stage;if(n.stage=tn(0,0,i.width,i.height),n.stageOffset=Be(o.x,o.y),!e("GET_ALLOW_PREVIEW_FIT_TO_VIEW")){var u=e("GET_IMAGE_STAGE_RECT");n.stage=tn(0,0,u.width,u.height),n.stageOffset=Be(n.stageOffset.x+u.x,n.stageOffset.y+u.y)}if(c){if(Xi(n,e,t),!n.filePromise.resolveOnConfirm){var l=yn(n.image,n.crop),s=zi(e);n.filePromise.success({crop:l,image:{orientation:n.file.orientation},size:s,output:{type:e("GET_OUTPUT_TYPE"),quality:e("GET_OUTPUT_QUALITY")}})}}else n.instantUpdate=!a,Ki(n,e),setTimeout(function(){n.instantUpdate=!1},16)},RESIZE_SET_OUTPUT_SIZE_ASPECT_RATIO_LOCK:function(t){var e=t.value;n.size.aspectRatioLocked=e},RESIZE_SET_OUTPUT_SIZE:function(r){var i=r.width,o=r.height,a=_n({width:i=i||null,height:o=o||null},e("GET_SIZE_MIN"),e("GET_SIZE_MAX"),e("GET_CROP_RECTANGLE_ASPECT_RATIO"));if(n.size.width=a.width?Math.round(a.width):null,n.size.height=a.height?Math.round(a.height):null,i&&o){var c=o/i;if(c===n.crop.aspectRatio)return;!1===n.size.aspectRatioPrevious&&(n.size.aspectRatioPrevious=n.crop.aspectRatio),t("CROP_SET_ASPECT_RATIO",{value:c})}else!1!==n.size.aspectRatioPrevious&&(t("CROP_SET_ASPECT_RATIO",{value:n.size.aspectRatioPrevious}),n.size.aspectRatioPrevious=!1)},CROP_SET_ASPECT_RATIO:function(t){var r=t.value;if(Ji(n),n.crop.aspectRatio=Kt(r)?en(r):r,n.crop.aspectRatio&&Ki(n,e),n.crop.isDirty=!0,n.size.width&&n.size.height)if(n.crop.aspectRatio){var i=n.size.width*n.crop.aspectRatio,o=Se(i,e("GET_SIZE_MIN").height,e("GET_SIZE_MAX").height);n.size.height=o,n.size.width=o/n.crop.aspectRatio}else n.size.height=null},DID_SET_CROP_ASPECT_RATIO:function(e){var n=e.value,r=e.prevValue;en(n)!==en(r)&&t("CROP_SET_ASPECT_RATIO",{value:n})},CROP_ZOOM:function(){n.stage&&(Ji(n),Ki(n,e))},DID_SET_CROP_LIMIT_TO_IMAGE_BOUNDS:function(e){var r=e.value,i=e.prevValue;n.crop.limitToImageBounds=r,!1===i&&r&&t("CROP_ENABLED_LIMIT_TO_IMAGE_BOUNDS")},CROP_ENABLED_LIMIT_TO_IMAGE_BOUNDS:function(){var t=n.stage,r=n.image,i=n.crop.rectangle.height/n.crop.rectangle.width,o=nn(t,i);n.crop.rectangle=o,n.crop.transforms=ni(r,n.crop.rectangle,n.crop.transforms,"moving"),n.crop.transforms=ni(r,n.crop.rectangle,n.crop.transforms,"resizing"),n.crop.transforms=ni(r,n.crop.rectangle,n.crop.transforms,"rotating"),n.crop.draft.rectangle=null,n.crop.draft.transforms=null,Ki(n,e)},CROP_SET_LIMIT:function(e){var r=e.value,i=e.silent,o=void 0!==i&&i,a=n.crop.limitToImageBounds!==r;n.crop.limitToImageBounds=r,a&&!o&&(n.crop.isDirty=!0),a&&r&&t("CROP_ENABLED_LIMIT_TO_IMAGE_BOUNDS")},CROP_IMAGE_RESIZE_GRAB:function(){eo(n),Ji(n)},CROP_IMAGE_ROTATE_GRAB:function(){eo(n),Ji(n),n.crop.isRotating=!0},CROP_RECT_DRAG_GRAB:function(){eo(n),Ji(n)},CROP_RECT_DRAG_RELEASE:function(){to(n),$i(n,e,t)},CROP_RECT_EDGE_DRAG:function(t){var r=t.offset,i=t.origin,o=t.anchor,a=n.image,c=n.stage,u=/n|s/.test(i)?Jr.VERTICAL:Jr.HORIZONTAL,l=oi(i,n.crop.rectangle),s=oi(o,n.crop.rectangle),f=Ne({x:l.x+(u===Jr.HORIZONTAL?r.x:0),y:l.y+(u===Jr.VERTICAL?r.y:0)},c),d=e("GET_MIN_CROP_SIZE"),h=e("GET_MAX_CROP_SIZE");d.width=Oe(d.width),d.height=Oe(d.height);var p=no(n.crop.rectangle,e("GET_MIN_PREVIEW_IMAGE_SIZE"))/(n.crop.draft.transforms.scale||n.crop.transforms.scale);h.width=Oe(h.width*p),h.height=Oe(h.height*p);var v={x:Math.sign(l.x-s.x),y:Math.sign(l.y-s.y)};n.crop.draft.rectangle=ci(v,f,u,s,Ke(n.crop.rectangle),Ke(c),n.crop.aspectRatio,d,h),n.crop.limitToImageBounds&&(n.crop.draft.transforms=ai(a,n.crop.draft.rectangle.limited,n.crop.transforms))},CROP_RECT_CORNER_DRAG:function(t){var r=t.offset,i=t.origin,o=t.anchor,a=n.image,c=n.stage,u=li(i,n.crop.rectangle),l=li(o,n.crop.rectangle),s={x:u.x+r.x,y:u.y+r.y},f=e("GET_MIN_CROP_SIZE"),d=e("GET_MAX_CROP_SIZE");f.width=Oe(f.width),f.height=Oe(f.height);var h=no(n.crop.rectangle,e("GET_MIN_PREVIEW_IMAGE_SIZE"))/(n.crop.draft.transforms.scale||n.crop.transforms.scale);d.width=Oe(d.width*h),d.height=Oe(d.height*h);var p={x:Math.sign(u.x-l.x),y:Math.sign(u.y-l.y)};n.crop.draft.rectangle=si(p,s,l,c,n.crop.aspectRatio,f,d),n.crop.limitToImageBounds&&(n.crop.draft.transforms=ai(a,n.crop.draft.rectangle.limited,n.crop.transforms))},CROP_IMAGE_DRAG_GRAB:function(){return eo(n)||Ji(n)},CROP_IMAGE_DRAG_RELEASE:function(){co(n),Hi(n),$i(n,e,t)},CROP_IMAGE_ROTATE_RELEASE:function(){co(n),$i(n,e,t)},CROP_IMAGE_DRAG:function(t){var e=t.value;Ji(n),n.crop.draft.transforms=oo(n.image,n.crop.rectangle,n.crop.transforms,e,n.crop.limitToImageBounds)},CROP_IMAGE_RESIZE_RELEASE:function(){e("GET_CROP_RESIZE_MATCH_IMAGE_ASPECT_RATIO")&&ao(n,e),co(n),Hi(n),$i(n,e,t)},CROP_IMAGE_RESIZE:function(t){var r=t.value;Ji(n);var i=n.crop.transforms;n.crop.draft.targetSize=i.scale+i.scale*r,n.crop.draft.transforms=io(n.image,n.crop.rectangle,i,n.crop.draft.targetSize,e("GET_MIN_PREVIEW_IMAGE_SIZE"),n.crop.limitToImageBounds)},CROP_IMAGE_RESIZE_MULTIPLY:function(t){var r=t.value;Ji(n);var i=n.crop.transforms;n.crop.draft.targetSize=i.scale*r,n.crop.draft.transforms=io(n.image,n.crop.rectangle,i,n.crop.draft.targetSize,e("GET_MIN_PREVIEW_IMAGE_SIZE"),n.crop.limitToImageBounds)},CROP_IMAGE_RESIZE_AMOUNT:function(t){var r=t.value;Ji(n);var i=n.crop.transforms;n.crop.draft.targetSize=(n.crop.draft.transforms?n.crop.draft.transforms.scale:i.scale)+r,n.crop.draft.transforms=io(n.image,n.crop.rectangle,i,n.crop.draft.targetSize,e("GET_MIN_PREVIEW_IMAGE_SIZE"),n.crop.limitToImageBounds)},CROP_IMAGE_ROTATE:function(t){var r=t.value;Ji(n),n.crop.isRotating=!0,Zi(n,{main:n.crop.rotation.main,sub:r},e("GET_MIN_PREVIEW_IMAGE_SIZE"),!1,n.crop.limitToImageBounds)},CROP_IMAGE_ROTATE_ADJUST:function(t){var r=t.value;Ji(n),Zi(n,{main:n.crop.rotation.main,sub:Math.min(Math.PI/4,Math.max(-Math.PI/4,n.crop.rotation.sub+r))},e("GET_MIN_PREVIEW_IMAGE_SIZE"),!1,n.crop.limitToImageBounds),co(n)},CROP_IMAGE_ROTATE_CENTER:function(){Ji(n),Zi(n,{main:n.crop.rotation.main,sub:0},e("GET_MIN_PREVIEW_IMAGE_SIZE"),!1,n.crop.limitToImageBounds),co(n)},CROP_IMAGE_ROTATE_LEFT:function(){Qi(n,e,t),Zi(n,{main:n.crop.rotation.main-Fi,sub:n.crop.rotation.sub},e("GET_MIN_PREVIEW_IMAGE_SIZE"),-Fi,n.crop.limitToImageBounds),co(n),e("GET_CROP_FORCE_LETTERBOX")&&t("CROP_UPDATE_LETTERBOX")},CROP_IMAGE_ROTATE_RIGHT:function(){Qi(n,e,t),Zi(n,{main:n.crop.rotation.main+Fi,sub:n.crop.rotation.sub},e("GET_MIN_PREVIEW_IMAGE_SIZE"),Fi,n.crop.limitToImageBounds),co(n),e("GET_CROP_FORCE_LETTERBOX")&&t("CROP_UPDATE_LETTERBOX")},CROP_IMAGE_FLIP_HORIZONTAL:function(){Qi(n,e,t),0===Oe(n.crop.rotation.main%Math.PI/2,5)?n.crop.flip.horizontal=!n.crop.flip.horizontal:n.crop.flip.vertical=!n.crop.flip.vertical,n.crop.isDirty=!0},CROP_IMAGE_FLIP_VERTICAL:function(){Qi(n,e,t),0===Oe(n.crop.rotation.main%Math.PI/2,5)?n.crop.flip.vertical=!n.crop.flip.vertical:n.crop.flip.horizontal=!n.crop.flip.horizontal,n.crop.isDirty=!0},DID_RECEIVE_IMAGE_DATA:function(t){var e=t.previewData,r=t.thumbData;n.file.preview=e,n.file.thumb=r},MARKUP_SET_VALUE:function(t){var e=t.value;n.markup=e},MARKUP_ADD_DEFAULT:function(n){var r=n.value,i=function(){return-.5+Math.random()},o=.25*e("GET_CROP_RECTANGLE_ASPECT_RATIO"),a=function(){return{width:.25,height:o,x:.5+.5*i()-.125,y:.5+.5*i()-.5*o}},c=function(t){return e("GET_MARKUP_TOOL_VALUES")[t]},u=function(){var t=c("shapeStyle"),e=c("color");return{backgroundColor:t[0]||t[1]?null:e,borderWidth:t[0],borderStyle:t[1]?t[1]:null,borderColor:e}},l={rect:function(){return z({},a(),u())},ellipse:function(){return z({},a(),u())},text:function(){return{x:.5+.5*i()-.1,y:.5+.5*i(),width:0,height:0,fontColor:c("color"),fontSize:c("fontSize"),fontFamily:c("fontFamily"),text:"Text"}},line:function(){var t=c("lineStyle");return z({},a(),{lineColor:c("color"),lineWidth:t[0],lineStyle:t[1]?t[1]:null,lineDecoration:c("lineDecoration")})}}[r]();t("MARKUP_ADD",[r,l])},MARKUP_ADD:function(r){n.markup.forEach(function(t){return t[1].isSelected=!1}),n.markup=n.markup.filter(function(t){return!t[1].isDestroyed});var i=Mi(r);n.markup.push(i),n.markup.sort(br),"draw"!==e("GET_MARKUP_UTIL")&&t("MARKUP_SELECT",{id:i[1].id}),n.crop.isDirty=!0},MARKUP_SELECT:function(t){var e=t.id;n.markup.forEach(function(t){t[1].isSelected=t[1].id===e,t[1].isDirty=!0})},MARKUP_ELEMENT_DRAG:function(t){var e=t.id,r=t.origin,i=t.offset,o=t.size,a=n.markup.find(function(t){return t[1].id===e});if(a){var c=a[1],u=r.x/o.width,l=r.y/o.height,s=r.width/o.width,f=r.height/o.height,d=i.x/o.width,h=i.y/o.height;c.x=u+d,c.y=l+h,c.width=s,c.height=f,c.left=void 0,c.top=void 0,c.right=void 0,c.bottom=void 0,c.isDirty=!0,n.crop.isDirty=!0}},MARKUP_ELEMENT_RESIZE:function(t){var e=t.id,r=t.corner,i=t.origin,o=t.offset,a=t.size,c=n.markup.find(function(t){return t[1].id===e});if(c){var u=q(c,2),l=u[0],s=u[1],f=(i.x+o.x)/a.width,d=(i.y+o.y)/a.height;if(/n/.test(r))if("line"===l)s.height=s.height-(d-s.y),s.y=d;else{var h=s.y+s.height;d>h&&(d=h),s.height=s.height-(d-s.y),s.y=d}if(/w/.test(r))if("line"===l)s.width=s.width-(f-s.x),s.x=f;else{var p=s.x+s.width;f>p&&(f=p),s.width=s.width-(f-s.x),s.x=f}/s/.test(r)&&(s.height="line"===l?d-s.y:Math.max(0,d-s.y)),/e/.test(r)&&(s.width="line"===l?f-s.x:Math.max(0,f-s.x)),s.left=void 0,s.top=void 0,s.right=void 0,s.bottom=void 0,s.isDirty=!0,n.crop.isDirty=!0}},MARKUP_DELETE:function(e){var r=e.id,i=n.markup.find(function(t){return t[1].id===r});if(i){var o=i[1];o.allowDestroy&&(o.isDestroyed=!0,o.isSelected=!1,o.isDirty=!0);for(var a=null,c=n.markup.length;c>0;){c--;var u=n.markup[c][1];if(!u.isDestroyed&&u.allowDestroy){a=u.id;break}}t("MARKUP_SELECT",{id:a})}},MARKUP_UPDATE:function(t){var e=t.style,r=t.value;n.markupToolValues[e]=r,n.markup.map(function(t){return t[1]}).filter(function(t){return t.isSelected}).forEach(function(t){if("color"===e)t[Vi(t)]=r;else if("shapeStyle"===e){var n=Bi(t);t.borderWidth=r[0],t.borderStyle=r[1],t.backgroundColor=r[0]||r[1]?null:n}else"lineStyle"===e?(t.lineWidth=r[0],t.lineStyle=r[1]):t[e]=r;t.isDirty=!0}),n.crop.isDirty=!0}},["color","shapeStyle","lineStyle","textDecoration","fontSize","fontFamily"].reduce(function(e,r){var i=r.split(/(?=[A-Z])/).join("_").toUpperCase(),o=_i(r);return e["SET_MARKUP_"+i]=function(e){var i=e.value;i!==e.prevValue&&(n.options["markup".concat(o)]=i,t("MARKUP_UPDATE",{style:r,value:i}))},e},{}),{COLOR_SET_COLOR_VALUE:function(e){var r=e.key,i=e.value;n.crop.isDirty=!0,t("COLOR_SET_VALUE",{key:r,value:i})},COLOR_SET_VALUE:function(e){var r=e.key,i=e.value;n.colorValues[r]=i,t("SET_COLOR_MATRIX",{key:r,matrix:Ni[r](i)})}},L()(Ni).reduce(function(r,i){var o=i.toUpperCase(),a=_i(i);return r["SET_COLOR_".concat(o)]=function(r){var c=r.value;if(c!==r.prevValue){var u=q(e("GET_COLOR_".concat(o,"_RANGE")),2),l=u[0],s=u[1],f=Se(c,l,s);n.options["color".concat(a)]=f,n.instructions.color||(n.instructions.color={}),n.instructions.color[i]=f,t("COLOR_SET_VALUE",{key:i,value:f})}},r},{}),{SET_COLOR_MATRIX:function(e){var r=e.key,i=e.matrix;i?n.colorMatrices[r]=Y(i):delete n.colorMatrices[r],t("DID_SET_COLOR_MATRIX",{key:r,matrix:i})},FILTER_SET_FILTER:function(e){var r=e.value;n.crop.isDirty=!0,t("FILTER_SET_VALUE",{value:r})},FILTER_SET_VALUE:function(r){var i=r.value,o=Ci(i)?i:null;if(Kt(i)){var a=e("GET_FILTERS");it(a,function(t,e){t===i&&(o=e.matrix())})}n.filter=i,n.filterName=Kt(i)?i:null,t("SET_COLOR_MATRIX",{key:"filter",matrix:o})},DID_SET_UTIL:function(e){var r=e.value;e.prevValue,-1!==n.options.utils.indexOf(r)&&t("CHANGE_VIEW",{id:r})},DID_SET_FILTER:function(e){var n=e.value;n!==e.prevValue&&(t("FILTER_SET_VALUE",{value:n}),t("SET_DATA",{filter:n}))},DID_SET_SIZE:function(e){var n=e.value;n!==e.prevValue&&t("SET_DATA",{size:n})},DID_SET_CROP:function(e){var n=e.value;n!==e.prevValue&&t("SET_DATA",{crop:n})},DID_SET_MARKUP_UTIL:function(e){var n=e.value;n!==e.prevValue&&n&&(/^(draw|line|text|rect|ellipse)$/.test(n)||(n="select"),t("SWITCH_MARKUP_UTIL",{util:n}))},DID_SET_MARKUP:function(e){var n=e.value,r=e.prevValue;n!==r&&c()(n)===c()(r)||t("SET_DATA",{markup:n})},SET_DATA:function(r){if(r.size&&e("ALLOW_MANUAL_RESIZE")){var i=z({width:null,height:null},r.size),o=_n(i,e("GET_SIZE_MIN"),e("GET_SIZE_MAX"),null);n.instructions.size=z({},o),t("RESIZE_SET_OUTPUT_SIZE",o)}r.filter&&(n.instructions.filter=r.filter?r.filter.id||r.filter.matrix:r.colorMatrix),n.instructions.markup=r.markup||[],n.instructions.color=L()(Ni).reduce(function(t,e){var i=void 0===r.color||void 0===r.color[e],o=n.options["color".concat(_i(e))];return t[e]=i?o:mt(r.color[e])?r.color[e]:r.color[e].value,t},{}),r.crop&&(n.instructions.crop=Ei(e,n,r.crop,n.size),n.crop.limitToImageBounds=n.options.cropLimitToImageBounds,!1===n.instructions.crop.scaleToFit&&(n.crop.limitToImageBounds=n.instructions.crop.scaleToFit),t("EDIT_RESET"))},DID_SET_INITIAL_STATE:function(t){var r=t.value||{},i=r.crop,o=r.filter,a=r.color,c=r.size,u=void 0===c?{}:c,l=r.markup,s=void 0===l?[]:l,f=z({width:null,height:null},u),d=_n(f,e("GET_SIZE_MIN"),e("GET_SIZE_MAX"),null);n.instructions.size=z({},d),n.instructions.crop=Ei(e,n,i),n.crop.limitToImageBounds=n.options.cropLimitToImageBounds,!1===n.instructions.crop.scaleToFit&&(n.crop.limitToImageBounds=n.instructions.crop.scaleToFit),n.instructions.filter=o||null,n.instructions.color=L()(Ni).reduce(function(t,e){return t[e]=void 0===a||void 0===a[e]?n.options["color".concat(_i(e))]:a[e],t},{}),n.instructions.markup=s,n.crop.isDirty=!0},GET_DATA:function(r){var i=r.success,o=r.failure,a=r.file,c=r.data;if(!n.file)return o("no-image-source");if(!n.stage)return o("image-not-fully-loaded");var u={file:Zt(a)?a:e("GET_OUTPUT_FILE"),data:Zt(c)?c:e("GET_OUTPUT_DATA"),success:i,failure:o};t(u.file?"REQUEST_PREPARE_OUTPUT":"PREPARE_OUTPUT",u)},REQUEST_PREPARE_OUTPUT:function(e){var n=e.file,r=e.data,i=e.success,o=e.failure;t("PREPARE_OUTPUT",{file:n,data:r,success:i,failure:o},!0),t("DID_REQUEST_PREPARE_OUTPUT")},PREPARE_OUTPUT:function(r){var i=r.file,o=r.data,a=r.success,c=void 0===a?function(){}:a,u=r.failure,l=void 0===u?function(){}:u;if(fo(n))return t("ABORT_IMAGE");var s=function(e){if(t("DID_PREPARE_OUTPUT"),fo(n))return t("ABORT_IMAGE");c(e)};Yi({file:i,data:o},n,e).then(function(e){var r=n.options.afterCreateOutput,i=r?r(e,function(e,n){return t("DID_REQUEST_POSTPROCESS_OUTPUT",{label:e,progress:n}),function(e){t("DID_MAKE_PROGRESS",{progress:e})}}):e;f.a.resolve(i).then(s).catch(function(e){t("DID_REQUEST_POSTPROCESS_OUTPUT_ERROR",{error:e})})}).catch(function(e){if(fo(n))return t("ABORT_IMAGE");l(e)})},EDIT_RESET:function(){Ji(n),Xi(n,e,t)},EDIT_CONFIRM:function(){if(n.file&&n.stage){Ji(n),t("CROP_ZOOM");var r={file:e("GET_OUTPUT_FILE"),data:e("GET_OUTPUT_DATA"),success:function(e){n.filePromise.resolveOnConfirm&&n.filePromise.success(e),t("DID_CONFIRM",{output:e})},failure:console.error};t(r.file?"REQUEST_PREPARE_OUTPUT":"PREPARE_OUTPUT",r)}},EDIT_CANCEL:function(){n.filePromise&&n.filePromise.success(null),t("DID_CANCEL")},EDIT_CLOSE:function(){Ji(n)},EDIT_DESTROY:function(){de(n)},SET_OPTIONS:function(e){var n=e.options;it(n,function(e,n){t("SET_".concat(pe(e,"_").toUpperCase()),{value:n})})}})},po=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return'<svg width="'.concat(e,'" height="').concat(e,'" viewBox="0 0 ').concat(e," ").concat(e,'" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">').concat(t,"</svg>")},vo=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"button",mixins:{styles:["opacity"],animations:{opacity:{type:"tween",duration:250}},apis:["id"],listeners:!0},tag:"button",create:function(t){var e=t.root,n=t.props;e.element.innerHTML="".concat(n.icon||"","<span>").concat(n.label,"</span>"),e.element.setAttribute("type",n.type||"button"),n.name&&n.name.split(" ").forEach(function(t){e.element.className+=" doka--button-".concat(t)}),e.ref.handleClick=function(){"string"==typeof n.action?e.dispatch(n.action):n.action()},e.element.addEventListener("click",e.ref.handleClick),e.ref.handlePointer=function(t){return t.stopPropagation()},e.element.addEventListener("pointerdown",e.ref.handlePointer),n.create&&n.create({root:e,props:n})},destroy:function(t){var e=t.root;e.element.removeEventListener("pointerdown",e.ref.handlePointer),e.element.removeEventListener("click",e.ref.handleClick)}}),go=function(t){return Bt({ignoreRect:!0,tag:t,create:function(t){var e=t.root,n=t.props;e.element.textContent=n.text}})},mo=Bt({name:"status-progress",tag:"svg",ignoreRect:!0,ignoreRectUpdate:!0,mixins:{apis:["progress"],animations:{progress:{type:"spring",stiffness:.25,damping:.25,mass:2.5}}},create:function(t){var e=t.root,n=t.props;e.element.setAttribute("data-value",0),e.element.setAttribute("width",24),e.element.setAttribute("height",24),e.element.setAttribute("viewBox","0 0 20 20");var r=e.ref.circle=document.createElementNS("http://www.w3.org/2000/svg","circle"),i={r:5,cx:10,cy:10,fill:"none",stroke:"currentColor","stroke-width":10,transform:"rotate(-90) translate(-20)"};e.element.appendChild(r),L()(i).forEach(function(t){r.setAttribute(t,i[t])}),e.ref.updateStroke=function(t){e.ref.circle.setAttribute("stroke-dasharray","".concat(31.42*Math.min(1,t)," 31.42"))},"number"==typeof n.progress?(e.progress=n.progress,e.element.setAttribute("data-value",Math.max(n.progress,.001)),e.ref.updateStroke(e.progress)):e.progress=0},write:zt({DID_MAKE_PROGRESS:function(t){var e=t.root,n=t.action;e.progress=n.progress,e.element.setAttribute("data-value",Math.max(n.progress,.001))}},function(t){var e=t.root;e.ref.updateStroke(e.progress)})}),yo=Bt({name:"status-bubble-inner",create:function(t){var e=t.root,n=t.props;n.onClose?e.appendChildView(e.createChildView(vo,{label:"Close",name:"icon-only status-bubble-close",icon:po('<g fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18M6 6l12 12"/></g>'),action:n.onClose})):e.ref.progressIndicator=e.appendChildView(e.createChildView(mo,{progress:n.progress})),e.appendChildView(e.createChildView(go("p"),{text:n.label}))}}),Eo=Bt({name:"status-bubble",mixins:{styles:["opacity","translateY"],apis:["markedForRemoval"],animations:{opacity:{type:"tween",duration:500},translateY:{type:"spring",mass:20}}},create:function(t){var e=t.root,n=t.props;return e.appendChildView(e.createChildView(yo,n))}}),_o=function(t){t.element.dataset.viewStatus="idle",wo(t)},wo=function(t){t.ref.busyIndicators.forEach(function(t){t.translateY=-10,t.opacity=0,t.markedForRemoval=!0})},To=function(t,e,n,r){t.element.dataset.viewStatus="busy";var i=xo(t,e,n,r);wo(t),t.ref.busyIndicators.push(i),i.markedForRemoval=!1,i.translateY=0,i.opacity=1},xo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return t.appendChildView(t.createChildView(Eo,{translateY:20,opacity:0,label:e,onClose:n,progress:r}))},Ro=Bt({name:"edit-status",ignoreRect:!0,create:function(t){var e=t.root;e.ref.busyIndicators=[],e.element.setAttribute("tabindex",-1)},write:zt({MISSING_WEBGL:function(t){var e=t.root,n=/fullscreen/.test(e.query("GET_STYLE_LAYOUT_MODE"));To(e,e.query("GET_LABEL_STATUS_MISSING_WEB_G_L"),n?function(){e.dispatch("EDIT_CANCEL")}:null)},AWAITING_IMAGE:function(t){var e=t.root;To(e,e.query("GET_LABEL_STATUS_AWAITING_IMAGE"))},DID_PRESENT_IMAGE:function(t){var e=t.root;_o(e)},DID_LOAD_IMAGE_ERROR:function(t){var e=t.root,n=t.action,r=/fullscreen/.test(e.query("GET_STYLE_LAYOUT_MODE")),i=e.query("GET_LABEL_STATUS_LOAD_IMAGE_ERROR"),o="function"==typeof i?i(n.error):i;To(e,o,r?function(){e.dispatch("EDIT_CANCEL")}:null)},DID_REQUEST_LOAD_IMAGE:function(t){var e=t.root;To(e,e.query("GET_LABEL_STATUS_LOADING_IMAGE"))},DID_REQUEST_PREPARE_OUTPUT:function(t){var e=t.root;To(e,e.query("GET_LABEL_STATUS_PROCESSING_IMAGE"))},DID_REQUEST_POSTPROCESS_OUTPUT:function(t){var e=t.root,n=t.action;To(e,n.label,null,n.progress)},DID_REQUEST_POSTPROCESS_OUTPUT_ERROR:function(t){var e=t.root,n=t.action,r=/fullscreen/.test(e.query("GET_STYLE_LAYOUT_MODE")),i=n.error;To(e,i,r?function(){e.dispatch("DID_PREPARE_OUTPUT")}:null)},DID_PREPARE_OUTPUT:function(t){var e=t.root;_o(e)}}),didWriteView:function(t){var e=t.root;e.ref.busyIndicators=e.ref.busyIndicators.filter(function(t){return!t.markedForRemoval||0!==t.opacity||(e.removeChildView(t),!1)})}}),bo={down:"pointerdown",move:"pointermove",up:"pointerup"},Ao=function(){var t=[],e=function(e){return t.findIndex(function(t){return t.pointerId===e.pointerId})};return{update:function(n){var r=e(n);r<0||(t[r]=n)},multiple:function(){return t.length>1},count:function(){return t.length},active:function(){return t.concat()},push:function(n){(function(t){return e(t)>=0})(n)||t.push(n)},pop:function(n){var r=e(n);r<0||t.splice(r,1)}}},Io=function(t,e,n,r){return t.addEventListener(bo[e],n,r)},Co=function(t,e,n){return t.removeEventListener(bo[e],n)},So=function(t,e){"contains"in t&&t.contains(e);var n=e;do{if(n===t)return!0}while(n=n.parentNode);return!1},Oo=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{stopPropagation:!0,cancelOnMultiple:!1},o={x:0,y:0},a={enabled:!0,origin:null,cancel:!1,cancelled:!1,pointers:Ao()},c=null,u=function(t,e){e&&(c||l(t,e),cancelAnimationFrame(c),c=requestAnimationFrame(function(){l(t,e),c=null}))},l=function(t,e){return e.apply(null,[t,function(t){return{x:t.pageX-o.x,y:t.pageY-o.y}}(t)])},s=function(n){var r=0===a.pointers.count();r&&(a.active=!1,a.cancel=!1,a.cancelled=!1),a.pointers.push(n),Io(document.documentElement,"up",d),r?(t===n.target||So(t,n.target))&&n.isPrimary&&(n.preventDefault(),i.stopPropagation&&(n.stopPropagation(),n.stopImmediatePropagation()),a.active=!0,o.x=n.pageX,o.y=n.pageY,Io(document.documentElement,"move",f),e(n)):i.cancelOnMultiple&&(a.cancel=!0)},f=function(t){t.isPrimary&&(a.cancelled||(t.preventDefault(),i.stopPropagation&&t.stopPropagation(),u(t,n),a.cancel&&(a.cancelled=!0,u(t,r))))},d=function t(e){a.pointers.pop(e),0===a.pointers.count()&&(Co(document.documentElement,"move",f),Co(document.documentElement,"up",t)),a.active&&(a.cancelled||(e.preventDefault(),i.stopPropagation&&e.stopPropagation(),u(e,n),u(e,r)))};return Io(document.documentElement,"down",s),{enable:function(){a.enabled||Io(document.documentElement,"down",s),a.enabled=!0},disable:function(){a.enabled&&Co(document.documentElement,"down",s),a.enabled=!1},destroy:function(){Co(document.documentElement,"up",d),Co(document.documentElement,"move",f),Co(document.documentElement,"down",s)}}},Lo={type:"spring",stiffness:.4,damping:.65,mass:7},Mo=function(t,e,n){if(/^(line|text|ellipse|rect)$/.test(n))t.dispatch("MARKUP_ADD_DEFAULT",{value:n}),t.dispatch("SET_MARKUP_UTIL",{value:"select"});else if("draw"===n&&!t.ref.drawInput){var r=t.ref,i=r.drawState,o=r.viewSize,a=0,c=0,u={},l=t.query("GET_MARKUP_DRAW_DISTANCE");t.ref.drawInput=Oo(t.element,function(n){var r=t.query("GET_MARKUP_TOOL_VALUES"),l=r.lineStyle[0],s=r.lineStyle[1];i.lineColor=r.color,i.lineWidth=l,i.lineStyle=s;var f=t.query("GET_ROOT"),d=void 0!==n.offsetX?n.offsetX:n.pageX-f.x-e.stageOffsetX-window.pageXOffset,h=void 0!==n.offsetY?n.offsetY:n.pageY-f.y-e.stageOffsetY-window.pageYOffset;a=d-t.markupX,c=h-t.markupY,u.x=0,u.y=0,i.points.push({x:a/o.width,y:c/o.height})},function(e,n){if(t.dispatch("KICK"),l){var r=De(n,u);if(r>l){var s=Ue(u,n)+Math.PI/2,f=l-r;u.x+=Math.sin(s)*f,u.y-=Math.cos(s)*f,i.points.push({x:(a+u.x)/o.width,y:(c+u.y)/o.height})}}else i.points.push({x:(a+n.x)/o.width,y:(c+n.y)/o.height})},function(e,n){i.points.length>1&&t.dispatch("MARKUP_ADD",["path",z({},i)]),i.points=[]})}"draw"!==n&&t.ref.drawInput&&(t.ref.drawInput.destroy(),t.ref.drawInput=null)},Po=function(t){var e=t.fontColor,n=t.backgroundColor,r=t.lineColor,i=t.borderColor;return e||n||r||i},Go=10,ko=function(t,e){return L()(e).forEach(function(n){t.setAttribute(n,e[n])})},Do="http://www.w3.org/2000/svg",Uo=function(t,e){var n=document.createElementNS(Do,t);return e&&ko(n,e),n},No=["nw","se"],Vo=["nw","n","ne","w","e","sw","s","se"],Bo={nw:"nwse",n:"ns",ne:"nesw",w:"ew",e:"ew",sw:"nesw",s:"ns",se:"nwse"},Fo={nw:function(t){return{x:t.x,y:t.y}},n:function(t){return{x:t.x+.5*t.width,y:t.y}},ne:function(t){return{x:t.x+t.width,y:t.y}},w:function(t){return{x:t.x,y:t.y+.5*t.height}},e:function(t){return{x:t.x+t.width,y:t.y+.5*t.height}},sw:function(t){return{x:t.x,y:t.y+t.height}},s:function(t){return{x:t.x+.5*t.width,y:t.y+t.height}},se:function(t){return{x:t.x+t.width,y:t.y+t.height}}},zo=Bt({tag:"div",name:"image-markup",ignoreRect:!0,mixins:{styles:["opacity"],animations:{opacity:"spring",markupX:Lo,markupY:Lo,markupWidth:Lo,markupHeight:Lo},listeners:!0,apis:["toolsReference","onSelect","onDrag","markupX","markupY","markupWidth","markupHeight","allowInteraction","stageOffsetX","stageOffsetY"]},create:function(t){var e=t.root,n=t.props,r=n.onSelect,i=void 0===r?function(){}:r,o=n.onUpdate,a=void 0===o?function(){}:o,c=Uo("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});e.ref.canvas=c;var u=e.query("GET_ROOT_SIZE");c.setAttribute("width",u.width),c.setAttribute("height",u.height);var l=document.createElement("input");ko(l,{type:"text",autocomplete:"off",autocapitalize:"off"}),l.addEventListener("keydown",function(t){t.stopPropagation(),13===t.keyCode||9===t.keyCode?(t.target.blur(),f()):8!==t.keyCode||e.ref.input.value.length||e.dispatch("MARKUP_DELETE",{id:e.ref.selected.id})}),e.ref.input=l,e.ref.elements=[],e.ref.viewSize={width:0,height:0,scale:0},e.ref.resetSelected=function(){return e.ref.selected={id:null,type:null,settings:{}},e.ref.selected},e.ref.resetSelected();var s=function(t){return t.id?t:t.parentNode},f=function(){e.ref.resetSelected(),i(null)};e.ref.handleDeselect=function(t){var r;e.query("IS_ACTIVE_VIEW","markup")&&e.ref.selected.id&&t.target!==e.ref.removeButton.element&&(r=t.target,e.ref.selected.id!==s(r).id&&(function(t){return So(e.ref.manipulatorGroup,t)||t===e.ref.input}(t.target)||n.isMarkupUtil(t.target)||f()))},Io(document.body,"down",e.ref.handleDeselect),e.ref.handleTextInput=function(){return a("text",e.ref.input.value)},e.ref.input.addEventListener("input",e.ref.handleTextInput),e.ref.handleAttemptDelete=function(t){e.query("IS_ACTIVE_VIEW","markup")&&(!e.ref.selected.id||8!==t.keyCode&&46!==t.keyCode||(t.stopPropagation(),t.preventDefault(),e.dispatch("MARKUP_DELETE",{id:e.ref.selected.id})))},document.body.addEventListener("keydown",e.ref.handleAttemptDelete);var d=Uo("g"),h=Uo("g",{class:"doka--shape-group"});d.appendChild(h),e.ref.shapeGroup=h;var p=Uo("g",{fill:"none",class:"doka--manipulator-group"}),v=Uo("rect",{x:0,y:0,width:0,height:0,fill:"none"}),g=Uo("path");p.appendChild(g),p.appendChild(v),e.ref.manipulatorPath=g,e.ref.manipulatorRect=v,e.ref.manipulators=[];for(var m=0;m<10;m++){var y=Uo("circle",{r:6,"stroke-width":2,style:"display:none"});p.appendChild(y),e.ref.manipulators.push(y)}d.appendChild(p),e.ref.manipulatorGroup=p,c.appendChild(d),e.ref.shapeOffsetGroup=d,e.ref.removeButton=e.appendChildView(e.createChildView(vo,{label:e.query("GET_LABEL_MARKUP_REMOVE_SHAPE"),name:"destroy-shape",action:function(){e.dispatch("MARKUP_DELETE",{id:e.ref.selected.id})}})),e.query("IS_ACTIVE_VIEW","markup")&&(e.element.dataset.active=!0),e.ref.drawInput=null,e.ref.drawState={lineColor:null,lineWidth:null,lineStyle:null,points:[]};var E=Uo("path",{fill:"none",class:"doka--draw-path"});e.ref.drawPath=E,c.appendChild(E);var _=st("div","doka--image-markup-clip");_.appendChild(l),_.appendChild(c),e.ref.clip=_,e.element.appendChild(_),"draw"===e.query("GET_MARKUP_UTIL")&&Mo(e,n,"draw")},destroy:function(t){var e=t.root;e.ref.elements.concat(e.ref.manipulators).forEach(function(t){t.dragger&&t.dragger.destroy()}),e.ref.input.removeEventListener("input",e.ref.handleTextInput),document.body.removeEventListener("keydown",e.ref.handleAttemptDelete),Co(document.body,"down",e.ref.handleDeselect)},read:function(t){var e=t.root;if(!e.rect.element.hidden)for(var n in e.ref.elements){var r=e.ref.elements[n];if(r&&"text"===r.nodeName&&r.parentNode){var i=r.getBBox();r.bbox={x:i.x,y:i.y,width:i.width,height:i.height}}}},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.props;"markup"===t.action.id?e.element.dataset.active=!0:(e.element.dataset.active=!1,n.onSelect(null))},MARKUP_SET_VALUE:function(t){t.root.ref.shapeGroup.innerHTML=""},UPDATE_ROOT_RECT:function(t){var e=t.root,n=t.action,r=e.ref.canvas;r.setAttribute("width",n.rect.width),r.setAttribute("height",n.rect.height),e.ref.previousScale=null},SWITCH_MARKUP_UTIL:function(t){var e=t.root,n=t.action,r=t.props,i=n.util;Mo(e,r,i)}},function(t){var e=t.root,n=t.props,r=t.timestamp;if(!(e.opacity<=0)){var i=e.query("GET_CROP",n.id,r);if(i){var o=e.query("GET_MARKUP_UTIL");e.element.dataset.util=o||"";var a=i.markup,c=i.cropStatus,u=n.onSelect,s=n.onDrag,f=e.ref,d=f.clip,h=f.manipulatorGroup,p=f.drawPath,v=f.viewSize,g=f.shapeOffsetGroup,m=f.manipulators,y=f.manipulatorPath,E=f.manipulatorRect,_=f.removeButton,w=f.drawState,T=e.query("GET_OUTPUT_WIDTH"),x=e.query("GET_OUTPUT_HEIGHT"),R=c.image,b=c.crop,A=b.width,I=b.height,C=b.widthFloat/b.heightFloat;if(T||x){var S=e.query("GET_OUTPUT_FIT");T&&!x&&(x=T),x&&!T&&(T=x);var O,L=T/A,M=x/I;"force"===S?(A=T,I=x):("cover"===S?O=Math.max(L,M):"contain"===S&&(O=Math.min(L,M)),A*=O,I*=O)}else R.width&&R.height?(A=R.width,I=R.height):R.width&&!R.height?(A=R.width,I=R.width/C):R.height&&!R.width&&(I=R.height,A=R.height*C);var P=w.points.length,G=Oe(e.markupX,3),k=Oe(e.markupY,3),D=Oe(e.markupWidth,3),U=Oe(e.markupHeight,3),N=Oe(Math.min(e.markupWidth/A,e.markupHeight/I),4);if(v.width=D,v.height=U,v.scale=N,qo(e,{drawLength:P,markupX:G,markupY:k,scale:N,markup:a,currentWidth:A,currentHeight:I})){var V=G,B=e.rect.element.width-G-D,F=k,W=e.rect.element.height-k-U,Y="inset(".concat(F,"px ").concat(B,"px ").concat(W,"px ").concat(V,"px)");if(d.style.clipPath=Y,d.style.webkitClipPath=Y,g.setAttribute("transform","translate(".concat(G," ").concat(k,")")),e.ref.previousDrawLength=P,e.ref.previousX=G,e.ref.previousY=k,e.ref.previousScale=N,e.ref.previousCurrentHeight=I,e.ref.previousCurrentWidth=A,e.ref.previousMarkupLength=a.length,!(v.width<1||v.height<1)){var H,j=a.find(function(t){return t[1].isSelected}),Z=j&&e.ref.selected.id!==j[1].id||e.ref.selected.id&&!j;if(H=j?e.ref.selected={id:j[1].id,type:j[0],settings:j[1]}:e.ref.resetSelected(),w.points.length){var X=rr(w,v,N);return X.d=ar(w.points.map(function(t){return{x:G+t.x*v.width,y:k+t.y*v.height}})),void ko(p,X)}p.removeAttribute("d"),e.ref.input.hidden="text"!==e.ref.selected.type,_.element.dataset.active=null!==e.ref.selected.id,y.setAttribute("style","opacity:0"),E.setAttribute("style","opacity:0"),m.forEach(function(t){return t.setAttribute("style","opacity:0;pointer-events:none;")});var K=e.query("GET_MARKUP_FILTER");a.filter(K).sort(br).forEach(function(t,r){var i=q(t,2),o=i[0],a=i[1],c=a.id,f=a.isDestroyed,d=a.isDirty,p=a.isSelected,g=a.allowSelect,w=a.allowMove,T=a.allowResize,x=a.allowInput;if(f){var R=e.ref.elements[c];R&&(R.dragger&&R.dragger.destroy(),e.ref.elements[c]=null,R.parentNode.removeChild(R))}else{var b,A,I,C=e.ref.elements[c];if(C||(C=xr(o,a),e.ref.elements[c]=C,g?(C.dragger=Oo(C,function(){A=l()(),b=z({},C.rect),(I=c===e.ref.selected.id)||u(c)},function(t,e){w&&s(c,b,e,v,N)},function(t,n){if(x&&"text"===o&&I){var r=ke({x:0,y:0},n),i=l()()-A;if(!(r>10||i>750)){e.ref.input.focus();var a=e.markupX+C.bbox.x,c=C.bbox.width,u=(t.offsetX-a)/c,s=Math.round(e.ref.input.value.length*u);e.ref.input.setSelectionRange(s,s)}}}),C.dragger.disable()):C.setAttribute("style","pointer-events:none;")),C.dragger&&(n.allowInteraction?C.dragger.enable():C.dragger.disable()),r!==C.index){C.index=r;var S=e.ref.shapeGroup;S.insertBefore(C,S.childNodes[r+1])}if(d&&Rr(C,o,a,v,N),p){var O=_.rect.element.width,L=_.rect.element.height,M=e.markupX-.5*O,P=e.markupY-L-15,G="text"===o?C.bbox:C.rect,k=!1,D=Po(a);if(D){var U=Tn(D);k=(.2126*U[0]+.7152*U[1]+.0722*U[2])/255>.65,h.setAttribute("is-bright-color",k)}"line"===o?(M+=G.x,P+=G.y,ko(y,{d:"M ".concat(G.x," ").concat(G.y," L ").concat(G.x+G.width," ").concat(G.y+G.height),style:"opacity:1"})):"path"===o?(M+=(G={x:a.points[0].x*v.width,y:a.points[0].y*v.height,width:0,height:0}).x,P+=G.y,ko(y,{d:ar(a.points.map(function(t){return{x:t.x*v.width,y:t.y*v.height}})),style:"opacity:1"})):G&&(M+=G.x+.5*G.width,P+=G.y,ko(E,{x:G.x-("text"===o?5:0),y:G.y,width:G.width+("text"===o?10:0),height:G.height,style:"opacity:1"}));var V=e.markupY+Go,B=e.markupY+e.markupHeight-Go,F=e.markupX+Go,W=e.markupX+e.markupWidth-Go;if(P<V?P=V:P+L>B&&(P=B-L),M<F?M=F:M+O>W&&(M=W-O),G||(_.element.dataset.active="false"),_.element.setAttribute("style","transform: translate3d(".concat(M,"px, ").concat(P,"px, 0)")),"text"===o&&G){var Y=G.width+65,H=e.markupWidth-G.x,j="\n                        width: ".concat(Math.min(Y,H),"px;\n                        height: ").concat(G.height,"px;\n                        color: ").concat(C.getAttribute("fill"),";\n                        font-family: ").concat(C.getAttribute("font-family"),";\n                        font-size: ").concat(C.getAttribute("font-size").replace(/px/,""),"px;\n                        font-weight: ").concat(C.getAttribute("font-weight")||"normal",";\n                    ");xe()?j+="\n                            left: ".concat(Math.round(e.markupX+G.x),"px;\n                            top: ").concat(Math.round(e.markupY+G.y),"px;\n                        "):j+="\n                            transform: translate3d(".concat(Math.round(e.markupX+G.x),"px,").concat(Math.round(e.markupY+G.y),"px,0);\n                        "),e.ref.input.setAttribute("style",j),C.setAttribute("fill","none")}if("text"===o)return;if(!T)return;var Z="line"===o?No:Vo;m.forEach(function(t,e){var n=Z[e];if(n){var r="line"===o?"move":"".concat(Bo[n],"-resize"),i=Fo[n](C.rect);ko(t,{cx:i.x,cy:i.y,style:"opacity:1;cursor:".concat(r)})}})}a.isDirty=!1}}),Z&&(Ho(e),"text"===H.type?e.ref.input.value=H.settings.text:e.ref.selected.id&&Yo(e,n.onResize))}}}}})}),Wo=function(t){return t.forEach(function(t){return t[1].isDirty=!0})},qo=function(t,e){var n=e.drawLength,r=e.markup,i=e.markupX,o=e.markupY,a=e.currentWidth,c=e.currentHeight,u=e.scale;return n!==t.ref.previousDrawLength||(i!==t.ref.previousX?(Wo(r),!0):o!==t.ref.previousY?(Wo(r),!0):u!==t.ref.previousScale?(Wo(r),!0):c!==t.ref.previousCurrentHeight?(Wo(r),!0):a!==t.ref.previousCurrentWidth?(Wo(r),!0):r.length!==t.ref.previousMarkupLength||!!r.find(function(t){return t[1].isDirty}))},Yo=function(t,e){var n=t.ref.selected.id,r="g"===t.ref.elements[n].nodeName?No:Vo;t.ref.manipulators.forEach(function(i,o){var a=r[o];if(a){var c=null;i.dragger=Oo(i,function(){c={x:h()(at(i,"cx")),y:h()(at(i,"cy"))}},function(r,i){e(n,a,c,i,t.ref.viewSize)},null,{stopPropagation:!0})}})},Ho=function(t){t.ref.manipulators.forEach(function(t){t.dragger&&(t.dragger.destroy(),t.dragger=null)})},jo={38:"up",40:"down",37:"left",39:"right",189:"minus",187:"plus",72:"h",76:"l",81:"q",82:"r",84:"t",86:"v",90:"z",219:"left_bracket",221:"right_bracket"},Zo=function(t,e,n,r,i){var o=null,a=!0,c={enabled:!0},u=function(t){var i=jo[t.keyCode]||t.keyCode;n[i]&&(t.stopPropagation(),a&&(o=e(i),a=!1),n[i](o),r(o))},l=function(t){var e=jo[t.keyCode]||t.keyCode;n[e]&&(t.stopPropagation(),i(o),a=!0)};return t.addEventListener("keydown",u),t.addEventListener("keyup",l),{enable:function(){c.enabled||(t.addEventListener("keydown",u),t.addEventListener("keyup",l)),c.enabled=!0},disable:function(){c.enabled&&(t.removeEventListener("keydown",u),t.removeEventListener("keyup",l)),c.enabled=!1},destroy:function(){t.removeEventListener("keydown",u),t.removeEventListener("keyup",l)}}},Xo=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0;e=Math.round(e),n=Math.round(n);var o=i||document.createElement("canvas"),a=o.getContext("2d");return r>=5&&r<=8?(o.width=n,o.height=e):(o.width=e,o.height=n),a.save(),-1!==r&&a.transform.apply(a,qn(e,n,r)),a.drawImage(t,0,0,e,n),a.restore(),o},Ko=function(){self.onmessage=function(t){createImageBitmap(t.data.message.file).then(function(e){self.postMessage({id:t.data.id,message:e},[e])})}},$o=function(t){return/^image/.test(t.type)&&!/svg/.test(t.type)},Qo=function(t){return"createImageBitmap"in window&&$o(t)},Jo=function(t){return new f.a(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=function(t){n(t)},r.src=t})},ta=function(t,e,n){var r=t.createShader(n);return t.shaderSource(r,e),t.compileShader(r),r},ea=function(t,e,n){var r=t.createProgram();return t.attachShader(r,ta(t,e,t.VERTEX_SHADER)),t.attachShader(r,ta(t,n,t.FRAGMENT_SHADER)),t.linkProgram(r),r},na=function(t,e,n,r,i){var o=t.createTexture();t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.uniform1i(e,r),t.uniform2f(n,i.width,i.height);try{t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)}catch(e){t.texImage2D(t.TEXTURE_2D,0,t.RGBA,i.width,i.height,0,t.RGBA,t.UNSIGNED_BYTE,null)}return o},ra=function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},ia=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,t[10]=(i+r)*a,t[14]=2*i*r*a},oa=function(t,e){var n=e[0],r=e[1],i=e[2];t[12]=t[0]*n+t[4]*r+t[8]*i+t[12],t[13]=t[1]*n+t[5]*r+t[9]*i+t[13],t[14]=t[2]*n+t[6]*r+t[10]*i+t[14],t[15]=t[3]*n+t[7]*r+t[11]*i+t[15]},aa=function(t,e){var n=e[0],r=e[1],i=e[2];t[0]=t[0]*n,t[1]=t[1]*n,t[2]=t[2]*n,t[3]=t[3]*n,t[4]=t[4]*r,t[5]=t[5]*r,t[6]=t[6]*r,t[7]=t[7]*r,t[8]=t[8]*i,t[9]=t[9]*i,t[10]=t[10]*i,t[11]=t[11]*i},ca=function(t,e){var n=Math.sin(e),r=Math.cos(e),i=t[4],o=t[5],a=t[6],c=t[7],u=t[8],l=t[9],s=t[10],f=t[11];t[4]=i*r+u*n,t[5]=o*r+l*n,t[6]=a*r+s*n,t[7]=c*r+f*n,t[8]=u*r-i*n,t[9]=l*r-o*n,t[10]=s*r-a*n,t[11]=f*r-c*n},ua=function(t,e){var n=Math.sin(e),r=Math.cos(e),i=t[0],o=t[1],a=t[2],c=t[3],u=t[8],l=t[9],s=t[10],f=t[11];t[0]=i*r-u*n,t[1]=o*r-l*n,t[2]=a*r-s*n,t[3]=c*r-f*n,t[8]=i*n+u*r,t[9]=o*n+l*r,t[10]=a*n+s*r,t[11]=c*n+f*r},la=function(t,e){var n=Math.sin(e),r=Math.cos(e),i=t[0],o=t[1],a=t[2],c=t[3],u=t[4],l=t[5],s=t[6],f=t[7];t[0]=i*r+u*n,t[1]=o*r+l*n,t[2]=a*r+s*n,t[3]=c*r+f*n,t[4]=u*r-i*n,t[5]=l*r-o*n,t[6]=s*r-a*n,t[7]=f*r-c*n},sa={create:ra,perspective:ia,translate:oa,scale:aa,rotateX:ca,rotateY:ua,rotateZ:la},fa=function(t){return t*Math.PI/180},da="\nprecision mediump float;\n\nuniform sampler2D uTexture;\nuniform vec2 uTextureSize;\n\nuniform float uColorOpacity;\nuniform mat4 uColorMatrix;\nuniform vec4 uColorOffset;\n\nuniform vec4 uOverlayColor;\nuniform vec2 uOverlayLeftTop;\nuniform vec2 uOverlayRightBottom;\n\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\n\nvoid main () {\n\n    vec3 cB = vec3(1.0);\n\n\tvec4 cF = texture2D(uTexture, vTexCoord);\n\t\n\tvec4 cM = (cF * uColorMatrix) + uColorOffset;\n\n    float r = max(0.0, cM.r * cM.a) + (cB.r * (1.0 - cM.a));\n    float g = max(0.0, cM.g * cM.a) + (cB.g * (1.0 - cM.a));\n    float b = max(0.0, cM.b * cM.a) + (cB.b * (1.0 - cM.a));\n\n\tvec4 color = vec4(r, g, b, cF.a);\n\t\n\t// test if falls within\n    if ((gl_FragCoord.x < uOverlayLeftTop.x || gl_FragCoord.x > uOverlayRightBottom.x) || \n        (gl_FragCoord.y > uOverlayLeftTop.y || gl_FragCoord.y < uOverlayRightBottom.y)) {\n\t\tcolor *= uOverlayColor;\n\t}\n\t\n    gl_FragColor = color * uColorOpacity;\n}\n",ha="\nattribute vec4 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMatrix;\n\n// send to fragment shader\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\n\nvoid main () {\n    vPosition = uMatrix * aPosition;\n    gl_Position = vPosition;\n    vTexCoord = aTexCoord;\n}\n",pa="\nprecision mediump float;\n\nuniform vec2 uViewportSize;\nuniform vec3 uColorStart;\nuniform vec3 uColorEnd;\nuniform vec2 uOverlayLeftTop;\nuniform vec2 uOverlayRightBottom;\nuniform vec4 uColorCanvasBackground;\n\nvoid main() {\n\n\tfloat x = gl_FragCoord.x;\n\tfloat y = gl_FragCoord.y;\n\n\tvec2 center = vec2(.5, .5);\n\tvec2 st = vec2(x / uViewportSize.x, y / uViewportSize.y);\n\tfloat mixValue = distance(st, center) * 1.5; // expand outside view (same as doka--root::after)\n\tvec3 color = mix(uColorStart, uColorEnd, mixValue);\n\n\tif (uColorCanvasBackground[3] == 1.0) {\n\n\t\tfloat innerLeft = uOverlayLeftTop.x;\n\t\tfloat innerRight = uOverlayRightBottom.x;\n\t\tfloat innerTop = uOverlayRightBottom.y;\n\t\tfloat innerBottom = uOverlayLeftTop.y;\n\n\t\tif (x < innerLeft || x > innerRight || y < innerTop || y > innerBottom) {\n\t\t\tgl_FragColor = vec4(color, 1.0);\n\t\t\treturn;\n\t\t}\n\n\t\tgl_FragColor = uColorCanvasBackground;\n\t\treturn;\n\t}\n\t\n\tgl_FragColor = vec4(color, 1.0);\n}\n",va="\nprecision mediump float;\n\nuniform vec2 uOverlayLeftTop;\nuniform vec2 uOverlayRightBottom;\nuniform vec4 uOutlineColor;\nuniform float uOutlineWidth;\n\nvoid main() {\n\n\tfloat x = gl_FragCoord.x;\n\tfloat y = gl_FragCoord.y;\n\n\tfloat innerLeft = uOverlayLeftTop.x;\n\tfloat innerRight = uOverlayRightBottom.x;\n\tfloat innerTop = uOverlayRightBottom.y;\n\tfloat innerBottom = uOverlayLeftTop.y;\n\n\tfloat outerLeft = innerLeft - uOutlineWidth;\n\tfloat outerRight = innerRight + uOutlineWidth;\n\tfloat outerTop = innerTop - uOutlineWidth;\n\tfloat outerBottom = innerBottom + uOutlineWidth;\n\t\n\tif (x < outerLeft || x >= outerRight || y < outerTop || y >= outerBottom) {\n\t\tdiscard;\n\t}\n\n\tif (x < innerLeft || x >= innerRight || y < innerTop || y >= innerBottom) {\n\t\tgl_FragColor = uOutlineColor;\n\t}\n}\n",ga="\nattribute vec4 aPosition;\nvoid main() {\n\tgl_Position = aPosition;\n}\n",ma=function(t,e,n){var r={width:0,height:0},i={x:0,y:0},o=null,a=fa(30),c=Math.tan(a/2),u={antialias:!1,alpha:!1},l=t.getContext("webgl",u)||t.getContext("experimental-webgl",u);if(!l)return null;l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA);var s=ea(l,ga,pa),f=l.getUniformLocation(s,"uColorStart"),d=l.getUniformLocation(s,"uColorEnd"),h=l.getUniformLocation(s,"uViewportSize"),p=l.getAttribLocation(s,"aPosition"),v=l.getUniformLocation(s,"uOverlayLeftTop"),g=l.getUniformLocation(s,"uOverlayRightBottom"),m=l.getUniformLocation(s,"uColorCanvasBackground"),y=l.createBuffer(),E=new Float32Array([1,-1,1,1,-1,-1,-1,1]);l.bindBuffer(l.ARRAY_BUFFER,y),l.bufferData(l.ARRAY_BUFFER,E,l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,null);var _=ea(l,ga,va),w=l.getAttribLocation(_,"aPosition"),T=l.getUniformLocation(_,"uOutlineWidth"),x=l.getUniformLocation(_,"uOutlineColor"),R=l.getUniformLocation(_,"uOverlayLeftTop"),b=l.getUniformLocation(_,"uOverlayRightBottom"),A=l.createBuffer(),I=new Float32Array([1,-1,1,1,-1,-1,-1,1]);l.bindBuffer(l.ARRAY_BUFFER,A),l.bufferData(l.ARRAY_BUFFER,I,l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,null);var C=ea(l,ha,da);l.useProgram(C);var S=l.getUniformLocation(C,"uMatrix"),O=l.getUniformLocation(C,"uTexture"),L=l.getUniformLocation(C,"uTextureSize"),M=l.getUniformLocation(C,"uOverlayColor"),P=l.getUniformLocation(C,"uOverlayLeftTop"),G=l.getUniformLocation(C,"uOverlayRightBottom"),k=l.getUniformLocation(C,"uColorOpacity"),D=l.getUniformLocation(C,"uColorOffset"),U=l.getUniformLocation(C,"uColorMatrix"),N=l.getAttribLocation(C,"aPosition"),V=l.getAttribLocation(C,"aTexCoord"),B=na(l,O,L,0,e),F=e.width*n,z=e.height*n,W=-.5*F,q=.5*z,H=.5*F,j=-.5*z,Z=new Float32Array([W,q,W,j,H,q,H,j]),X=new Float32Array([0,0,0,1,1,0,1,1]),K=Z.length/2,$=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,$),l.bufferData(l.ARRAY_BUFFER,Z,l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,null);var Q=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,Q),l.bufferData(l.ARRAY_BUFFER,X,l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,null);var J=0,tt=0;return{release:function(){t.width=1,t.height=1},resize:function(e,a){t.width=e*n,t.height=a*n,t.style.width="".concat(e,"px"),t.style.height="".concat(a,"px"),r.width=e*n,r.height=a*n,i.x=.5*r.width,i.y=.5*r.height,o=r.width/r.height,l.viewport(0,0,l.canvas.width,l.canvas.height)},update:function(t,u,E,I,O,L,F,z,W,q,H,j,Z,X,et,nt,rt,it,ot){var at=H?H.height*n:r.height;J=e.width*n,tt=e.height*n,t*=n,u*=n,E*=n,I*=n;var ct=tt/2/c*(r.height/at)*-1;ct/=-c*ct*2/r.height;var ut=.5*J,lt=.5*tt;t-=ut,u-=lt;var st=z,ft=-(i.x-ut)+E,dt=i.y-lt-I,ht=sa.create();sa.perspective(ht,a,o,1,2*-ct),sa.translate(ht,[ft,dt,ct]),sa.translate(ht,[t,-u,0]),sa.scale(ht,[st,st,st]),sa.rotateZ(ht,-F),sa.translate(ht,[-t,u,0]),sa.rotateY(ht,L),sa.rotateX(ht,O),l.clearColor(X[0],X[1],X[2],1),l.clear(l.COLOR_BUFFER_BIT);var pt=j.x*n,vt=j.y*n,gt=j.width*n,mt=j.height*n,yt=pt,Et=yt+gt,_t=r.height-vt,wt=r.height-(vt+mt);l.useProgram(s),l.uniform3fv(f,et),l.uniform3fv(d,nt),l.uniform4fv(m,ot.map(function(t,e){return e<3?t/255:t})),l.uniform2f(h,r.width,r.height),l.uniform2f(v,yt,_t),l.uniform2f(g,Et,wt),l.bindBuffer(l.ARRAY_BUFFER,y),l.vertexAttribPointer(p,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(p),l.drawArrays(l.TRIANGLE_STRIP,0,4),l.useProgram(C),l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindTexture(l.TEXTURE_2D,B),l.bindBuffer(l.ARRAY_BUFFER,$),l.vertexAttribPointer(N,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(N),l.bindBuffer(l.ARRAY_BUFFER,Q),l.vertexAttribPointer(V,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(V),l.uniformMatrix4fv(S,!1,ht),l.uniform2f(P,yt,_t),l.uniform2f(G,Et,wt),l.uniform4fv(M,Z),l.uniform1f(k,q),l.uniform4f(D,W[4],W[9],W[14],W[19]),l.uniformMatrix4fv(U,!1,[].concat(Y(W.slice(0,4)),Y(W.slice(5,9)),Y(W.slice(10,14)),Y(W.slice(15,19)))),l.drawArrays(l.TRIANGLE_STRIP,0,K),l.useProgram(_),l.uniform1f(T,rt),l.uniform4fv(x,it),l.uniform2f(R,yt,_t),l.uniform2f(b,Et,wt),l.bindBuffer(l.ARRAY_BUFFER,A),l.vertexAttribPointer(w,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(w),l.drawArrays(l.TRIANGLE_STRIP,0,4)}}},ya=function(t){var e=0,n={},r=Et(t),i=Et(t),o=Et(t),a=Et(t);return r.onupdate=function(t){return n.x=t},r.oncomplete=function(){return e++},i.onupdate=function(t){return n.y=t},i.oncomplete=function(){return e++},o.onupdate=function(t){return n.width=t},o.oncomplete=function(){return e++},a.onupdate=function(t){return n.height=t},a.oncomplete=function(){return e++},{interpolate:function(t){r.interpolate(t),i.interpolate(t),o.interpolate(t),a.interpolate(t)},setTarget:function(t){e=0,r.target=t?t.x:null,i.target=t?t.y:null,o.target=t?t.width:null,a.target=t?t.height:null},getRect:function(){return z({},n)},isStable:function(){return 4===e}}},Ea=function(t){var e=0,n={},r=Et(t),i=Et(t),o=Et(t);return r.onupdate=function(t){return n.r=t},r.oncomplete=function(){return e++},i.onupdate=function(t){return n.g=t},i.oncomplete=function(){return e++},o.onupdate=function(t){return n.b=t},o.oncomplete=function(){return e++},{interpolate:function(t){r.interpolate(t),i.interpolate(t),o.interpolate(t)},setTarget:function(t){e=0,r.target=t?t[0]:null,i.target=t?t[1]:null,o.target=t?t[2]:null},getColor:function(){return[n.r,n.g,n.b]},isStable:function(){return 3===e}}},_a={stiffness:.25,damping:.25,mass:2.5},wa=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Ta=Bt({name:"image-gl",ignoreRect:!0,ignoreRectUpdate:!0,mixins:{apis:["top","left","width","height","xOrigin","yOrigin","xTranslation","yTranslation","xRotation","yRotation","zRotation","scale","overlay","stage","colorMatrix","colorOpacity","overlayOpacity","outlineWidth","isDraft"],animations:{xTranslation:Lo,yTranslation:Lo,xOrigin:Lo,yOrigin:Lo,scale:Lo,xRotation:{type:"spring",stiffness:.25,damping:.25,mass:2.5},yRotation:{type:"spring",stiffness:.25,damping:.25,mass:2.5},zRotation:{type:"spring",stiffness:.25,damping:.25,mass:2.5},colorOpacity:{type:"tween",delay:150,duration:750},overlayOpacity:"spring",introScale:{type:"spring",stiffness:.25,damping:.75,mass:15},outlineWidth:Lo}},create:function(t){var e=t.root;e.ref.canvas=document.createElement("canvas"),e.ref.canvas.width=0,e.ref.canvas.height=0,e.appendChild(e.ref.canvas),e.ref.gl=null,e.introScale=1,e.ref.isPreview="preview"===e.query("GET_STYLE_LAYOUT_MODE"),e.ref.shouldZoom=!e.ref.isPreview,e.ref.didZoom=!1,e.ref.backgroundColor=null,e.ref.backgroundColorSpring=Ea(_a),e.ref.backgroundColorCenter=null,e.ref.backgroundColorCenterSpring=Ea(_a),e.ref.overlaySpring=ya(Lo),e.ref.stageSpring=ya(Lo),e.ref.outlineSpring=Et(Lo),e.ref.colorMatrixSpring=[],e.ref.colorMatrixStable=!0,e.ref.colorMatrixStableCount=0,e.ref.colorMatrixPositions=[];for(var n=0;n<20;n++)!function(){var t=n,r=Et(_a);r.target=wa[t],r.onupdate=function(n){e.ref.colorMatrixPositions[t]=n},r.oncomplete=function(){e.ref.colorMatrixStableCount++},e.ref.colorMatrixSpring[t]=r}();e.ref.dragger=Oo(e.element,function(){e.dispatch("CROP_IMAGE_DRAG_GRAB")},function(t,n){e.dispatch("CROP_IMAGE_DRAG",{value:n})},function(){e.dispatch("CROP_IMAGE_DRAG_RELEASE")},{cancelOnMultiple:!0});var r=0,i=0;e.ref.keyboard=Zo(e.element,function(){return r=0,i=0,{x:0,y:0}},{up:function(t){t.y-=20},down:function(t){t.y+=20},left:function(t){t.x-=20},right:function(t){t.x+=20},plus:function(){r+=.1,e.dispatch("CROP_IMAGE_RESIZE_AMOUNT",{value:r}),e.dispatch("CROP_IMAGE_RESIZE_RELEASE")},minus:function(){r-=.1,e.dispatch("CROP_IMAGE_RESIZE_AMOUNT",{value:r}),e.dispatch("CROP_IMAGE_RESIZE_RELEASE")},left_bracket:function(){i-=Math.PI/128,e.dispatch("CROP_IMAGE_ROTATE_ADJUST",{value:i})},right_bracket:function(){i+=Math.PI/128,e.dispatch("CROP_IMAGE_ROTATE_ADJUST",{value:i})},h:function(){e.dispatch("CROP_IMAGE_FLIP_HORIZONTAL")},l:function(){e.dispatch("CROP_IMAGE_ROTATE_LEFT")},q:function(){e.dispatch("CROP_RESET")},r:function(){e.dispatch("CROP_IMAGE_ROTATE_RIGHT")},v:function(){e.dispatch("CROP_IMAGE_FLIP_VERTICAL")},z:function(){e.dispatch("CROP_ZOOM")}},function(t){t&&e.dispatch("CROP_IMAGE_DRAG",{value:t})},function(t){t&&e.dispatch("CROP_IMAGE_DRAG_RELEASE")});var o=e.query("GET_FILE"),a=URL.createObjectURL(o.data),c=function(t){var n=gi(t,{width:e.query("GET_MAX_IMAGE_PREVIEW_WIDTH"),height:e.query("GET_MAX_IMAGE_PREVIEW_HEIGHT")}),r=Xo(t,n.width,n.height,o.orientation),i=Math.max(1,.75*window.devicePixelRatio),a=r.height/r.width,c=96*i,u=Xo(r,a>1?c:c/a,a>1?c*a:c),l=r.getContext("2d").getImageData(0,0,r.width,r.height),s=u.getContext("2d").getImageData(0,0,u.width,u.height);Yn(r),Yn(u),e.ref.gl=ma(e.ref.canvas,l,i),e.ref.gl?(e.dispatch("DID_RECEIVE_IMAGE_DATA",{previewData:l,thumbData:s}),e.dispatch("DID_PRESENT_IMAGE")):e.dispatch("MISSING_WEBGL")},u=function(){Jo(a).then(c)};if(Qo(o.data)){var l=kr(Ko);l.post({file:o.data},function(t){l.terminate(),t?c(t):u()})}else u();e.ref.canvasStyle=getComputedStyle(e.ref.canvas),e.ref.previousBackgroundColor,e.ref.previousLeft,e.ref.previousTop,e.ref.previousWidth,e.ref.previousHeight,e.element.dataset.showInteractionIndicator=!1,e.ref.handleFocus=function(t){9===t.keyCode&&(e.element.dataset.showInteractionIndicator=!0)},e.ref.handleBlur=function(t){e.element.dataset.showInteractionIndicator=!1},At(e.element)("keyup",e.ref.handleFocus),At(e.element)("blur",e.ref.handleBlur)},destroy:function(t){var e=t.root;e.ref.gl&&(e.ref.gl.release(),e.ref.gl=null),e.ref.dragger.destroy(),It(e.element)("keyup",e.ref.handleFocus),It(e.element)("blur",e.ref.handleBlur)},read:function(t){var e=t.root,n=e.ref.canvasStyle.backgroundColor,r=e.ref.canvasStyle.color;if("transparent"!==r&&""!==r||(r=null),"transparent"!==n&&""!==n||(n=null),n&&n!==e.ref.previousBackgroundColor){var i=Tn(n).map(function(t){return t/255}),o=(i[0]+i[1]+i[2])/3;e.ref.backgroundColor=i,e.ref.backgroundColorCenter=i.map(function(t){return o>.5?t-.15:t+.15}),e.ref.previousBackgroundColor=n}r&&r!==e.ref.previousOutlineColor&&(e.ref.outlineColor=Tn(r).map(function(t){return t/255}).concat(1),e.ref.previousOutlineColor=r)},write:zt({SHOW_VIEW:function(t){var e=t.root;"crop"===t.action.id?(e.ref.dragger.enable(),e.element.setAttribute("tabindex","0")):(e.ref.dragger.disable(),e.element.removeAttribute("tabindex"))}},function(t){var e=t.root,n=t.props,r=(t.actions,t.timestamp);if(e.ref.gl&&n.width&&n.height){var i=e.ref,o=i.gl,a=i.previousWidth,c=i.previousHeight,u=i.shouldZoom,l=i.stageSpring,s=i.overlaySpring,f=i.backgroundColorSpring,d=i.backgroundColorCenterSpring;n.width===a&&n.height===c||(e.ref.gl.resize(n.width,n.height),e.ref.previousWidth=n.width,e.ref.previousHeight=n.height),n.left===e.ref.previousLeft&&n.top===e.ref.previousTop||(e.ref.canvas.style.transform="translate(".concat(-n.left,"px, ").concat(-n.top,"px)"),e.ref.previousLeft=n.left,e.ref.previousTop=n.top),u&&!e.ref.didZoom&&(e.introScale=null,e.introScale=1.15,e.introScale=1,e.ref.didZoom=!0),f.setTarget(e.ref.backgroundColor),f.interpolate(r);var h=f.isStable();d.setTarget(e.ref.backgroundColorCenter),d.interpolate(r);var p=d.isStable();e.ref.colorMatrixStableCount=0;var v=n.colorMatrix||wa,g=e.ref.colorMatrixSpring.map(function(t,n){return t.target=v[n],t.interpolate(r),e.ref.colorMatrixPositions[n]}),m=20===e.ref.colorMatrixStableCount;n.isDraft&&s.setTarget(null),s.setTarget(n.overlay),s.interpolate(r);var y=s.isStable();n.isDraft&&l.setTarget(null),l.setTarget(n.stage),l.interpolate(r);var E=l.isStable();return o.update(e.xOrigin,e.yOrigin,e.xTranslation+n.left,e.yTranslation+n.top,e.xRotation,e.yRotation,e.zRotation,e.scale*e.introScale,g,e.ref.isPreview?1:e.colorOpacity,l.getRect(),s.getRect(),[1,1,1,1-e.overlayOpacity],f.getColor(),d.getColor(),f.getColor(),e.outlineWidth,e.ref.outlineColor,e.query("GET_BACKGROUND_COLOR")),y&&E&&m&&h&&p}})}),xa=Bt({name:"image",ignoreRect:!0,mixins:{apis:["offsetTop"]},create:function(t){var e=t.root,n=t.props;e.ref.imageGL=e.appendChildView(e.createChildView(Ta)),/markup/.test(e.query("GET_UTILS"))&&(e.ref.markup=e.appendChildView(e.createChildView(zo,{id:n.id,opacity:0,onSelect:function(t){e.dispatch("MARKUP_SELECT",{id:t})},onDrag:function(t,n,r,i,o){e.dispatch("MARKUP_ELEMENT_DRAG",{id:t,origin:n,offset:r,size:i,scale:o})},onResize:function(t,n,r,i,o){e.dispatch("MARKUP_ELEMENT_RESIZE",{id:t,corner:n,origin:r,offset:i,size:o})},onUpdate:function(t,n){e.dispatch("MARKUP_UPDATE",{style:t,value:n})},isMarkupUtil:function(t){var e=t;do{if("doka--markup-tools"===e.className)return!0}while(e=e.parentNode);return!1}}))),e.ref.isModal=/modal/.test(e.query("GET_STYLE_LAYOUT_MODE"))},write:zt({DID_PRESENT_IMAGE:function(t){t.root.ref.imageGL.colorOpacity=1}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.ref.imageGL,o=e.ref.markup,a=e.query("GET_CROP",n.id,r);if(a){var c=a.isDraft,u=a.cropRect,l=a.cropStatus,s=a.origin,f=a.translation,d=a.translationBand,h=a.scale,p=a.scaleBand,v=a.rotation,g=a.rotationBand,m=a.flip,y=a.colorMatrix,E=e.query("GET_ROOT"),_=e.query("GET_STAGE"),w=_.x,T=_.y;c&&(i.scale=null,i.zRotation=null,i.xTranslation=null,i.yTranslation=null,i.xOrigin=null,i.yOrigin=null),i.colorMatrix=y;var x=e.query("IS_ACTIVE_VIEW","crop"),R=e.query("IS_ACTIVE_VIEW","markup"),b=x?.75:.95,A=z({},u),I=1,C=x?1:5;if(e.query("IS_ACTIVE_VIEW","resize")){var S=l.image.width,O=l.image.height;I=null===S&&null===O?l.crop.width/u.width:null===S?O/u.height:S/u.width,I/=window.devicePixelRatio;var L=u.width*I,M=u.height*I;A.x=A.x+(.5*u.width-.5*L),A.y=A.y+(.5*u.height-.5*M),A.width=L,A.height=M}var P=e.ref.isModal?0:E.left,G=e.ref.isModal?0:E.top,k=e.ref.isModal?0:E.width-e.rect.element.width,D=e.ref.isModal?0:E.height-e.rect.element.height-n.offsetTop,U=(h+p)*I;i.isDraft=c,i.overlayOpacity=b,i.xOrigin=s.x,i.yOrigin=s.y,i.xTranslation=f.x+d.x+w,i.yTranslation=f.y+d.y+T,i.left=P,i.top=G+n.offsetTop,i.width=e.rect.element.width+k,i.height=e.rect.element.height+D+n.offsetTop,i.scale=U,i.xRotation=m.vertical?Math.PI:0,i.yRotation=m.horizontal?Math.PI:0,i.zRotation=v.main+v.sub+g,i.stage={x:_.x+P,y:_.y+G+n.offsetTop,width:_.width,height:_.height},i.overlay={x:A.x+w+P,y:A.y+T+G+n.offsetTop,width:A.width,height:A.height},i.outlineWidth=C,o&&(c&&(o.translateX=null,o.translateY=null,o.markupX=null,o.markupY=null,o.markupWidth=null,o.markupHeight=null),o.opacity=x?.3:1,o.stageOffsetX=w,o.stageOffsetY=T,o.markupX=A.x+w,o.markupY=A.y+T,o.markupWidth=A.width,o.markupHeight=A.height,o.allowInteraction=R)}})}),Ra=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"group",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["opacity"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Bt({ignoreRect:!0,name:t,mixins:{styles:["opacity"].concat(Y(e)),animations:z({opacity:{type:"spring",stiffness:.25,damping:.5,mass:5}},n)},create:function(t){var e=t.root,n=t.props;(n.controls||[]).map(function(t){var n=e.createChildView(t.view,t);t.didCreateView&&t.didCreateView(n),e.appendChildView(n)}),n.element&&e.element.appendChild(n.element)}})},ba=Bt({ignoreRect:!0,tag:"div",name:"dropdown-list",mixins:{styles:["translateY","opacity"],apis:["selectedValue","options","onSelect"],animations:{translateY:"spring",opacity:{type:"tween",duration:250}}},create:function(t){var e=t.root,n=t.props;e.element.setAttribute("role","list"),e.ref.handleClick=function(){return n.action&&n.action()},e.element.addEventListener("click",e.ref.handleClick),e.ref.activeOptions=null,e.ref.activeSelectedValue},write:function(t){var e=t.root,n=t.props;if(n.options!==e.ref.activeOptions&&(e.ref.activeOptions=n.options,e.childViews.forEach(function(t){return e.removeChildView(t)}),n.options.map(function(t){var r=e.createChildView(vo,z({},t,{action:function(){return n.onSelect(t.value)}}));return e.appendChildView(r)})),n.selectedValue!==e.ref.activeSelectedValue){e.ref.activeSelectedValue=n.selectedValue;var r=n.options.findIndex(function(t){return"object"===B(t.value)&&n.selectedValue?c()(t.value)===c()(n.selectedValue):t.value===n.selectedValue});e.childViews.forEach(function(t,e){t.element.setAttribute("aria-selected",e===r)})}},destroy:function(t){var e=t.root;e.element.removeEventListener("click",e.ref.handleClick)}}),Aa=Bt({ignoreRect:!0,tag:"div",name:"dropdown",mixins:{styles:["opacity"],animations:{opacity:"spring"},apis:["direction","selectedValue","options","onSelect"]},create:function(t){var e=t.root,n=t.props;e.ref.open=!1;var r=function(t){e.ref.open=t,e.dispatch("KICK")};e.ref.button=e.appendChildView(e.createChildView(vo,z({},n,{action:function(){r(!e.ref.open)}}))),e.ref.list=e.appendChildView(e.createChildView(ba,z({},n,{opacity:0,action:function(){r(!1)}}))),e.ref.handleBodyClick=function(t){e.element.contains(t.target)||r(!1)},e.element.addEventListener("focusin",function(t){t.target!==e.ref.button.element&&r(!0)}),e.element.addEventListener("focusout",function(t){e.element.contains(t.relatedTarget)||r(!1)}),document.body.addEventListener("click",e.ref.handleBodyClick)},destroy:function(t){var e=t.root;document.body.removeEventListener("click",e.ref.handleBodyClick)},write:function(t){var e=t.root,n=t.props;if(e.ref.list.opacity=e.ref.open?1:0,e.ref.list.selectedValue=n.selectedValue,e.ref.list.options=n.options,"up"===n.direction){var r=e.ref.list.rect.element.height;e.ref.list.translateY=(e.ref.open?-(r+5):-r)-e.rect.element.height}else e.ref.list.translateY=e.ref.open?0:-5}}),Ia=312,Ca=function(t,e){return Bt({name:t,ignoreRect:!0,create:e})},Sa=Bt({name:"crop-rotator-line",ignoreRect:!0,ignoreRectUpdate:!0,mixins:{styles:["translateX"],animations:{translateX:"spring"}},create:function(t){for(var e=t.root,n='<svg viewBox="-90 -5 180 10" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">',r=0;r<=180;r+=2){var i=r*(176/180)-90+2,o=r%10==0?.5:.2;n+='<circle fill="currentColor" cx="'.concat(i,'" cy="').concat(0,'" r="').concat(o,'"/>'),r%10==0&&(n+='<text fill="currentColor" x="'.concat(i+(i<0?-2.25:0===i?-.75:-1.5),'" y="').concat(3.5,'">').concat(-90+r,"&deg;</text>"))}n+="</svg>",e.element.innerHTML=n}}),Oa=Bt({name:"crop-rotator",ignoreRect:!0,mixins:{styles:["opacity","translateY"],animations:{opacity:{type:"spring",damping:.5,mass:5},translateY:"spring"},apis:["rotation","animate","setAllowInteraction"]},create:function(t){var e=t.root,n=t.props;e.element.setAttribute("tabindex",0);var r=document.createElement("button");r.innerHTML="<span>".concat(e.query("GET_LABEL_BUTTON_CROP_ROTATE_CENTER"),"</span>"),r.className="doka--crop-rotator-center",r.addEventListener("click",function(){e.dispatch("CROP_IMAGE_ROTATE_CENTER")}),e.appendChild(r);var i=null;e.appendChildView(e.createChildView(Ca("crop-rotator-line-mask",function(t){var e=t.root,n=t.props;i=e.appendChildView(e.createChildView(Sa,{translateX:Math.round(n.rotation*Ia)}))}),n)),e.ref.line=i;var o=document.createElement("div");o.className="doka--crop-rotator-bar",e.appendChild(o);var a=Math.PI/4,c=0;e.ref.dragger=Oo(o,function(){c=i.translateX/Ia,e.dispatch("CROP_IMAGE_ROTATE_GRAB")},function(t,n){var r=n.x/e.rect.element.width*(Math.PI/2),i=Se(c+r,-a,a);e.dispatch("CROP_IMAGE_ROTATE",{value:-i})},function(){e.dispatch("CROP_IMAGE_ROTATE_RELEASE")},{stopPropagation:!0}),n.setAllowInteraction=function(t){t?e.ref.dragger.enable():e.ref.dragger.disable()},e.ref.keyboard=Zo(e.element,function(){c=0},{left:function(){c+=Math.PI/128,e.dispatch("CROP_IMAGE_ROTATE_ADJUST",{value:c})},right:function(){c-=Math.PI/128,e.dispatch("CROP_IMAGE_ROTATE_ADJUST",{value:c})}},function(){},function(){}),e.ref.prevRotation},destroy:function(t){var e=t.root;e.ref.dragger.destroy(),e.ref.keyboard.destroy()},write:function(t){var e=t.root,n=t.props,r=t.timestamp,i=n.animate,o=n.rotation;if(e.ref.prevRotation!==o){e.ref.prevRotation=o,i||0===o||(e.ref.line.translateX=null);var a=0,c=e.query("GET_CROP",n.id,r);if(c&&c.interaction&&c.interaction.rotation){var u=pi(c.interaction.rotation).sub-o;a=.025*Math.sign(u)*Math.log10(1+Math.abs(u)/.025)}e.ref.line.translateX=Math.round((-o-a)*Ia)}}}),La=["nw","ne","se","sw"],Ma=function(t){return La[(La.indexOf(t)+2)%La.length]},Pa=["n","e","s","w"],Ga=function(t){return Pa[(Pa.indexOf(t)+2)%Pa.length]},ka=Ut()&&1===window.devicePixelRatio?function(t){return Math.round(t)}:function(t){return t},Da=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"crop-rect-focal-line",mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{translateX:"spring",translateY:"spring",scaleX:"spring",scaleY:"spring",opacity:"spring"}}}),Ua=function(t){return Bt({ignoreRect:!0,ignoreRectUpdate:!0,tag:"div",name:"crop-rect-edge-".concat(t),mixins:{styles:["translateX","translateY","scaleX","scaleY"],apis:["setAllowInteraction"]},create:function(e){var n=e.root,r=e.props;n.element.classList.add("doka--crop-rect-edge"),n.element.setAttribute("tabindex",0),n.element.setAttribute("role","button");var i=t,o=Ga(t);n.ref.dragger=Oo(n.element,function(){n.dispatch("CROP_RECT_DRAG_GRAB")},function(t,e){return n.dispatch("CROP_RECT_EDGE_DRAG",{offset:e,origin:i,anchor:o})},function(){return n.dispatch("CROP_RECT_DRAG_RELEASE")},{stopPropagation:!0,cancelOnMultiple:!0}),r.setAllowInteraction=function(t){t?n.ref.dragger.enable():n.ref.dragger.disable()},n.ref.keyboard=Zo(n.element,function(){return{x:0,y:0}},{up:function(t){t.y-=20},down:function(t){t.y+=20},left:function(t){t.x-=20},right:function(t){t.x+=20}},function(t){n.dispatch("CROP_RECT_DRAG_GRAB"),n.dispatch("CROP_RECT_EDGE_DRAG",{offset:t,origin:i,anchor:o})},function(){n.dispatch("CROP_RECT_DRAG_RELEASE")})},destroy:function(t){var e=t.root;e.ref.keyboard.destroy(),e.ref.dragger.destroy()}})},Na=function(t,e,n){return Bt({ignoreRect:!0,ignoreRectUpdate:!0,tag:"div",name:"crop-rect-corner-".concat(t),mixins:{styles:["translateX","translateY","scaleX","scaleY"],animations:{translateX:Lo,translateY:Lo,scaleX:{type:"spring",delay:n},scaleY:{type:"spring",delay:n},opacity:{type:"spring",delay:e}},apis:["setAllowInteraction"]},create:function(e){var n=e.root,r=e.props;n.element.classList.add("doka--crop-rect-corner"),n.element.setAttribute("role","button"),n.element.setAttribute("tabindex",-1);var i=t,o=Ma(t);n.ref.dragger=Oo(n.element,function(){n.dispatch("CROP_RECT_DRAG_GRAB")},function(t,e){n.dispatch("CROP_RECT_CORNER_DRAG",{offset:e,origin:i,anchor:o})},function(){n.dispatch("CROP_RECT_DRAG_RELEASE")},{stopPropagation:!0,cancelOnMultiple:!0}),r.setAllowInteraction=function(t){t?n.ref.dragger.enable():n.ref.dragger.disable()}},destroy:function(t){t.root.ref.dragger.destroy()}})},Va=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"crop-rect",mixins:{apis:["rectangle","draft","rotating","enabled"]},create:function(t){var e=t.root;e.ref.wasRotating=!1,La.forEach(function(t,n){var r=10*n,i=250+r+50,o=250+r;e.ref[t]=e.appendChildView(e.createChildView(Na(t,i,o),{opacity:0,scaleX:.5,scaleY:.5}))}),Pa.forEach(function(t){e.ref[t]=e.appendChildView(e.createChildView(Ua(t)))}),e.ref.lines=[];for(var n=0;n<10;n++)e.ref.lines.push(e.appendChildView(e.createChildView(Da,{opacity:0})));e.ref.animationDir=null,e.ref.previousRotating,e.ref.previousRect={},e.ref.previousEnabled,e.ref.previousDraft},write:function(t){var e=t.root,n=t.props,r=n.rectangle,i=n.draft,o=n.rotating,a=n.enabled;if(r&&(!Fe(r,e.ref.previousRect)||o!==e.ref.previousRotating||a!==e.ref.previousEnabled||i!==e.ref.previousDraft)){e.ref.previousRect=r,e.ref.previousRotating=o,e.ref.previousEnabled=a,e.ref.previousDraft=i;var c=e.ref,u=c.n,l=c.e,s=c.s,f=c.w,d=c.nw,h=c.ne,p=c.se,v=c.sw,g=c.lines,m=c.animationDir,y=r.x,E=r.y,_=r.x+r.width,w=r.y+r.height,T=w-E,x=_-y,R=Math.min(x,T);e.element.dataset.indicatorSize=R<80?"none":"default",Pa.forEach(function(t){return e.ref[t].setAllowInteraction(a)}),La.forEach(function(t){return e.ref[t].setAllowInteraction(a)});var b=e.query("IS_ACTIVE_VIEW","crop");if(b&&"in"!==m?(e.ref.animationDir="in",La.map(function(t){return e.ref[t]}).forEach(function(t){t.opacity=1,t.scaleX=1,t.scaleY=1})):b||"out"===m||(e.ref.animationDir="out",La.map(function(t){return e.ref[t]}).forEach(function(t){t.opacity=0,t.scaleX=.5,t.scaleY=.5})),Fa(i,d,y,E),Fa(i,h,_,E),Fa(i,p,_,w),Fa(i,v,y,w),Ba(i,u,y,E,x/100,1),Ba(i,l,_,E,1,T/100),Ba(i,s,y,w,x/100,1),Ba(i,f,y,E,1,T/100),o){e.ref.wasRotating=!0;var A=g.slice(0,5),I=1/A.length;A.forEach(function(t,e){Ba(i,t,y,E+T*(I+e*I),x/100,.01),t.opacity=.5});var C=g.slice(5);I=1/C.length,C.forEach(function(t,e){Ba(i,t,y+x*(I+e*I),E,.01,T/100),t.opacity=.5})}else if(i){e.ref.wasRotating=!1;var S=g[0],O=g[1],L=g[2],M=g[3];Ba(i,S,y,E+.333*T,x/100,.01),Ba(i,O,y,E+.666*T,x/100,.01),Ba(i,L,y+.333*x,E,.01,T/100),Ba(i,M,y+.666*x,E,.01,T/100),S.opacity=.5,O.opacity=.5,L.opacity=.5,M.opacity=.5}else{var P=g[0],G=g[1],k=g[2],D=g[3];!e.ref.wasRotating&&P.opacity>0&&(Ba(i,P,y,E+.333*T,x/100,.01),Ba(i,G,y,E+.666*T,x/100,.01),Ba(i,k,y+.333*x,E,.01,T/100),Ba(i,D,y+.666*x,E,.01,T/100)),g.forEach(function(t){return t.opacity=0})}}}}),Ba=function(t,e,n,r,i,o){t&&(e.translateX=null,e.translateY=null,e.scaleX=null,e.scaleY=null),e.translateX=ka(n),e.translateY=ka(r),e.scaleX=i,e.scaleY=o},Fa=function(t,e,n,r){t&&(e.translateX=null,e.translateY=null),e.translateX=ka(n),e.translateY=ka(r)},za=function(t,e){if(!/svg/.test(t.namespaceURI)||"innerHTML"in t)t.innerHTML=e;else{var n=document.createElement("div");n.innerHTML="<svg>"+e+"</svg>";for(var r=n.firstChild;r.firstChild;)t.appendChild(r.firstChild)}},Wa=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"crop-mask",tag:"svg",mixins:{styles:["opacity","translateX","translateY"],animations:{scale:Lo,maskWidth:Lo,maskHeight:Lo,translateX:Lo,translateY:Lo,opacity:{type:"tween",delay:0,duration:1e3}},apis:["rectangle","animate","maskWidth","maskHeight","scale"]},create:function(t){var e=t.root;e.customWriter=e.query("GET_CROP_MASK")(e.element,za)||function(){}},didWriteView:function(t){var e=t.root,n=t.props,r=n.maskWidth,i=n.maskHeight,o=n.scale;if(r&&i){e.element.setAttribute("width",ka(r)),e.element.setAttribute("height",ka(i));var a=e.query("GET_CROP_MASK_INSET");e.customWriter({x:o*a,y:o*a,width:r-o*a*2,height:i-o*a*2},{width:r,height:i})}}}),qa=function(t,e){var n=t.childNodes[0];n?e!==n.nodeValue&&(n.nodeValue=e):(n=document.createTextNode(e),t.appendChild(n))},Ya={type:"spring",stiffness:.25,damping:.1,mass:1},Ha=Bt({ignoreRect:!0,name:"crop-size",mixins:{styles:["translateX","translateY","opacity"],animations:{translateX:"spring",translateY:"spring",opacity:"spring",sizeWidth:Ya,sizeHeight:Ya},apis:["sizeWidth","sizeHeight"],listeners:!0},create:function(t){var e=t.root,n=st("span");n.className="doka--crop-size-info doka--crop-resize-percentage",e.ref.resizePercentage=n,e.appendChild(n);var r=st("span");r.className="doka--crop-size-info";var i=st("span");i.className="doka--crop-size-multiply",i.textContent="×";var o=st("span"),a=st("span");e.ref.outputWidth=o,e.ref.outputHeight=a,r.appendChild(o),r.appendChild(i),r.appendChild(a),e.appendChild(r),e.ref.previousValues={width:0,height:0,percentage:0}},write:function(t){var e=t.root,n=t.props,r=t.timestamp;if(!(e.opacity<=0)){var i=e.query("GET_CROP",n.id,r);if(i){var o=i.cropStatus,a=i.isDraft,c=e.ref,u=c.outputWidth,l=c.outputHeight,s=c.resizePercentage,f=c.previousValues,d=o.image,h=o.crop,p=o.currentWidth,v=o.currentHeight,g=d.width?Math.round(d.width/h.width*100):0;a&&(e.sizeWidth=null,e.sizeHeight=null),e.sizeWidth=p,e.sizeHeight=v;var m=Math.round(e.sizeWidth),y=Math.round(e.sizeHeight);m!==f.width&&(qa(u,m),f.width=m),y!==f.height&&(qa(l,y),f.height=y),g!==f.percentage&&(d.width?qa(s,"".concat(g,"%")):qa(s,""),f.percentage=g)}}}}),ja=function(t,e){return Bt({ignoreRect:!0,name:t,mixins:e,create:function(t){var e=t.root,n=t.props;n.className&&e.element.classList.add(n.className),n.controls.map(function(t){var n=e.createChildView(t.view,t);t.didCreateView&&t.didCreateView(n),e.appendChildView(n)})}})},Za=function(t){return JSON.parse(localStorage.getItem(t)||"{}")},Xa=function(t,e,n){var r=Za(t);return r[e]=n,localStorage.setItem(t,c()(r)),n},Ka=function(t,e,n){var r=Za(t);return void 0===r[e]?n:r[e]},$a=function(){return window.matchMedia("(pointer: fine) and (hover: hover)").matches},Qa=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"instructions-bubble",mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:400}},apis:["seen"]},create:function(t){var e=t.root,n=t.props;return e.element.innerHTML=(n.iconBefore||"")+n.text},write:function(t){var e=t.root;t.props.seen&&(e.opacity=0)}}),Ja={type:"spring",stiffness:.4,damping:.65,mass:7},tc=Bt({name:"crop-subject",ignoreRect:!0,mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:250},translateX:Ja,translateY:Ja}},create:function(t){var e=t.root,n=t.props;e.opacity=1,e.ref.timestampOffset=null,e.query("GET_CROP_ALLOW_INSTRUCTION_ZOOM")&&$a()&&(Ka(e.query("GET_STORAGE_NAME"),"instruction_zoom_shown",!1)||(e.ref.instructions=e.appendChildView(e.createChildView(Qa,{opacity:0,seen:!1,text:e.query("GET_LABEL_CROP_INSTRUCTION_ZOOM"),iconBefore:po('<rect stroke-width="1.5" fill="none" stroke="currentColor" x="5" y="1" width="14" height="22" rx="7" ry="7"></rect><circle fill="currentColor" stroke="none" cx="12" cy="8" r="2"></circle>')})))),e.query("GET_CROP_MASK")&&(e.ref.maskView=e.appendChildView(e.createChildView(Wa))),e.query("GET_CROP_ALLOW_RESIZE_RECT")&&(e.ref.cropView=e.appendChildView(e.createChildView(Va))),e.query("GET_CROP_SHOW_SIZE")&&(e.ref.cropSize=e.appendChildView(e.createChildView(Ha,{id:n.id,opacity:1,scaleX:1,scaleY:1,translateX:null}))),e.query("GET_CROP_ZOOM_TIMEOUT")||(e.ref.btnZoom=e.appendChildView(e.createChildView(ja("zoom-wrapper",{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:250}}}),{opacity:0,controls:[{view:vo,label:e.query("GET_LABEL_BUTTON_CROP_ZOOM"),name:"zoom",icon:po('<g fill="currentColor" fill-rule="nonzero"><path d="M12.5 19a6.5 6.5 0 1 1 0-13 6.5 6.5 0 0 1 0 13zm0-2a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"/><path d="M15.765 17.18a1 1 0 1 1 1.415-1.415l3.527 3.528a1 1 0 0 1-1.414 1.414l-3.528-3.527z"/></g>',26),action:function(){return e.dispatch("CROP_ZOOM")}}]})))},write:zt({CROP_IMAGE_RESIZE_MULTIPLY:function(t){var e=t.root,n=e.ref.instructions;n&&!n.seen&&(n.seen=!0,Xa(e.query("GET_STORAGE_NAME"),"instruction_zoom_shown",!0))},CROP_RECT_DRAG_RELEASE:function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.ref.btnZoom;if(i){var o=e.query("GET_CROP",n.id,r).cropRect,a=o.x+.5*o.width,c=o.y+.5*o.height;i.translateX=a,i.translateY=c}}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.ref,o=i.cropView,a=i.maskView,c=i.btnZoom,u=i.cropSize,l=i.instructions;if(!e.query("IS_ACTIVE_VIEW","crop")&&o)return o.enabled=!1,e.ref.timestampOffset=null,void(u&&(u.opacity=0));e.ref.timestampOffset||(e.ref.timestampOffset=r);var s=e.query("GET_CROP",n.id,r);if(s){var f=s.cropRect,d=s.isRotating,h=s.isDraft,p=s.scale,v=e.query("GET_STAGE");if(e.translateX=v.x-e.rect.element.left,e.translateY=v.y-e.rect.element.top,o&&(o.draft=h,o.rotating=d,o.rectangle=f,o.enabled=!0),u){u.opacity=1,h&&(u.translateX=null,u.translateY=null);var g=ec(e.rect.element,u.rect.element,f);u.translateX=h?g.x:ka(g.x),u.translateY=h?g.y:ka(g.y)}if(a&&(h&&(a.translateX=null,a.translateY=null,a.maskWidth=null,a.maskHeight=null),a.translateX=ka(f.x),a.translateY=ka(f.y),a.maskWidth=f.width,a.maskHeight=f.height,a.scale=p),s.canRecenter)l&&(l.opacity=0),c&&(c.opacity=s.isDraft?0:1);else if(c&&(c.opacity=0),l&&!l.seen&&!s.isDraft){var m=f.x+.5*f.width,y=f.y+.5*f.height;l.translateX=Math.round(m-.5*l.rect.element.width),l.translateY=Math.round(y-.5*l.rect.element.height),r-e.ref.timestampOffset>2e3&&(l.opacity=1)}}})}),ec=function(t,e,n){var r=n.x,i=n.x+n.width,o=n.y+n.height,a=i-e.width-16,c=o-e.height-16;return e.width>n.width-32&&(a=r+(.5*n.width-.5*e.width),(c=o+16)>t.height-e.height&&(c=o-e.height-16)),{x:a=Math.max(0,Math.min(a,t.width-e.width)),y:c}},nc=function(){return performance.now()},rc=function(t,e){var n=null,r=null;return function(){var i=arguments;if(!r)return t.apply(null,w()(arguments)),void(r=nc());clearTimeout(n),n=setTimeout(function(){nc()-r>=e&&(t.apply(null,w()(i)),r=nc())},e-(nc()-r))}},ic=function(t,e){for(;1===t.nodeType&&!e(t);)t=t.parentNode;return 1===t.nodeType?t:null},oc=function(t,e){var n=ic(e,function(t){return t.classList.contains("doka--root")});return!!n&&n.contains(t)},ac=function(t){var e=t.root,n=t.props,r=t.action.position,i=n.pivotPoint,o=e.ref,a=o.indicatorA,c=o.indicatorB,u=i.x-r.x,l=i.y-r.y,s={x:i.x+u,y:i.y+l},f={x:i.x-u,y:i.y-l};a.style.cssText="transform: translate3d(".concat(s.x,"px, ").concat(s.y,"px, 0)"),c.style.cssText="transform: translate3d(".concat(f.x,"px, ").concat(f.y,"px, 0)")},cc=function(t){return{x:t.pageX,y:t.pageY}},uc=Bt({ignoreRect:!0,ignoreRectUpdate:!0,name:"crop-resizer",mixins:{apis:["pivotPoint","scrollRect"]},create:function(t){var e=t.root,n=t.props;e.ref.isActive=!1,e.ref.isCropping=!1,e.ref.indicatorA=document.createElement("div"),e.appendChild(e.ref.indicatorA),e.ref.indicatorB=document.createElement("div"),e.appendChild(e.ref.indicatorB);var r=e.query("GET_CROP_RESIZE_KEY_CODES");e.ref.hasEnabledResizeModifier=r.length>0;var i={origin:{x:null,y:null},position:{x:null,y:null},selecting:!1,enabled:!1,scrollY:0,offsetX:0,offsetY:0},o=nc();e.ref.state=i;var a=Ao(),c=0,u=!1;e.ref.resizeStart=function(t){if(e.ref.isActive&&(0===a.count()&&(u=!1),a.push(t),Io(document.documentElement,"up",e.ref.resizeEnd),oc(e.element,t.target)&&a.multiple())){t.stopPropagation(),t.preventDefault();var n=a.active(),r=cc(n[0]),i=cc(n[1]);c=De(r,i),Io(document.documentElement,"move",e.ref.resizeMove),u=!0}},e.ref.resizeMove=function(t){if(e.ref.isActive&&u&&(t.preventDefault(),2===a.count())){a.update(t);var n=a.active(),r=cc(n[0]),i=cc(n[1]),o=(De(r,i)-c)/c;e.dispatch("CROP_IMAGE_RESIZE",{value:o})}},e.ref.resizeEnd=function(t){if(e.ref.isActive){a.pop(t);var n=0===a.count();n&&(Co(document.documentElement,"move",e.ref.resizeMove),Co(document.documentElement,"up",e.ref.resizeEnd)),u&&(t.preventDefault(),n&&e.dispatch("CROP_IMAGE_RESIZE_RELEASE"))}},Io(document.documentElement,"down",e.ref.resizeStart);var l=performance.now(),s=0,f=1,d=rc(function(t){if(!e.ref.isCropping){var n=Math.sign(t.wheelDelta||t.deltaY),r=nc(),i=r-l;l=r,(i>750||s!==n)&&(f=1,s=n),f+=.05*n,e.dispatch("CROP_IMAGE_RESIZE_MULTIPLY",{value:Math.max(.1,f)}),e.dispatch("CROP_IMAGE_RESIZE_RELEASE")}},100);e.ref.wheel=function(t){if(e.ref.isActive&&oc(e.element,t.target)){if(n.scrollRect){var r=n.scrollRect,i=e.query("GET_ROOT"),o=cc(t),a={x:o.x-i.leftScroll,y:o.y-i.topScroll};if(a.x<r.x||a.x>r.x+r.width||a.y<r.y||a.y>r.y+r.height)return}t.preventDefault(),d(t)}},document.addEventListener("wheel",e.ref.wheel,{passive:!1}),e.ref.hasEnabledResizeModifier&&(e.ref.move=function(t){if(e.ref.isActive&&!e.ref.isCropping&&(i.position.x=t.pageX-e.ref.state.offsetX,i.position.y=t.pageY-e.ref.state.scrollY-e.ref.state.offsetY,i.enabled))if(oc(e.element,t.target)){"idle"===e.element.dataset.state&&e.dispatch("RESIZER_SHOW",{position:z({},i.position)}),t.preventDefault(),e.dispatch("RESIZER_MOVE",{position:z({},i.position)});var r=n.pivotPoint,a=r.x-i.position.x,u=r.y-i.position.y,l={x:r.x+a,y:r.y+u},s=z({},i.position);if(i.selecting){var f=(De(l,s)-c)/c,d=performance.now();d-o>25&&(o=d,e.dispatch("CROP_IMAGE_RESIZE",{value:f}))}}else e.dispatch("RESIZER_CANCEL")},e.ref.select=function(t){if(e.ref.isActive&&oc(e.element,t.target)){var r=n.pivotPoint,o=r.x-i.position.x,a=r.y-i.position.y,u={x:r.x+o,y:r.y+a},l=i.position;c=De(u,l),i.selecting=!0,i.origin.x=t.pageX,i.origin.y=t.pageY,e.dispatch("CROP_IMAGE_RESIZE_GRAB")}},e.ref.confirm=function(t){e.ref.isActive&&oc(e.element,t.target)&&(i.selecting=!1,e.dispatch("CROP_IMAGE_RESIZE_RELEASE"))},e.ref.blur=function(){e.ref.isActive&&(i.selecting=!1,i.enabled=!1,document.removeEventListener("mousedown",e.ref.select),document.removeEventListener("mouseup",e.ref.confirm),e.dispatch("RESIZER_CANCEL"))},window.addEventListener("blur",e.ref.blur),document.addEventListener("mousemove",e.ref.move),e.ref.keyDown=function(t){e.ref.isActive&&r.includes(t.keyCode)&&i.position&&(i.enabled=!0,document.addEventListener("mousedown",e.ref.select),document.addEventListener("mouseup",e.ref.confirm),e.dispatch("RESIZER_SHOW",{position:z({},i.position)}))},e.ref.keyUp=function(t){e.ref.isActive&&r.includes(t.keyCode)&&(i.enabled=!1,document.removeEventListener("mousedown",e.ref.select),document.removeEventListener("mouseup",e.ref.confirm),e.dispatch("RESIZER_CANCEL"))},document.body.addEventListener("keydown",e.ref.keyDown),document.body.addEventListener("keyup",e.ref.keyUp))},destroy:function(t){var e=t.root;document.removeEventListener("touchmove",e.ref.resizeMove),document.removeEventListener("touchend",e.ref.resizeEnd),document.removeEventListener("touchstart",e.ref.resizeStart),document.removeEventListener("wheel",e.ref.wheel),document.removeEventListener("mousedown",e.ref.select),document.removeEventListener("mouseup",e.ref.confirm),e.ref.hasEnabledResizeModifier&&(document.removeEventListener("mousemove",e.ref.move),document.body.removeEventListener("keydown",e.ref.keyDown),document.body.removeEventListener("keyup",e.ref.keyUp),window.removeEventListener("blur",e.ref.blur))},read:function(t){var e=t.root;e.ref.state.scrollY=window.scrollY;var n=e.element.getBoundingClientRect();e.ref.state.offsetX=n.x,e.ref.state.offsetY=n.y},write:zt({CROP_RECT_DRAG_GRAB:function(t){t.root.ref.isCropping=!0},CROP_RECT_DRAG_RELEASE:function(t){t.root.ref.isCropping=!1},SHOW_VIEW:function(t){var e=t.root,n=t.action;e.ref.isActive="crop"===n.id},RESIZER_SHOW:function(t){var e=t.root,n=t.props,r=t.action;e.element.dataset.state="multi-touch",ac({root:e,props:n,action:r})},RESIZER_CANCEL:function(t){t.root.element.dataset.state="idle"},RESIZER_MOVE:ac})}),lc=function(t,e){return t.style.opacity=e},sc=function(t,e){var n=w()(t.element.querySelectorAll(".doka--icon-crop-limit rect"));n.length&&(lc(n[0],e?.3:0),lc(n[1],e?1:0),lc(n[2],e?0:.3),lc(n[3],e?0:1))},fc=function(t,e){var n=t.element.querySelectorAll(".doka--icon-aspect-ratio rect");if(n.length){if(!e)return lc(n[0],.2),lc(n[1],.3),void lc(n[2],.4);lc(n[0],e>1?1:.3),lc(n[1],1===e?.85:.5),lc(n[2],e<1?1:.3)}},dc=function(t,e){w()(t.element.querySelectorAll(".doka--icon-turn rect")).forEach(function(t){e>1&&(t.setAttribute("x",t.previousElementSibling?5:4),t.setAttribute("width",9)),e<1&&(t.setAttribute("y",11),t.setAttribute("height",10))})},hc=function(t){var e,n;t>1?(n=14,e=Math.round(n/t)):(e=14,n=Math.round(e*t));var r=Math.round(.5*(23-e)),i=Math.round(.5*(23-n));return'<svg width="23" height="23" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><g fill="currentColor"><rect x="'.concat(r,'" y="').concat(i,'" width="').concat(e,'" height="').concat(n,'" rx="2.5"/></g></svg>')},pc=Bt({name:"crop",ignoreRect:!0,mixins:{apis:["viewId","stagePosition","hidden","offsetTop"]},create:function(t){var e=t.root,n=t.props;n.viewId="crop",n.hidden=!1,e.ref.isHiding=!1;var r=[];e.query("GET_CROP_ALLOW_IMAGE_TURN_LEFT")&&r.push({view:vo,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_ROTATE_LEFT"),icon:po('<g transform="translate(3 2)" fill="currentColor" fill-rule="evenodd" class="doka--icon-turn"><rect y="9" width="12" height="12" rx="1"/><path d="M9.823 5H11a5 5 0 0 1 5 5 1 1 0 0 0 2 0 7 7 0 0 0-7-7H9.626l.747-.747A1 1 0 0 0 8.958.84L6.603 3.194a1 1 0 0 0 0 1.415l2.355 2.355a1 1 0 0 0 1.415-1.414L9.823 5z" fill-rule="nonzero" /></g>',26),action:function(){return e.dispatch("CROP_IMAGE_ROTATE_LEFT")}}),e.query("GET_CROP_ALLOW_IMAGE_TURN_RIGHT")&&r.push({view:vo,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_ROTATE_RIGHT"),icon:po('<g transform="translate(5 2)" fill="currentColor" fill-rule="evenodd" class="doka--icon-turn"><path d="M8.177 5H7a5 5 0 0 0-5 5 1 1 0 0 1-2 0 7 7 0 0 1 7-7h1.374l-.747-.747A1 1 0 0 1 9.042.84l2.355 2.355a1 1 0 0 1 0 1.415L9.042 6.964A1 1 0 0 1 7.627 5.55l.55-.55z" fill-rule="nonzero"/><rect x="6" y="9" width="12" height="12" rx="1"/></g>',26),action:function(){return e.dispatch("CROP_IMAGE_ROTATE_RIGHT")}}),e.query("GET_CROP_ALLOW_IMAGE_FLIP_HORIZONTAL")&&r.push({view:vo,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_FLIP_HORIZONTAL"),icon:po('<g fill="currentColor" fill-rule="evenodd"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',26),action:function(){return e.dispatch("CROP_IMAGE_FLIP_HORIZONTAL")}}),e.query("GET_CROP_ALLOW_IMAGE_FLIP_VERTICAL")&&r.push({view:vo,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_FLIP_VERTICAL"),icon:po('<g fill="currentColor" fill-rule="evenodd"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',26),action:function(){return e.dispatch("CROP_IMAGE_FLIP_VERTICAL")}});var i=e.query("GET_CROP_ASPECT_RATIO_OPTIONS");i&&i.length&&r.push({view:Aa,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_ASPECT_RATIO"),icon:po('<g class="doka--icon-aspect-ratio" fill="currentColor" fill-rule="evenodd"><rect x="2" y="4" opacity=".3" width="10" height="18" rx="1"/><rect opacity=".5" x="4" y="8" width="14" height="14" rx="1"/><rect x="6" y="12" width="17" height="10" rx="1"/></g>',26),options:null,onSelect:function(t){t.width&&t.height?e.dispatch("RESIZE_SET_OUTPUT_SIZE",{width:t.width,height:t.height}):(e.query("GET_CROP_ASPECT_RATIO_OPTIONS").find(function(t){return t.value&&t.value.width||t.value.height})&&e.dispatch("RESIZE_SET_OUTPUT_SIZE",{width:null,height:null}),e.dispatch("CROP_SET_ASPECT_RATIO",{value:t.aspectRatio}))},didCreateView:function(t){e.ref.aspectRatioDropdown=t}}),e.query("GET_CROP_ALLOW_TOGGLE_LIMIT")&&r.push({view:Aa,name:"tool",label:e.query("GET_LABEL_BUTTON_CROP_TOGGLE_LIMIT"),icon:po('<g class="doka--icon-crop-limit" fill="currentColor" fill-rule="evenodd">\n                    <rect x="2" y="3" width="20" height="20" rx="1"/>\n                    <rect x="7" y="8" width="10" height="10" rx="1"/>\n                    <rect x="4" y="8" width="14" height="14" rx="1"/>\n                    <rect x="12" y="4" width="10" height="10" rx="1"/>\n                </g>',26),options:[{value:!0,label:e.query("GET_LABEL_BUTTON_CROP_TOGGLE_LIMIT_ENABLE"),icon:'<svg width="23" height="23" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><g fill="currentColor"><rect x="3" y="3" width="17" height="17" rx="2.5" opacity=".3"/><rect x="7" y="7" width="9" height="9" rx="2.5"/></g></svg>'},{value:!1,label:e.query("GET_LABEL_BUTTON_CROP_TOGGLE_LIMIT_DISABLE"),icon:'<svg width="23" height="23" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><g fill="currentColor"><rect x="3" y="6" width="13" height="13" rx="2.5" opacity=".3"/><rect x="10" y="3" width="9" height="9" rx="2.5"/></g></svg>'}],onSelect:function(t){e.dispatch("CROP_SET_LIMIT",{value:t})},didCreateView:function(t){e.ref.cropToggleLimitDropdown=t}}),e.ref.menu=e.appendChildView(e.createChildView(Ra("toolbar",["opacity"],{opacity:{type:"spring",mass:15,delay:50}}),{opacity:0,controls:r})),e.ref.menuItemsRequiredWidth=null,e.ref.subject=e.appendChildView(e.createChildView(tc,z({},n))),e.query("GET_CROP_ALLOW_ROTATE")&&(e.ref.rotator=e.appendChildView(e.createChildView(Oa,{rotation:0,opacity:0,translateY:20,id:n.id}))),e.ref.resizer=e.appendChildView(e.createChildView(uc,{pivotPoint:{x:0,y:0}})),e.ref.updateControls=function(){var t=e.query("GET_IMAGE");if(dc(e,t.height/t.width),e.ref.cropToggleLimitDropdown&&(e.ref.isLimitedToImageBounds=e.query("GET_CROP_LIMIT_TO_IMAGE_BOUNDS"),sc(e,e.ref.isLimitedToImageBounds),e.ref.cropToggleLimitDropdown.selectedValue=e.ref.isLimitedToImageBounds),e.ref.aspectRatioDropdown){var n=e.query("GET_MIN_IMAGE_SIZE"),r=i.filter(function(e){if(!e.value.aspectRatio)return!0;if(e.value.aspectRatio<1){if(t.naturalWidth*e.value.aspectRatio<n.height)return!1}else if(t.naturalHeight/e.value.aspectRatio<n.width)return!1;return!0});e.ref.aspectRatioDropdown.options=r.map(function(t){return z({},t,{icon:hc(t.value.aspectRatio)})})}},e.ref.isModal=/modal|fullscreen/.test(e.query("GET_STYLE_LAYOUT_MODE"))},read:function(t){var e=t.root,n=t.props;if(n.hidden)e.ref.menuItemsRequiredWidth=null;else{var r=e.rect;if(0!==r.element.width&&0!==r.element.height){if(null===e.ref.menuItemsRequiredWidth){var i=e.ref.menu.childViews.reduce(function(t,e){return t+e.rect.outer.width},0);e.ref.menuItemsRequiredWidth=0===i?null:i}var o=e.ref.subject.rect.element,a=o.left,c=o.top,u=o.width,l=o.height;n.stagePosition={x:a,y:c,width:u,height:l}}}},shouldUpdateChildViews:function(t){var e=t.props,n=t.actions;return!e.hidden||e.hidden&&n&&n.length},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.action,r=t.props,i=e.ref,o=i.menu,a=i.rotator,c=i.subject;r.viewId===n.id?(c.opacity=1,o.opacity=1,a&&(a.opacity=1,a.translateY=0),r.hidden=!1,e.ref.isHiding=!1,e.ref.updateControls()):(c.opacity=0,o.opacity=0,a&&(a.opacity=0,a.translateY=20),e.ref.isHiding=!0)},UNLOAD_IMAGE:function(t){var e=t.root.ref,n=e.menu,r=e.rotator;n.opacity=0,r&&(r.opacity=0,r.translateY=20)},DID_PRESENT_IMAGE:function(t){var e=t.root,n=e.ref,r=n.menu,i=n.rotator;r.opacity=1,i&&(i.opacity=1,i.translateY=0),e.ref.updateControls()}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.ref,o=i.resizer,a=i.subject,c=i.menu,u=i.rotator,l=i.isHiding,s=i.cropToggleLimitDropdown,f=i.aspectRatioDropdown,d=n.hidden,h=0===a.opacity&&0===c.opacity&&(!u||u&&0===u.opacity);if(!d&&l&&h&&(e.ref.isHiding=!1,n.hidden=!0),!n.hidden){var p=e.query("GET_CROP",n.id,r);if(p){if(f){var v=e.query("GET_ACTIVE_CROP_ASPECT_RATIO"),g=e.query("GET_SIZE"),m=f.selectedValue;m?(m.aspectRatio!==v&&fc(e,v),m.aspectRatio===v&&m.width===g.width&&m.height===g.height||(f.selectedValue={aspectRatio:v,width:g.width,height:g.height})):(f.selectedValue={aspectRatio:v,width:g.width,height:g.height},fc(e,v))}if(s&&e.ref.isLimitedToImageBounds!==p.isLimitedToImageBounds&&(e.ref.isLimitedToImageBounds=p.isLimitedToImageBounds,sc(e,p.isLimitedToImageBounds),s.selectedValue=p.isLimitedToImageBounds),o.pivotPoint={x:.5*o.rect.element.width,y:.5*o.rect.element.height},u&&(u.animate=!p.isDraft,u.rotation=p.rotation.sub,u.setAllowInteraction(e.query("IS_ACTIVE_VIEW","crop"))),c.element.dataset.layout=e.ref.menuItemsRequiredWidth>e.ref.menu.rect.element.width?"compact":"spacious",e.query("GET_CROP_RESIZE_SCROLL_RECT_ONLY")){var y=e.query("GET_STAGE"),E=y.x,_=y.y,w=e.query("GET_ROOT"),T=e.ref.isModal?w.left:0,x=e.ref.isModal?w.top:0;o.scrollRect={x:T+E+p.cropRect.x,y:x+_+p.cropRect.y+n.offsetTop,width:p.cropRect.width,height:p.cropRect.height}}}}})}),vc=Bt({name:"size-input",mixins:{listeners:!0,apis:["id","value","placeholder","getValue","setValue","setPlaceholder","hasFocus","onChange"]},create:function(t){var e=t.root,n=t.props,r=n.id,i=n.min,o=n.max,a=n.value,c=n.placeholder,u=n.onChange,l=void 0===u?function(){}:u,s=n.onBlur,f=void 0===s?function(){}:s,d="doka--".concat(r,"-").concat(ye()),h=st("input",{type:"number",step:1,id:d,min:i,max:o,value:a,placeholder:c}),p=h.getAttribute("max").length,g=st("label",{for:d});g.textContent=n.label;var m=function(t,e,n){return Kt(t)?((t=t.replace(/[^0-9]/g,"")).length>p&&(t=t.slice(0,p)),t=v()(t,10)):t=Math.round(t),isNaN(t)?null:Se(t,e,n)},y=function(t){return t.length?v()(h.value,10):null};e.ref.handleInput=function(){h.value=m(h.value,1,o),l(y(h.value))},e.ref.handleBlur=function(){h.value=m(h.value,i,o),f(y(h.value))},h.addEventListener("input",e.ref.handleInput),h.addEventListener("blur",e.ref.handleBlur),e.appendChild(h),e.appendChild(g),e.ref.input=h,n.hasFocus=function(){return h===document.activeElement},n.getValue=function(){return y(h.value)},n.setValue=function(t){return h.value=t?m(t,1,999999):null},n.setPlaceholder=function(t){return h.placeholder=t}},destroy:function(t){var e=t.root;e.ref.input.removeEventListener("input",e.ref.handleInput),e.ref.input.removeEventListener("blur",e.ref.handleBlur)}}),gc=Bt({name:"checkable",tag:"span",mixins:{listeners:!0,apis:["id","checked","onChange","onSetValue","setValue","getValue"]},create:function(t){var e=t.root,n=t.props,r=n.id,i=n.checked,o=n.onChange,a=void 0===o?function(){}:o,c=n.onSetValue,u=void 0===c?function(){}:c,l="doka--".concat(r,"-").concat(ye()),s=st("input",{type:"checkbox",value:1,id:l});s.checked=i,e.ref.input=s;var f=st("label",{for:l});f.innerHTML=n.label,e.appendChild(s),e.appendChild(f),e.ref.handleChange=function(){u(s.checked),a(s.checked)},s.addEventListener("change",e.ref.handleChange),n.getValue=function(){return s.checked},n.setValue=function(t){s.checked=t,u(s.checked)},setTimeout(function(){u(s.checked)},0)},destroy:function(t){var e=t.root;e.ref.input.removeEventListener("change",e.ref.handleChange)}}),mc=null,yc=function(){return null===mc&&(mc=/Android/i.test(navigator.userAgent)),mc},Ec=Bt({ignoreRect:!0,name:"resize-form",tag:"form",mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:15,delay:150}}},create:function(t){var e=t.root;e.element.setAttribute("novalidate","novalidate"),e.element.setAttribute("action","#"),e.ref.shouldBlurKeyboard=xe()||yc();var n=e.query("GET_SIZE_MAX"),r=e.query("GET_SIZE_MIN"),i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.axisLock,o=void 0===i?"none":i,a=t.enforceLimits,c=void 0!==a&&a,u=e.ref,l=u.inputImageWidth,s=u.inputImageHeight,f=u.buttonConfirm,d=e.query("GET_SIZE_ASPECT_RATIO_LOCK"),h=e.query("GET_CROP_RECTANGLE_ASPECT_RATIO"),p={width:l.getValue(),height:s.getValue()},v=_n(p,c?r:{width:1,height:1},c?n:{width:999999,height:999999},d?h:null,o);if(d)"width"===o?s.setValue(v.width/h):"height"===o?l.setValue(v.height*h):(l.setValue(v.width||v.height*h),s.setValue(v.height||v.width/h));else if(v.width&&!v.height){var g=Math.round(v.width/h),m=_n({width:v.width,height:g},c?r:{width:1,height:1},c?n:{width:999999,height:999999},h,o);c&&l.setValue(Math.round(m.width)),s.setPlaceholder(Math.round(m.height))}else if(v.height&&!v.width){var y=Math.round(v.height*h);l.setPlaceholder(y)}var E=e.query("GET_SIZE_INPUT"),_=E.width,w=E.height,T=mt(_)?Math.round(_):null,x=mt(w)?Math.round(w):null,R=l.getValue(),b=s.getValue(),A=R!==T||b!==x;return f.opacity=A?1:0,e.dispatch("KICK"),{width:l.getValue(),height:s.getValue()}},o=e;e.appendChildView(e.createChildView(_c("Image size",function(t){var e=t.root,a=e.query("GET_SIZE"),c=e.appendChildView(e.createChildView(vc,{id:"image-width",label:e.query("GET_LABEL_RESIZE_WIDTH"),value:mt(a.width)?Math.round(a.width):null,min:r.width,max:n.width,placeholder:0,onChange:function(){return i({axisLock:"width"})},onBlur:function(){return i({enforceLimits:!1})}})),u=e.appendChildView(e.createChildView(gc,{id:"aspect-ratio-lock",label:po('<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="1.5" stroke-linecap="round" class="doka--aspect-ratio-lock-ring" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V14"/><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>'),checked:e.query("GET_SIZE_ASPECT_RATIO_LOCK"),onSetValue:function(t){var e=t?0:-3;u.element.querySelector(".doka--aspect-ratio-lock-ring").setAttribute("transform","translate(0 ".concat(e,")"))},onChange:function(t){e.dispatch("RESIZE_SET_OUTPUT_SIZE_ASPECT_RATIO_LOCK",{value:t}),i()}})),l=e.appendChildView(e.createChildView(vc,{id:"image-height",label:e.query("GET_LABEL_RESIZE_HEIGHT"),value:mt(a.height)?Math.round(a.height):null,min:r.height,max:n.height,placeholder:0,onChange:function(){return i({axisLock:"height"})},onBlur:function(){return i({enforceLimits:!1})}}));o.ref.aspectRatioLock=u,o.ref.inputImageWidth=c,o.ref.inputImageHeight=l}))),e.ref.buttonConfirm=e.appendChildView(e.createChildView(vo,{name:"app action-confirm icon-only",label:e.query("GET_LABEL_RESIZE_APPLY_CHANGES"),action:function(){},opacity:0,icon:po('<polyline fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="20 6 9 17 4 12"></polyline>'),type:"submit"})),e.ref.confirmForm=function(t){var n=i({enforceLimits:!0});t.preventDefault();var r=e.ref,o=r.shouldBlurKeyboard,a=r.buttonConfirm;o&&(document.activeElement.blur(),a.element.focus()),a.opacity=0,e.dispatch("RESIZE_SET_OUTPUT_SIZE",n)},e.element.addEventListener("submit",e.ref.confirmForm)},destroy:function(t){var e=t.root;e.element.removeEventListener("submit",e.ref.confirmForm)},write:zt({EDIT_RESET:function(t){var e=t.root,n=e.query("GET_SIZE"),r=e.ref,i=r.inputImageWidth,o=r.inputImageHeight,a=r.aspectRatioLock,c=r.buttonConfirm;i.setValue(n.width),o.setValue(n.height),a.setValue(e.query("GET_SIZE_ASPECT_RATIO_LOCK")),c.opacity=0},RESIZE_SET_OUTPUT_SIZE:function(t){var e=t.root,n=t.action,r=e.ref,i=r.inputImageWidth,o=r.inputImageHeight;i.setValue(n.width),o.setValue(n.height)},CROP_SET_ASPECT_RATIO:function(t){var e=t.root,n=t.props,r=t.action,i=t.timestamp,o=e.query("GET_CROP",n.id,i);if(o){var a=o.cropStatus,c=e.ref,u=c.inputImageWidth,l=c.inputImageHeight;null!==r.value?(u.setValue(a.image.width),u.setPlaceholder(a.crop.width),l.setValue(a.image.height),l.setPlaceholder(a.crop.height)):u.getValue()&&l.getValue()&&(l.setValue(null),l.setPlaceholder(a.crop.height))}}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.query("GET_CROP",n.id,r);if(i){e.opacity;var o=i.cropStatus,a=e.ref,c=a.inputImageWidth,u=a.inputImageHeight;if(!c.hasFocus()&&!u.hasFocus()){var l=e.query("GET_CROP_RECTANGLE_ASPECT_RATIO");if(null===c.getValue()&&null===u.getValue())c.setPlaceholder(o.crop.width),u.setPlaceholder(o.crop.height);else if(null===c.getValue()&&null!==o.image.height){var s=Math.round(o.image.height*l);c.setPlaceholder(s)}else if(null===u.getValue()&&null!==o.image.width){var f=Math.round(o.image.width/l);u.setPlaceholder(f)}}}})}),_c=function(t,e){return Bt({tag:"fieldset",create:function(n){var r=n.root,i=st("legend");i.textContent=t,r.element.appendChild(i),e({root:r})}})},wc=Bt({name:"resize",ignoreRect:!0,mixins:{apis:["viewId","stagePosition","hidden"]},create:function(t){var e=t.root,n=t.props;n.viewId="resize",n.hidden=!1,e.ref.isHiding=!1,e.ref.form=e.appendChildView(e.createChildView(Ec,{opacity:0,id:n.id}))},read:function(t){var e=t.root,n=t.props;if(!n.hidden){var r=e.rect;if(0!==r.element.width&&0!==r.element.height){var i=e.ref.form.rect;n.stagePosition={x:r.element.left,y:r.element.top+i.element.height,width:r.element.width,height:r.element.height-i.element.height}}}},shouldUpdateChildViews:function(t){var e=t.props,n=t.actions;return!e.hidden||e.hidden&&n&&n.length},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.action,r=t.props;n.id===r.viewId?(e.ref.isHiding=!1,e.ref.form.opacity=1):(e.ref.isHiding=!0,e.ref.form.opacity=0)}},function(t){var e=t.root,n=t.props,r=e.ref,i=r.form,o=r.isHiding,a=n.hidden;o&&0===i.opacity&&!a?n.hidden=!0:n.hidden=!1})}),Tc=Bt({name:"range-input",tag:"span",mixins:{listeners:!0,apis:["onUpdate","setValue","getValue","setAllowInteraction"]},create:function(t){var e=t.root,n=t.props,r=n.id,i=n.min,o=n.max,a=n.step,c=n.value,u=n.onUpdate,l=void 0===u?function(){}:u,s="doka--".concat(r,"-").concat(ye()),f=st("input",{type:"range",id:s,min:i,max:o,step:a});f.value=c,e.ref.input=f;var d=st("span");d.className="doka--range-input-inner";var p=st("label",{for:s});p.innerHTML=n.label;var v=i+.5*(o-i);e.element.dataset.centered=c===v,e.ref.handleRecenter=function(){n.setValue(v),e.ref.handleChange()};var g=st("button",{type:"button"});g.textContent="center",g.addEventListener("click",e.ref.handleRecenter),e.ref.recenter=g,d.appendChild(f),d.appendChild(g),e.appendChild(p),e.appendChild(d),e.ref.handleChange=function(){var t=n.getValue();e.element.dataset.centered=t===v,l(t)},f.addEventListener("input",e.ref.handleChange);var m=null;e.ref.dragger=Oo(d,function(){m=f.getBoundingClientRect()},function(t){var n=(t.pageX-m.left)/m.width;f.value=i+n*(o-i),e.ref.handleChange()},function(){},{stopPropagation:!0}),n.getValue=function(){return h()(f.value)},n.setValue=function(t){return f.value=t},n.setAllowInteraction=function(t){t?e.ref.dragger.enable():e.ref.dragger.disable()}},destroy:function(t){var e=t.root;e.ref.dragger.destroy(),e.ref.recenter.removeEventListener("click",e.ref.handleRecenter),e.ref.input.removeEventListener("input",e.ref.handleChange)}}),xc={brightness:{icon:po('<g fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="7"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></g>')},contrast:{icon:po('<g fill="none" fill-rule="evenodd"><circle stroke="currentColor" stroke-width="3" cx="12" cy="12" r="10"/><path d="M12 2v20C6.477 22 2 17.523 2 12S6.477 2 12 2z" fill="currentColor"/></g>')},exposure:{icon:po('<g fill="none" fill-rule="evenodd"><rect stroke="currentColor" stroke-width="3" x="2" y="2" width="20" height="20" rx="4"/><path d="M20.828 3.172L3.172 20.828A3.987 3.987 0 0 1 2 18V6a4 4 0 0 1 4-4h12c1.105 0 2.105.448 2.828 1.172zM7 7H5v2h2v2h2V9h2V7H9V5H7v2zM12 15h5v2h-5z" fill="currentColor"/></g>')},saturation:{icon:po('<g fill="none" fill-rule="evenodd"><rect stroke="currentColor" stroke-width="3" x="2" y="2" width="20" height="20" rx="4"/><path fill="currentColor" opacity=".3" d="M7 2.5h5v18.75H7z"/><path fill="currentColor" opacity=".6" d="M12 2.5h5v18.75h-5z"/><path fill="currentColor" opacity=".9" d="M17 2.5h4v18.75h-4z"/></g>')}},Rc=Bt({ignoreRect:!0,name:"color-form",tag:"form",mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:15}}},create:function(t){var e=t.root;e.element.setAttribute("novalidate","novalidate");var n=e.query("GET_COLOR_VALUES");e.ref.tools=L()(xc).reduce(function(t,r){var i=r,o=xc[r].icon,a=e.query("GET_LABEL_COLOR_".concat(r.toUpperCase())),c=e.query("GET_COLOR_".concat(r.toUpperCase(),"_RANGE")),u=n[r];return t[i]={view:e.appendChildView(e.createChildView(Tc,{id:i,label:"".concat(o,"<span>").concat(a,"</span>"),min:c[0],max:c[1],step:.01,value:u,onUpdate:function(t){return e.dispatch("COLOR_SET_COLOR_VALUE",{key:i,value:t})}}))},t},{})},write:zt({COLOR_SET_VALUE:function(t){var e=t.root,n=t.action;e.ref.tools[n.key].view.setValue(n.value)},SHOW_VIEW:function(t){var e=t.root,n=t.action;L()(e.ref.tools).forEach(function(t){e.ref.tools[t].view.setAllowInteraction("color"===n.id)})}})}),bc=null,Ac=null,Ic=function(t,e){var n=e.brightness,r=e.exposure,i=e.contrast,o=e.saturation;if(0!==n){var a=n<0,c=a?"multiply":"overlay",u=a?0:255,l=a?Math.abs(n):1-n;t.ref.imageOverlay.style.cssText="mix-blend-mode: ".concat(c,"; background: rgba(").concat(u,",").concat(u,",").concat(u,",").concat(l,")")}return t.ref.imageOverlay.style.cssText="background:transparent",t.ref.image.style.cssText="filter: brightness(".concat(r,") contrast(").concat(i,") saturate(").concat(o,")"),e},Cc=L()(xc),Sc=function(t,e){return Cc.findIndex(function(n){return t[n]!==e[n]})<0},Oc=function(t){return Bt({ignoreRect:!0,tag:"li",name:"filter-tile",mixins:{styles:["opacity","translateY"],animations:{translateY:{type:"spring",delay:10*t},opacity:{type:"spring",delay:30*t}}},create:function(t){var e=t.root,n=t.props,r="doka--filter-".concat(n.style,"-").concat(ye()),i=st("input",{id:r,type:"radio",name:"filter"});e.appendChild(i),i.checked=n.selected,i.value=n.style,i.addEventListener("change",function(){i.checked&&n.onSelect()});var o=st("label",{for:r});o.textContent=n.label,e.appendChild(o);var a=n.imageData,c=Math.min(a.width,a.height),u=c,l=st("canvas");l.width=c,l.height=u;var s=l.getContext("2d");e.ref.image=l;var f=st("div");e.ref.imageOverlay=f;var d={x:.5*c-.5*a.width,y:.5*u-.5*a.height},h=st("div");h.appendChild(l),h.appendChild(f),e.appendChild(h),e.ref.imageWrapper=h,n.matrix?(bc||(bc=kr(Cr)),clearTimeout(Ac),bc.post({transforms:[{type:"filter",data:n.matrix}],imageData:a},function(t){s.putImageData(t,d.x,d.y),clearTimeout(Ac),Ac=setTimeout(function(){bc.terminate(),bc=null},1e3)},[a.data.buffer]),e.ref.activeColors=Ic(e,e.query("GET_COLOR_VALUES"))):s.putImageData(a,d.x,d.y)},write:function(t){var e=t.root;if(!(e.opacity<=0)){var n=e.query("GET_COLOR_VALUES"),r=e.ref.activeColors;(!r&&n||!Sc(r,n))&&(e.ref.activeColors=n,Ic(e,n))}}})},Lc=function(t){var e;try{e=new ImageData(t.width,t.height)}catch(n){e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(new Uint8ClampedArray(t.data)),e},Mc=function(t,e){return b()(t)&&b()(e)&&t.length===e.length&&t.every(function(t,n){return t===e[n]})},Pc=Bt({ignoreRect:!0,tag:"ul",name:"filter-list",mixins:{apis:["filterOpacity","hidden"]},create:function(t){var e=t.root,n=t.props;e.element.setAttribute("role","list"),e.ref.tiles=[];var r=e.query("GET_THUMB_IMAGE_DATA"),i=e.query("GET_FILTERS"),o=[];it(i,function(t,e){o.push(z({id:t},e))}),e.ref.activeFilter=e.query("GET_FILTER"),e.ref.tiles=o.map(function(t,i){var o=t.matrix(),a=e.ref.activeFilter===t.id||Mc(e.ref.activeFilter,o)||0===i;return e.appendChildView(e.createChildView(Oc(i),{opacity:0,translateY:-5,id:n.id,style:t.id,label:t.label,matrix:o,imageData:Lc(r),selected:a,onSelect:function(){return e.dispatch("FILTER_SET_FILTER",{value:o?t.id:null})}}))})},write:function(t){var e=t.root,n=t.props;if(!n.hidden){var r=e.query("GET_FILTER");if(r!==e.ref.activeFilter){e.ref.activeFilter=r;var i=e.query("GET_FILTERS"),o=r?Kt(r)?r:Ci(r)?L()(i).find(function(t){return Mc(i[t].matrix(),r)}):null:"original";w()(e.element.querySelectorAll("input")).forEach(function(t){return t.checked=t.value===o})}e.query("IS_ACTIVE_VIEW","filter")?e.ref.tiles.forEach(function(t){t.opacity=1,t.translateY=0}):e.ref.tiles.forEach(function(t){t.opacity=0,t.translateY=-5}),n.filterOpacity=e.ref.tiles.reduce(function(t,e){return t+e.opacity},0)/e.ref.tiles.length}}}),Gc=Bt({name:"filter-scroller",ignoreRect:!0,ignoreRectUpdate:!0,mixins:{styles:["opacity"],animations:{opacity:{type:"spring"}},apis:["hidden","filterOpacity"]},create:function(t){var e,n=t.root,r=t.props;n.ref.filters=n.appendChildView(n.createChildView(Pc,{id:r.id})),n.element.isScrollContainer=!0,$a()&&(n.ref.handleMouseWheel=function(t){var e=n.element.scrollLeft,r=n.ref.scrollWidth-n.rect.element.width,i=e+t.deltaX;(i<0||i>r)&&(n.element.scrollLeft=Math.min(Math.max(i,0),r),t.preventDefault())},n.element.addEventListener("mousewheel",n.ref.handleMouseWheel),n.element.dataset.dragState="end",n.ref.dragger=Oo(n.ref.filters.element,function(){n.element.dataset.dragState="start",e=n.element.scrollLeft},function(t,r){n.element.scrollLeft=e-r.x,ke({x:0,y:0},r)>0&&(n.element.dataset.dragState="dragging")},function(){n.element.dataset.dragState="end"},{stopPropagation:!0}))},destroy:function(t){var e=t.root;e.ref.handleMouseWheel&&e.element.removeEventListener("mousewheel",e.ref.handleMouseWheel),e.ref.dragger&&e.ref.dragger.destroy()},read:function(t){var e=t.root;e.ref.scrollWidth=e.element.scrollWidth},write:function(t){var e=t.root,n=t.props;e.ref.filters.hidden=n.hidden,n.filterOpacity=e.ref.filters.filterOpacity}}),kc=Bt({name:"filter",ignoreRect:!0,mixins:{apis:["viewId","stagePosition","hidden"]},create:function(t){var e=t.root,n=t.props;n.viewId="filter",n.hidden=!1,e.ref.isHiding=!1,e.ref.filters=e.appendChildView(e.createChildView(Gc,{id:n.id}))},read:function(t){var e=t.root,n=t.props;if(e.ref.filters&&!n.hidden){var r=e.rect;if(0!==r.element.width&&0!==r.element.height){var i=e.ref.filters.rect,o=0===i.element.top,a=o?r.element.top+i.element.height+i.element.marginBottom:r.element.top,c=o?r.element.height-i.element.height-i.element.marginBottom:r.element.height-i.element.height-r.element.top;n.stagePosition={x:r.element.left,y:a,width:r.element.width,height:c}}}},shouldUpdateChildViews:function(t){var e=t.props,n=t.actions;return!e.hidden||e.hidden&&n&&n.length},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.action,r=t.props;e.ref.filters&&(n.id===r.viewId?(e.ref.isHiding=!1,r.hidden=!1,e.ref.filters.hidden=!1):e.ref.isHiding=!0)}},function(t){var e=t.root,n=t.props;e.ref.filters.opacity=e.ref.isHiding||e.ref.filters.hidden?0:1,e.ref.isHiding&&e.ref.filters.filterOpacity<=0&&(e.ref.isHiding=!1,n.hidden=!0,e.ref.filters.hidden=!0)})}),Dc=Bt({name:"color",ignoreRect:!0,mixins:{apis:["viewId","stagePosition","hidden"]},create:function(t){var e=t.root,n=t.props;n.viewId="color",n.hidden=!1,e.ref.isHiding=!1,e.ref.form=e.appendChildView(e.createChildView(Rc,{opacity:0,id:n.id}))},read:function(t){var e=t.root,n=t.props;if(!n.hidden){var r=e.rect;if(0!==r.element.width&&0!==r.element.height){var i=e.ref.form.rect,o=i.element.height,a=0===i.element.top,c=a?r.element.top+o:r.element.top,u=a?r.element.height-o:r.element.height-o-r.element.top;n.stagePosition={x:r.element.left,y:c,width:r.element.width,height:u}}}},shouldUpdateChildViews:function(t){var e=t.props,n=t.actions;return!e.hidden||e.hidden&&n&&n.length},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.action,r=t.props;n.id===r.viewId?(e.ref.isHiding=!1,e.ref.form.opacity=1,r.hidden=!1):(e.ref.isHiding=!0,e.ref.form.opacity=0)}},function(t){var e=t.root,n=t.props;e.ref.isHiding&&0===e.ref.form.opacity&&(e.ref.isHiding=!1,n.hidden=!0)})}),Uc=function(){try{var t=st("input",{type:"color"}),e="color"===t.type;return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?e:e&&"number"!=typeof t.selectionStart}catch(t){return!1}},Nc=function(t,e,n){var r,i=Math.max(t,e,n),o=Math.min(t,e,n),a=i-o,c=0===i?0:a/i,u=i/255;switch(i){case o:r=0;break;case t:r=e-n+a*(e<n?6:0),r/=6*a;break;case e:r=n-t+2*a,r/=6*a;break;case n:r=t-e+4*a,r/=6*a}return[r,c,u]},Vc=Bt({ignoreRect:!0,tag:"div",name:"markup-color",mixins:{animations:{opacity:"spring"},styles:["opacity"],apis:["onSelect","selectedValue"]},create:function(t){var e=t.root,n=t.props,r=n.colors,i=n.name,o=n.onSelect;e.ref.handleChange=function(t){o(t.target.value),t.stopPropagation()},e.element.addEventListener("change",e.ref.handleChange);var a=st("ul");if(e.ref.inputs=r.map(function(t){var e="doka--color-"+ye(),n=st("li"),r=st("input",{id:e,name:i,type:"radio",value:t[1]}),o=st("label",{for:e,title:t[0],style:"background-color: "+(t[2]||t[1])});return o.textContent=t[0],ft(n)(r),ft(n)(o),ft(a)(n),r}),e.element.appendChild(a),e.query("GET_MARKUP_ALLOW_CUSTOM_COLOR")&&Uc()){var c=st("div",{class:"doka--color-input"}),u="doka--color-"+ye(),l=st("label",{for:u});l.textContent="Choose color";var s=st("input",{id:u,name:i,type:"color"}),f=st("span",{class:"doka--color-visualizer"}),d=st("span",{class:"doka--color-brightness"});e.ref.handleCustomColorChange=function(){var t=Tn(s.value),e=Nc.apply(void 0,Y(t)),n=360*e[0]-90,r=.625*e[1],i=1-e[2];f.style.backgroundColor=s.value,f.style.transform="rotateZ(".concat(n,"deg) translateX(").concat(r,"em)"),d.style.opacity=i,o(s.value)};var h=!0;e.ref.handleCustomColorSelect=function(t){h?o(t.target.value):e.ref.handleCustomColorChange(),h=!1},s.addEventListener("click",e.ref.handleCustomColorSelect),s.addEventListener("input",e.ref.handleCustomColorChange),ft(c)(s),ft(c)(l),ft(c)(f),ft(c)(d),e.appendChild(c),e.ref.customInput=s}},write:function(t){var e=t.root,n=t.props;if(n.selectedValue!==e.ref.activeSelectedValue){e.ref.activeSelectedValue=n.selectedValue;var r=!1;if(e.ref.inputs.forEach(function(t){t.checked=t.value===n.selectedValue,t.checked&&(r=!0)}),!e.ref.customInput)return;e.ref.customInput.dataset.selected=e.ref.inputs.length&&!r,r||(e.ref.customInput.value=n.selectedValue,e.ref.handleCustomColorChange())}},destroy:function(t){var e=t.root;e.element.removeEventListener("change",e.ref.handleChange),e.ref.customInput&&(e.ref.customInput.removeEventListener("click",e.ref.handleCustomColorSelect),e.ref.customInput.removeEventListener("input",e.ref.handleCustomColorChange))}}),Bc=function(t){var e=t.ref,n=e.colorSelect,r=e.fontFamilySelect,i=e.fontSizeSelect,o=e.shapeStyleSelect,a=e.lineStyleSelect;[r,i,o,e.lineDecorationSelect].forEach(function(t){t.element.dataset.active="false"}),[n,a].forEach(function(t){t.element.dataset.active="true"})},Fc=["fontFamily","fontSize","fontWeight","textAlign","backgroundColor","fontColor","borderColor","borderWidth","borderStyle","lineColor","lineWidth","lineDecoration","lineJoin","lineCap"],zc=function(t){return'<svg width="23" height="23" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">'.concat(t,"</svg>")},Wc=function(t){var e=0===t?"currentColor":"none",n=t;return zc('<rect stroke="'.concat(0===t?"none":"currentColor",'" fill="').concat(e,'" stroke-width="').concat(n,'" x="2" y="3" width="17" height="17" rx="3"/>'))},qc=function(t){return zc('<line stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width="'.concat(t,'" x1="3" y1="12" x2="20" y2="12"/>'))},Yc=Bt({name:"markup-tools",ignoreRect:!0,mixins:{apis:["onUpdate"],animations:{translateY:"spring",opacity:"spring"},styles:["translateY","opacity"]},create:function(t){var e=t.root,n=t.props.onUpdate;e.ref.colorSelect=e.appendChildView(e.createChildView(Vc,{onSelect:function(t){e.ref.colorSelect.selectedValue=t,n("color",t)},name:"color-select",colors:e.query("GET_MARKUP_COLOR_OPTIONS")})),e.ref.shapeStyleSelect=e.appendChildView(e.createChildView(Aa,{onSelect:function(t){e.ref.shapeStyleSelect.selectedValue=t,n("shapeStyle",[t[1],t[2]])},name:"tool",label:e.query("GET_LABEL_MARKUP_SELECT_SHAPE_STYLE"),direction:"up",options:e.query("GET_MARKUP_SHAPE_STYLE_OPTIONS").map(function(t){return{value:t,label:t[0],icon:Wc(t[3])}})})),e.ref.lineStyleSelect=e.appendChildView(e.createChildView(Aa,{onSelect:function(t){e.ref.lineStyleSelect.selectedValue=t,n("lineStyle",[t[1],t[2]])},name:"tool",label:e.query("GET_LABEL_MARKUP_SELECT_LINE_STYLE"),direction:"up",options:e.query("GET_MARKUP_LINE_STYLE_OPTIONS").map(function(t){return{value:t,label:t[0],icon:qc(t[3])}})})),e.ref.lineDecorationSelect=e.appendChildView(e.createChildView(Aa,{onSelect:function(t){e.ref.lineDecorationSelect.selectedValue=t,n("lineDecoration",t)},name:"tool",label:e.query("GET_LABEL_MARKUP_SELECT_LINE_DECORATION"),direction:"up",options:e.query("GET_MARKUP_LINE_DECORATION_OPTIONS").map(function(t){return{value:t[1],label:t[0]}})})),e.ref.fontFamilySelect=e.appendChildView(e.createChildView(Aa,{onSelect:function(t){e.ref.fontFamilySelect.selectedValue=t,n("fontFamily",t)},name:"tool",label:e.query("GET_LABEL_MARKUP_SELECT_FONT_FAMILY"),direction:"up",options:e.query("GET_MARKUP_FONT_FAMILY_OPTIONS").map(function(t){return{value:t[1],label:'<span style="font-family:'.concat(t[1],';font-weight:600;">').concat(t[0],"</span>")}})})),e.ref.fontSizeSelect=e.appendChildView(e.createChildView(Aa,{onSelect:function(t){e.ref.fontSizeSelect.selectedValue=t,n("fontSize",t)},name:"tool",label:e.query("GET_LABEL_MARKUP_SELECT_FONT_SIZE"),direction:"up",options:e.query("GET_MARKUP_FONT_SIZE_OPTIONS").map(function(t){return{value:t[1],label:t[0]}})})),"draw"===e.query("GET_MARKUP_UTIL")&&Bc(e)},write:zt({SWITCH_MARKUP_UTIL:function(t){var e=t.root;"draw"===t.action.util&&Bc(e)},MARKUP_SELECT:function(t){var e=t.root,n=t.action,r=e.ref,i=r.colorSelect,o=r.fontFamilySelect,a=r.fontSizeSelect,c=r.shapeStyleSelect,u=r.lineStyleSelect,l=r.lineDecorationSelect,s=n.id?e.query("GET_MARKUP_BY_ID",n.id):null,f=[i,o,a,c,u,l],d=[];if(s){var h=q(s,2),p=h[0],v=h[1],g=b()(v.allowEdit)?v.allowEdit:!1===v.allowEdit?[]:Fc,m=Fc.reduce(function(t,e){return t[e]=-1!==g.indexOf(e),t},{});if(m.color=!!g.find(function(t){return/[a-z]Color/.test(t)}),"image"!==p&&m.color&&(i.selectedValue=Hc(v),d.push(i)),"text"===p&&(m.fontFamily&&(o.selectedValue=v.fontFamily,d.push(o)),m.fontSize&&(a.selectedValue=v.fontSize,d.push(a))),("rect"===p||"ellipse"===p)&&m.borderStyle){var y=e.query("GET_MARKUP_SHAPE_STYLE_OPTIONS").find(function(t){var e=v.borderWidth===t[1],n=v.borderStyle===t[2]||Mc(v.borderStyle,t[2]);return e&&n});c.selectedValue=y,d.push(c)}if("line"===p||"path"===p){if(m.lineWidth){var E=e.query("GET_MARKUP_LINE_STYLE_OPTIONS").find(function(t){var e=v.lineWidth===t[1],n=v.lineStyle===t[2]||Mc(v.lineStyle,t[2]);return e&&n});u.selectedValue=E,d.push(u)}"line"===p&&m.lineDecoration&&(l.selectedValue=v.lineDecoration,d.push(l))}f.forEach(function(t){t.element.dataset.active="false"}),d.forEach(function(t){t.element.dataset.active="true"})}},MARKUP_UPDATE:function(t){var e=t.root,n=t.action,r=n.style,i=n.value;e.ref[r+"Select"]&&(e.ref[r+"Select"].selectedValue=i)}})}),Hc=function(t){var e=t.fontColor,n=t.backgroundColor,r=t.lineColor,i=t.borderColor;return e||n||r||i},jc=Bt({name:"markup",ignoreRect:!0,mixins:{apis:["viewId","stagePosition","hidden"]},create:function(t){var e=t.root,n=t.props;n.viewId="markup",n.hidden=!1,e.ref.isHiding=!1;var r=[["select",{label:e.query("GET_LABEL_MARKUP_TOOL_SELECT"),icon:po('<g fill="none" fill-rule="evenodd"><path d="M7 13H5a1 1 0 01-1-1V5a1 1 0 011-1h7a1 1 0 011 1v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M10.22 8.914l12.58 5.18a1 1 0 01.012 1.844l-4.444 1.904a1 1 0 00-.526.526l-1.904 4.444a1 1 0 01-1.844-.013l-5.18-12.58a1 1 0 011.305-1.305z" fill="currentColor"/></g>',26)}],["draw",{label:e.query("GET_LABEL_MARKUP_TOOL_DRAW"),icon:po('<g fill="currentColor"><path d="M17.86 5.71a2.425 2.425 0 013.43 3.43L9.715 20.714 5 22l1.286-4.715L17.86 5.71z"/></g>',26)}],["line",{label:e.query("GET_LABEL_MARKUP_TOOL_LINE"),icon:po('<g transform="translate(3 4.5)" fill-rule="nonzero" fill="currentColor" stroke="none"><path d="M15.414 9.414l-6.01 6.01a2 2 0 1 1-2.829-2.828L9.172 10H2a2 2 0 1 1 0-4h7.172L6.575 3.404A2 2 0 1 1 9.404.575l6.01 6.01c.362.363.586.863.586 1.415s-.224 1.052-.586 1.414z"/></g>',26)}],["text",{label:e.query("GET_LABEL_MARKUP_TOOL_TEXT"),icon:po('<g transform="translate(5 5)" fill="currentColor" fill-rule="evenodd"><path d="M10 4v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4H1a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-5z"/></g>',26)}],["rect",{label:e.query("GET_LABEL_MARKUP_TOOL_RECT"),icon:po('<g fill="currentColor"><rect x="5" y="5" width="16" height="16" rx="2"/></g>',26)}],["ellipse",{label:e.query("GET_LABEL_MARKUP_TOOL_ELLIPSE"),icon:po('<g fill="currentColor"><circle cx="13" cy="13" r="9"/></g>',26)}]];e.ref.utils=st("fieldset"),e.ref.utils.className="doka--markup-utils",e.ref.utilsList=st("ul");var i="markup-utils-".concat(ye());e.ref.inputs=r.map(function(t){var n=t[0],r=t[1],o="doka--markup-tool-"+ye(),a=st("li"),c=st("input");c.id=o,c.checked=e.query("GET_MARKUP_UTIL")===n,c.setAttribute("type","radio"),c.setAttribute("name",i),c.value=n;var u=st("label");return u.setAttribute("for",o),u.className="doka--button-tool",u.innerHTML=r.icon+"<span>"+r.label+"</span>",u.title=r.label,a.appendChild(c),a.appendChild(u),e.ref.utilsList.appendChild(a),c}),e.ref.utils.appendChild(e.ref.utilsList),e.ref.utilsList.addEventListener("change",function(t){e.dispatch("SET_MARKUP_UTIL",{value:t.target.value})}),e.query("GET_MARKUP_ALLOW_ADD_MARKUP")&&(e.ref.menu=e.appendChildView(e.createChildView(Ra("toolbar",["opacity"],{opacity:{type:"spring",mass:15,delay:50}}),{opacity:0,element:e.ref.utils})));var o=e.ref.tools=e.appendChildView(e.createChildView(Yc,{opacity:0,onUpdate:function(t,n){e.dispatch("MARKUP_UPDATE",{style:t,value:n})}}));e.ref.menuItemsRequiredWidth=null,"draw"===e.query("GET_MARKUP_UTIL")&&(o.opacity=1,o.translateY=0,o.element.dataset.active="true")},read:function(t){var e=t.root,n=t.props;if(n.hidden)e.ref.menuItemsRequiredWidth=null;else{var r=e.rect;if(0!==r.element.width&&0!==r.element.height){if(e.ref.menu&&null===e.ref.menuItemsRequiredWidth){var i=e.ref.menu.rect.element.width;e.ref.menuItemsRequiredWidth=0===i?null:i}var o=e.ref.menu&&e.ref.menu.rect,a=e.ref.tools.rect.element.height,c=o?o.element.height:a,u=!o||0===o.element.top,l=u?r.element.top+c:r.element.top,s=u?r.element.height-c:r.element.height-c-r.element.top;n.stagePosition={x:r.element.left+20,y:l,width:r.element.width-40,height:s-a}}}},shouldUpdateChildViews:function(t){var e=t.props,n=t.actions;return!e.hidden||e.hidden&&n&&n.length},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.action,r=t.props;n.id===r.viewId?(r.hidden=!1,e.ref.isHiding=!1,e.ref.menu&&(e.ref.menu.opacity=1)):(e.ref.isHiding=!0,e.ref.menu&&(e.ref.menu.opacity=0),e.ref.tools.opacity=0,e.ref.tools.translateY=5)},MARKUP_SELECT:function(t){var e=t.root,n=t.action;e.ref.tools.opacity=n.id?1:0,e.ref.tools.translateY=n.id?0:5,e.ref.tools.element.dataset.active=n.id?"true":"false"},DID_SET_MARKUP_UTIL:function(t){var e=t.root,n=t.action,r=e.ref,i=r.inputs,o=r.tools;i.forEach(function(t){t.checked=t.value===n.value}),"draw"===n.value&&(o.opacity=1,o.translateY=0,o.element.dataset.active="true")}},function(t){var e=t.root,n=t.props;e.ref.isHiding&&e.ref.menu&&0===e.ref.menu.opacity&&(e.ref.isHiding=!1,n.hidden=!0),n.hidden||(e.ref.menu.element.dataset.layout=e.ref.menuItemsRequiredWidth>e.rect.element.width?"compact":"spacious")})}),Zc=function(t,e){return!t||!e||!Fe(t,e)},Xc={crop:pc,resize:wc,filter:kc,color:Dc,markup:jc},Kc=Bt({name:"view-stack",ignoreRect:!0,mixins:{apis:["offsetTop"]},create:function(t){var e=t.root;e.ref.activeView=null,e.ref.activeStagePosition=null,e.ref.shouldFocus=!1},write:zt({SHOW_VIEW:function(t){var e=t.root,n=t.props,r=t.action,i=0===e.childViews.length,o=e.childViews.find(function(t){return t.viewId===r.id});o||(o=e.appendChildView(e.createChildView(Xc[r.id],z({},n)))),e.ref.activeView=o,e.childViews.map(function(t){return t.element}).forEach(function(t){t.dataset.viewActive="false",t.removeAttribute("tabindex")});var a=e.ref.activeView.element;a.dataset.viewActive="true",a.setAttribute("tabindex",-1),e.ref.shouldFocus=!i},DID_PRESENT_IMAGE:function(t){var e=t.root;e.dispatch("CHANGE_VIEW",{id:e.query("GET_UTIL")||e.query("GET_UTILS")[0]})},DID_SET_UTILS:function(t){var e=t.root;e.dispatch("CHANGE_VIEW",{id:e.query("GET_UTIL")||e.query("GET_UTILS")[0]})}},function(t){var e=t.root,n=t.props,r=e.ref,i=r.activeView,o=r.previousStagePosition;if(i&&i.stagePosition&&(e.childViews.forEach(function(t){t.offsetTop=n.offsetTop,t.element.viewHidden!==t.hidden&&(t.element.viewHidden=t.hidden,t.element.dataset.viewHidden=t.hidden)}),Zc(i.stagePosition,o))){var a=i.stagePosition,c=a.x,u=a.y,l=a.width,s=a.height;if(0===l&&0===s)return;e.dispatch("DID_RESIZE_STAGE",{offset:{x:c,y:u},size:{width:l,height:s},animate:!0}),e.ref.previousStagePosition=i.stagePosition}}),didWriteView:function(t){var e=t.root;e.ref.shouldFocus&&(e.ref.activeView.element.focus({preventScroll:!0}),e.ref.shouldFocus=!1)}}),$c=Bt({name:"content",ignoreRect:!0,mixins:{styles:["opacity"],animations:{opacity:{type:"tween",duration:250}}},create:function(t){var e=t.root,n=t.props;e.opacity=1,e.ref.viewStack=e.appendChildView(e.createChildView(Kc,{id:n.id})),e.ref.image=null},write:zt({DID_LOAD_IMAGE:function(t){var e=t.root,n=t.props;e.ref.image=e.appendChildView(e.createChildView(xa,{id:n.id}))}},function(t){var e=t.root,n=e.ref,r=n.image,i=n.viewStack;if(r){var o=e.rect.element.top;i.offsetTop=o,r.offsetTop=o}})}),Qc=function(t,e){t.element.dataset.scaleDirection=null===e||e>1?"up":"down"},Jc=Bt({name:"utils",create:function(t){var e=t.root,n={crop:{title:e.query("GET_LABEL_BUTTON_UTIL_CROP"),icon:po('<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width="2"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1"/><path d="M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>')},filter:{title:e.query("GET_LABEL_BUTTON_UTIL_FILTER"),icon:po('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417"/><path d="M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>')},color:{title:e.query("GET_LABEL_BUTTON_UTIL_COLOR"),icon:po('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>')},markup:{title:e.query("GET_LABEL_BUTTON_UTIL_MARKUP"),icon:po('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>')},resize:{title:e.query("GET_LABEL_BUTTON_UTIL_RESIZE"),icon:po('<g fill="none" fill-rule="evenodd" stroke-width="2" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4" class="doka--icon-resize-arrow-ne"/><path d="M14 10l3.365-3.365M14 6v4h4" class="doka--icon-resize-arrow-sw"/></g>')}};e.ref.utils=L()(n).map(function(t){return z({id:t},n[t])}),e.ref.utilMenuRequiredWidth=null},read:function(t){var e=t.root;if(null===e.ref.utilMenuRequiredWidth){var n=e.childViews.reduce(function(t,e){return t+e.rect.outer.width},0);e.ref.utilMenuRequiredWidth=0===n?null:n}},write:zt({DID_SET_UTILS:function(t){var e=t.root,n=Y(e.query("GET_UTILS"));e.childViews.forEach(function(t){return e.removeChildView(t)}),e.element.dataset.utilCount=n.length,1===n.length&&(n.length=0),n.forEach(function(t){var n=e.ref.utils.find(function(e){return e.id===t}),r=e.appendChildView(e.createChildView(vo,{name:"tab",view:vo,label:n.title,opacity:1,icon:n.icon,id:n.id,action:function(){return e.dispatch("CHANGE_VIEW",{id:n.id})}}));e.ref["util_button_".concat(n.id)]=r})},SHOW_VIEW:function(t){var e=t.root,n=t.action;e.childViews.forEach(function(t){t.element.dataset.active=t.id===n.id})}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.query("GET_CROP",n.id,r);if(i){var o=i.cropStatus;e.ref.util_button_resize&&Qc(e.ref.util_button_resize,o.image.width?o.image.width/o.crop.width:null),e.element.dataset.layout=e.ref.utilMenuRequiredWidth>e.rect.element.width?"compact":"spacious"}})}),tu=Ut()&&function(){try{var t={antialias:!1,alpha:!1},e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl",t)||e.getContext("experimental-webgl",t))}catch(t){return!1}}(),eu=function(){return tu},nu=Bt({name:"container",create:function(t){var e=t.root,n=[{view:vo,opacity:0,label:e.query("GET_LABEL_BUTTON_RESET"),didCreateView:function(t){return e.ref.btnReset=t},name:"app action-reset icon-only",icon:po('<g fill="currentColor" fill-rule="nonzero"><path d="M6.036 13.418L4.49 11.872A.938.938 0 1 0 3.163 13.2l2.21 2.209a.938.938 0 0 0 1.326 0l2.209-2.21a.938.938 0 0 0-1.327-1.326l-1.545 1.546zM12 10.216a1 1 0 0 1 2 0V13a1 1 0 0 1-2 0v-2.784z"/><path d="M15.707 14.293a1 1 0 0 1-1.414 1.414l-2-2a1 1 0 0 1 1.414-1.414l2 2z"/><path d="M8.084 19.312a1 1 0 0 1 1.23-1.577 6 6 0 1 0-2.185-3.488 1 1 0 0 1-1.956.412 8 8 0 1 1 2.912 4.653z"/></g>',26),action:function(){return e.dispatch("EDIT_RESET")}}];e.query("GET_ALLOW_BUTTON_CANCEL")&&n.unshift({view:vo,label:e.query("GET_LABEL_BUTTON_CANCEL"),name:"app action-cancel icon-fallback",opacity:1,icon:po('<g fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18M6 6l12 12"/></g>'),didCreateView:function(t){e.ref.btnCancel=t},action:function(){e.dispatch("EDIT_CANCEL")}}),n.push({view:Jc}),e.query("GET_ALLOW_BUTTON_CONFIRM")&&n.push({view:vo,label:e.query("GET_LABEL_BUTTON_CONFIRM"),name:"app action-confirm icon-fallback",opacity:1,icon:po('<polyline fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="20 6 9 17 4 12"></polyline>'),didCreateView:function(t){e.ref.btnConfirm=t},action:function(){e.dispatch("EDIT_CONFIRM")}}),e.ref.menu=e.appendChildView(e.createChildView(Ra("menu"),{controls:n})),e.ref.menu.opacity=0,e.ref.status=e.appendChildView(e.createChildView(Ro)),e.ref.hasWebGL=eu(),e.ref.hasWebGL?e.dispatch("AWAIT_IMAGE"):e.dispatch("MISSING_WEBGL"),e.ref.handleFocusOut=function(){var t=e.ref.status;"busy"===t.element.dataset.viewStatus&&t.element.focus()},e.ref.handleFocusIn=function(t){var n=e.ref,r=n.menu,i=n.content,o=t.target;if(!r.element.contains(o)&&i&&i.element.contains(o)){if(!w()(e.element.querySelectorAll("[data-view-active=false]")).reduce(function(t,e){return e.contains(o)&&(t=!0),t},!1))return;r.element.querySelector("button,input,[tabindex]").focus()}},e.element.addEventListener("focusin",e.ref.handleFocusIn),e.element.addEventListener("focusout",e.ref.handleFocusOut),e.ref.previousState=null},destroy:function(t){var e=t.root;e.element.removeEventListener("focusin",e.ref.handleFocusIn),e.element.removeEventListener("focusout",e.ref.handleFocusOut)},write:zt({UNLOAD_IMAGE:function(t){var e=t.root;e.ref.content&&(e.ref.content.opacity=0,e.ref.menu.opacity=0)},DID_UNLOAD_IMAGE:function(t){var e=t.root;e.removeChildView(e.ref.content),e.ref.content=null},DID_LOAD_IMAGE:function(t){var e=t.root,n=t.props;e.ref.hasWebGL&&(e.ref.content=e.appendChildView(e.createChildView($c,{opacity:null,id:n.id})),e.ref.menu.opacity=1)},SHOW_VIEW:function(t){var e=t.root,n=t.action;e.element.dataset.limitOverflow="resize"===n.id}},function(t){var e=t.root,n=t.props,r=t.timestamp,i=e.query("GET_CROP",n.id,r);if(i){var o=i.cropStatus,a=o.props,c={crop:{center:{x:Oe(a.center.x,5),y:Oe(a.center.y,5)},rotation:Oe(a.rotation,5),zoom:Oe(a.zoom,5),aspectRatio:Oe(a.aspectRatio,5),flip:{horizontal:a.flip.horizontal,vertical:a.flip.vertical},scaleToFit:a.scaleToFit,width:o.currentWidth,height:o.currentHeight}};ru(e.ref.previousState,c)&&(e.dispatch("DID_UPDATE",{state:z({},c)}),e.ref.previousState=c);var u=e.ref,l=u.btnCancel,s=u.content,f=i.canReset;if(e.ref.btnReset.opacity=f?1:0,l&&e.query("GET_UTILS").length>1){var d=e.query("GET_ROOT_SIZE");l.opacity=f&&d.width<600?0:1}s&&0===s.opacity&&e.dispatch("DID_UNLOAD_IMAGE")}})}),ru=function(t,e){if(!t)return!0;var n=t.crop,r=e.crop;return n.width!==r.width||n.height!==r.height||n.center.x!==r.center.x||n.center.y!==r.center.y||n.rotation!==r.rotation||n.scaleToFit!==r.scaleToFit||n.zoom!==r.zoom||n.aspectRatio!==r.aspectRatio||n.flip.horizontal!==r.flip.horizontal||n.flip.vertical!==r.flip.vertical},iu=function(t){var e={destroy:function(){}};if("onpointerdown"in window||t.pointersPolyfilled)return e;t.pointersPolyfilled=!0;var n=0,r=[],i=function(t,e,n){var r=new UIEvent(e.type,{view:window,bubbles:!n});L()(e).forEach(function(t){P()(r,t,{value:e[t],writable:!1})}),t.dispatchEvent(r)},o=function(t,e,o){return w()(e.changedTouches).map(function(a){var c=r[a.identifier],u={type:t,pageX:a.pageX,pageY:a.pageY,pointerId:a.identifier,isPrimary:c?c.isPrimary:0===n,preventDefault:function(){return e.preventDefault()}};return i(a.target,u,o),u})},a=function(t){o("pointerdown",t).forEach(function(t){r[t.pointerId]=t,n++})},c=function(t){o("pointermove",t)},u=function(t){o("pointerup",t).forEach(function(t){delete r[t.pointerId],n--})},l=function(t,e,n){var r={type:t,pageX:e.pageX,pageY:e.pageY,pointerId:0,isPrimary:!0,preventDefault:function(){return e.preventDefault()}};return i(e.target,r,n),r},s=function(t){l("pointerdown",t)},f=function(t){l("pointermove",t)},d=function(t){l("pointerup",t)};return"ontouchstart"in window?(t.addEventListener("touchstart",a),t.addEventListener("touchmove",c),t.addEventListener("touchend",u)):"onmousedown"in window&&(t.addEventListener("mousedown",s),t.addEventListener("mousemove",f),t.addEventListener("mouseup",d)),e.destroy=function(){r.length=0,t.pointersPolyfilled=!1,t.removeEventListener("touchstart",a),t.removeEventListener("touchmove",c),t.removeEventListener("touchend",u),t.removeEventListener("mousedown",s),t.removeEventListener("mousemove",f),t.removeEventListener("mouseup",d)},e},ou=function(t){"gesturestart"!==t.type&&ic(t.target,function(t){return t.isScrollContainer})||t.preventDefault()},au=Bt({name:"editor",ignoreRect:!0,mixins:{styles:["opacity"],animations:{opacity:{type:"tween",duration:350}},apis:["markedForRemoval"]},create:function(t){var e=t.root,n=t.props;n.markedForRemoval=!1,xe()&&(e.element.addEventListener("touchmove",ou,{passive:!1}),e.element.addEventListener("gesturestart",ou)),e.ref.pointerPolyfill=iu("root"===e.query("GET_POINTER_EVENTS_POLYFILL_SCOPE")?e.element:document.documentElement),e.appendChildView(e.createChildView(nu,z({},n)))},destroy:function(t){var e=t.root;e.ref.pointerPolyfill.destroy(),e.element.removeEventListener("touchmove",ou,!0),e.element.removeEventListener("gesturestart",ou)}}),cu=function(){function t(){e.fire("touch-detected"),window.removeEventListener("touchstart",t,!1)}var e=z({},_e(),{destroy:function(){window.removeEventListener("touchstart",t,!1)}});return window.addEventListener("touchstart",t,!1),e},uu=function(t){var e,n={browseEnabled:!1},r=function(){e.files.length&&i.fire("drop",w()(e.files))},i=z({},_e(),{enableBrowse:function(){n.browseEnabled||((e=document.createElement("input")).style.display="none",e.setAttribute("type","file"),e.addEventListener("change",r),t.appendChild(e),t.addEventListener("click",o),n.browseEnabled=!0)},disableBrowse:function(){n.browseEnabled&&(e.removeEventListener("change",r),e.parentNode.removeChild(e),t.removeEventListener("click",o),n.browseEnabled=!1)},destroy:function(){t.removeEventListener("dragover",a),t.removeEventListener("drop",c),t.removeEventListener("click",o),e&&e.removeEventListener("change",r)}}),o=function(){return e.click()},a=function(t){return t.preventDefault()},c=function(t){t.preventDefault();var e=w()(t.dataTransfer.items||t.dataTransfer.files).map(function(t){return t.getAsFile&&"file"===t.kind?t.getAsFile():t});i.fire("drop",e)};return t.addEventListener("dragover",a),t.addEventListener("drop",c),i},lu=function(t){var e=function(e){if(9===e.keyCode){var n=w()(t.querySelectorAll("button,input,[tabindex]")).filter(function(t){return"hidden"!==t.style.visibility&&-1!==t.tabIndex}),r=n[0],i=n[n.length-1];e.shiftKey?document.activeElement===r&&(i.focus(),e.preventDefault()):document.activeElement===i&&(r.focus(),e.preventDefault())}};return t.addEventListener("keydown",e),{destroy:function(){t.removeEventListener("keydown",e)}}},su=function(t){return t.ref.isFullscreen},fu=function(t){return/fullscreen/.test(t.query("GET_STYLE_LAYOUT_MODE"))},du=function(t){return/fullscreen|preview/.test(t.query("GET_STYLE_LAYOUT_MODE"))},hu=function(t){return/modal/.test(t.query("GET_STYLE_LAYOUT_MODE"))},pu=function(t){return t.query("GET_ALLOW_AUTO_CLOSE")},vu=du,gu=du,mu=function(t){var e=t.ref,n=e.environment,r=e.isSingleUtil,i=e.canBeControlled;t.element.dataset.styleViewport=wu(t.rect.element.width,t.rect.element.height)+" "+n.join(" ")+(r?" single-util":" multi-util")+(i?" flow-controls":" no-flow-controls")},yu=function(t){var e=t.element,n=t.ref,r=n.handleFullscreenUpdate,i=n.handleEscapeKey;e.setAttribute("tabindex",-1),r(),t.ref.focusTrap=lu(e),e.addEventListener("keydown",i),window.addEventListener("resize",r),window.innerWidth-document.documentElement.clientWidth>0&&document.body.classList.add("doka--parent"),document.body.appendChild(e);var o=document.querySelector("meta[name=viewport]");t.ref.defaultViewportContent=o?o.getAttribute("content"):null,o||((o=document.createElement("meta")).setAttribute("name","viewport"),document.head.appendChild(o)),o.setAttribute("content","width=device-width, height=device-height, initial-scale=1, maximum-scale=1, user-scalable=0"),t.opacity=1,t.element.contains(document.activeElement)||e.focus(),t.dispatch("INVALIDATE_VIEWPORT"),t.ref.isFullscreen=!0},Eu=function(t){var e=t.element,n=t.ref,r=n.handleFullscreenUpdate,i=n.focusTrap,o=n.handleEscapeKey;e.removeAttribute("tabindex"),i.destroy(),e.removeEventListener("keydown",o),window.removeEventListener("resize",r),document.body.classList.remove("doka--parent");var a=document.querySelector("meta[name=viewport]");t.ref.defaultViewportContent?(a.setAttribute("content",t.ref.defaultViewportContent),t.ref.defaultViewportContent=null):a.parentNode.removeChild(a),t.ref.isFullscreen=!1},_u=Bt({name:"root",ignoreRect:!0,mixins:{styles:["opacity"],animations:{opacity:{type:"tween",duration:350}}},create:function(t){var e=t.root,n=t.props;e.element.id=e.query("GET_ID")||"doka-".concat(n.id);var r=e.query("GET_CLASS_NAME");r&&e.element.classList.add(r),e.ref.environment=[],e.ref.shouldBeDestroyed=!1,e.ref.isClosing=!1,e.ref.isClosed=!1,e.ref.isFullscreen=!1,e.query("GET_ALLOW_DROP_FILES")&&(e.ref.catcher=uu(e.element),e.ref.catcher.on("drop",function(t){t.forEach(function(t){e.dispatch("REQUEST_LOAD_IMAGE",{source:t})})})),e.ref.touchDetector=cu(),e.ref.touchDetector.onOnce("touch-detected",function(){e.ref.environment.push("touch")}),e.ref.editor=e.appendChildView(e.createChildView(au,{id:n.id})),e.query("GET_STYLES").filter(function(t){return!qt(t.value)}).map(function(t){var n=t.name,r=t.value;e.element.dataset[n]=r}),e.ref.updateViewport=function(){e.dispatch("INVALIDATE_VIEWPORT")},window.addEventListener("resize",e.ref.updateViewport),window.addEventListener("scroll",e.ref.updateViewport),e.ref.isSingleUtil=1===e.query("GET_UTILS").length,e.ref.canBeControlled=e.query("GET_ALLOW_BUTTON_CONFIRM")||e.query("GET_ALLOW_BUTTON_CANCEL"),mu(e);var i=document.createElement("div");i.style.cssText="position:fixed;height:100vh;top:0;",e.ref.measure=i,document.body.appendChild(i),e.ref.handleEscapeKey=function(t){27===t.keyCode&&e.dispatch("EDIT_CANCEL")},e.ref.initialScreenMeasureHeight=null,e.ref.handleFullscreenUpdate=function(){e.element.dataset.styleFullscreen=window.innerHeight===e.ref.initialScreenMeasureHeight},e.ref.clientRect={left:0,top:0},hu(e)&&(e.ref.handleModalTap=function(t){t.target===e.element&&e.dispatch("EDIT_CANCEL")},e.element.addEventListener("pointerdown",e.ref.handleModalTap))},read:function(t){var e=t.root,n=e.ref.measure;n&&(e.ref.initialScreenMeasureHeight=n.offsetHeight,n.parentNode.removeChild(n),e.ref.measure=null),e.ref.clientRect=e.element.getBoundingClientRect(),e.ref.clientRect.leftScroll=e.ref.clientRect.left+(window.scrollX||window.pageXOffset),e.ref.clientRect.topScroll=e.ref.clientRect.top+(window.scrollY||window.pageYOffset)},write:zt({ENTER_FULLSCREEN:function(t){var e=t.root;yu(e)},EXIT_FULLSCREEN:function(t){var e=t.root;Eu(e)},SHOW_VIEW:function(t){var e=t.root,n=t.action;e.element.dataset.view=n.id},DID_SET_STYLE_LAYOUT_MODE:function(t){var e=t.root,n=t.action;e.element.dataset.styleLayoutMode=n.value||"none",/fullscreen/.test(n.value)&&!/fullscreen/.test(n.prevValue)&&e.dispatch("ENTER_FULLSCREEN")},AWAITING_IMAGE:function(t){var e=t.root;e.ref.catcher&&e.query("GET_ALLOW_BROWSE_FILES")&&e.ref.catcher.enableBrowse()},DID_REQUEST_LOAD_IMAGE:function(t){var e=t.root;if(e.ref.catcher&&e.query("GET_ALLOW_BROWSE_FILES")&&e.ref.catcher.disableBrowse(),0===e.opacity&&(e.opacity=1),e.ref.isClosing=!1,e.ref.isClosed=!1,!fu(e)||su(e)){var n=e.query("GET_STYLE_LAYOUT_MODE");null!==n&&"modal"!==n||e.element.parentNode||e.dispatch("SET_STYLE_LAYOUT_MODE",{value:("fullscreen "+(n||"")).trim()})}else e.dispatch("ENTER_FULLSCREEN")},DID_CANCEL:function(t){var e=t.root;vu(e)&&pu(e)&&e.dispatch("EDIT_CLOSE")},DID_CONFIRM:function(t){var e=t.root;vu(e)&&pu(e)&&e.dispatch("EDIT_CLOSE")},EDIT_CLOSE:function(t){var e=t.root;gu(e)&&(e.opacity=e.opacity||1,e.opacity=0,e.ref.isClosed=!1,e.ref.isClosing=!0,e.query("GET_ALLOW_AUTO_DESTROY")&&(e.ref.shouldBeDestroyed=!0),su(e)&&e.dispatch("EXIT_FULLSCREEN"))},DID_SET_UTILS:function(t){var e=t.root;e.ref.isSingleUtil=1===e.query("GET_UTILS").length}},function(t){var e=t.root;mu(e);var n=e.query("GET_ROOT"),r=e.rect.element;n.width===r.width&&n.height===r.height&&n.y===e.ref.clientRect.top&&n.topScroll===e.ref.clientRect.topScroll||e.dispatch("UPDATE_ROOT_RECT",{rect:{x:e.ref.clientRect.left,y:e.ref.clientRect.top,left:e.ref.editor.rect.element.left,top:e.ref.editor.rect.element.top,leftScroll:e.ref.clientRect.leftScroll,topScroll:e.ref.clientRect.topScroll,width:e.rect.element.width,height:e.rect.element.height}})}),didWriteView:function(t){var e=t.root,n=e.ref,r=n.isClosed,i=n.isClosing,o=n.shouldBeDestroyed;!r&&i&&0===e.opacity&&(e.dispatch("DID_CLOSE"),e.ref.isClosed=!0,e.ref.isClosing=!1,fu(e)&&e.element.parentNode&&document.body.removeChild(e.element),o&&e.dispatch("EDIT_DESTROY"))},destroy:function(t){var e=t.root;su(e)&&Eu(e),hu(e)&&e.element.removeEventListener("pointerdown",e.ref.handleModalTap),fu(e)&&e.element.parentNode&&document.body.removeChild(e.element),window.removeEventListener("resize",e.ref.updateViewport),e.ref.touchDetector.destroy(),e.ref.catcher&&e.ref.catcher.destroy()}}),wu=function(t,e){var n="";return 0===t&&0===e?"detached":(n+=e>t?"portrait":"landscape",(n+=t<=600?" x-cramped":t<=1e3?" x-comfortable":" x-spacious").trim())},Tu=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Re(),n=nt(he(e),[kn,me(e)],[ho,ge(e)]);n.dispatch("SET_OPTIONS",{options:t});var r=function(){document.hidden||n.dispatch("KICK")};document.addEventListener("visibilitychange",r);var i=ye();n.dispatch("SET_UID",{id:i});var o=null,a=_u(n,{id:i}),c=!1,u={_read:function(){c||a._read()},_write:function(t){var e=n.processActionQueue().filter(function(t){return!/^SET_/.test(t.type)});c&&!e.length||(d(e),(c=a._write(t,e))&&n.processDispatchQueue(),e.find(function(t){return"EDIT_DESTROY"===t.type})&&h())}},l=function(t){return function(e){var n={type:t};return e?(e.hasOwnProperty("error")&&(n.error=et(e.error)?z({},e.error):e.error||null),e.hasOwnProperty("output")&&(n.output=e.output),e.hasOwnProperty("image")&&(n.image=e.image),e.hasOwnProperty("source")&&(n.source=e.source),e.hasOwnProperty("state")&&(n.state=e.state),n):n}},s={DID_CONFIRM:l("confirm"),DID_CANCEL:l("cancel"),DID_REQUEST_LOAD_IMAGE:l("loadstart"),DID_LOAD_IMAGE:l("load"),DID_LOAD_IMAGE_ERROR:l("loaderror"),DID_UPDATE:l("update"),DID_CLOSE:l("close"),DID_DESTROY:l("destroy"),DID_INIT:l("init")},d=function(t){t.length&&t.forEach(function(t){if(s[t.type]){var e=s[t.type];(b()(e)?e:[e]).forEach(function(e){setTimeout(function(){!function(t){var e=z({doka:p},t);delete e.type,a&&a.element.dispatchEvent(new CustomEvent("Doka:".concat(t.type),{detail:e,bubbles:!0,cancelable:!0,composed:!0}));var r=[];t.hasOwnProperty("error")&&r.push(t.error);var i=["type","error"];L()(t).filter(function(t){return!i.includes(t)}).forEach(function(e){return r.push(t[e])}),p.fire.apply(p,[t.type].concat(r));var o=n.query("GET_ON".concat(t.type.toUpperCase()));o&&o.apply(void 0,r)}(e(t.data))},0)})}})},h=function(){p.fire("destroy",a.element),document.removeEventListener("visibilitychange",r),a._destroy(),n.dispatch("DID_DESTROY")},p=z({},_e(),u,ve(n,e),{setOptions:function(t){return n.dispatch("SET_OPTIONS",{options:t})},setData:function(t){n.dispatch("SET_DATA",t)},getData:function(t){return new f.a(function(e,r){n.dispatch("GET_DATA",z({},t,{success:e,failure:r}))})},open:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new f.a(function(r,i){t&&n.dispatch("REQUEST_LOAD_IMAGE",{source:t,options:e,success:r,failure:i,resolveOnConfirm:!!e&&e.resolveOnConfirm})})},edit:function(t,e){return p.open(t,z({},e,{resolveOnConfirm:!0}))},save:function(t){return new f.a(function(e,r){n.dispatch("GET_DATA",z({},t,{success:e,failure:r}))})},clear:function(){return n.dispatch("REQUEST_REMOVE_IMAGE")},close:function(){return n.dispatch("EDIT_CLOSE")},destroy:h,insertBefore:function(t){J(a.element,t)},insertAfter:function(t){tt(a.element,t)},appendTo:function(t){t.appendChild(a.element)},replaceElement:function(t){J(a.element,t),t.parentNode.removeChild(t),o=t},restoreElement:function(){o&&(tt(o,a.element),a.element.parentNode.removeChild(a.element),o=null)},isAttachedTo:function(t){return!!a&&(a.element===t||o===t)},element:{get:function(){return a?a.element:null}}});return n.dispatch("DID_INIT"),ot(p)},xu=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Re(),n={};return it(e,function(t,e){Kt(e)||(n[t]=e[0])}),Tu(z({},n,t))},Ru=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t.replace(new RegExp("".concat(e,"."),"g"),function(t){return t.charAt(1).toUpperCase()})},bu=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},Au=function(t){return Ru(t.replace(/^data-/,""))},Iu=function t(e,n){it(n,function(n,r){it(e,function(t,i){var o=new RegExp(n);if(o.test(t)&&(delete e[t],!1!==r))if(Kt(r))e[r]=i;else{var a=r.group;et(r)&&!e[a]&&(e[a]={}),e[a][bu(t.replace(o,""))]=i}}),r.mapping&&t(e[r.group],r.mapping)})},Cu=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];it(t.attributes,function(e){return n.push(t.attributes[e])});var r=n.filter(function(t){return t.name}).reduce(function(e,n){var r=at(t,n.name);return e[Au(n.name)]=r===n.name||r,e},{});return Iu(r,e),r},Su=function(t){var e=z({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=Cu(t,{"^class$":"className"});L()(n).forEach(function(t){et(n[t])?(et(e[t])||(e[t]={}),m()(e[t],n[t])):e[t]=n[t]}),"CANVAS"!==t.nodeName&&"IMG"!==t.nodeName||(e.src=t.dataset.dokaSrc?t.dataset.dokaSrc:t);var r=xu(e);return r.replaceElement(t),r},Ou=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Q(e[0])?Su.apply(void 0,e):xu.apply(void 0,Y(e.filter(function(t){return t})))},Lu=function(t,e,n){o()(t).filter(function(t){return!n.includes(t)}).forEach(function(n){return P()(e,n,I()(t,n))})},Mu=["fire","_read","_write"],Pu=function(t){var e={};return Lu(t,e,Mu),e},Gu=function(){return"[object OperaMini]"===Object.prototype.toString.call(window.operamini)},ku=function(){return"Promise"in window},Du=function(){return"slice"in Blob.prototype},Uu=function(){return"URL"in window&&"createObjectURL"in window.URL},Nu=function(){return"visibilityState"in document},Vu=function(){return"performance"in window},Bu=function(){var t=Ut()&&!Gu()&&Nu()&&ku()&&Du()&&Uu()&&Vu();return function(){return t}}(),Fu={apps:[]},zu="doka",Wu=function(){},qu={},Yu=Wu,Hu=Wu,ju=Wu,Zu=Wu,Xu=Wu,Ku=Wu;if(Bu()){Ft(function(){Fu.apps.forEach(function(t){return t._read()})},function(t){Fu.apps.forEach(function(e){return e._write(t)})});var $u=function t(){document.dispatchEvent(new CustomEvent("doka:loaded",{detail:{supported:Bu,create:Yu,destroy:Hu,parse:ju,find:Zu,setOptions:Ku}})),document.removeEventListener("DOMContentLoaded",t)};"loading"!==document.readyState?setTimeout(function(){return $u()},0):document.addEventListener("DOMContentLoaded",$u);var Qu=function(){return it(Re(),function(t,e){qu[t]=e[1]})};qu={},Qu(),Yu=function(){var t=Ou.apply(void 0,arguments);return t.on("destroy",Hu),Fu.apps.push(t),Pu(t)},Hu=function(t){var e=Fu.apps.findIndex(function(e){return e.isAttachedTo(t)});return e>=0&&(Fu.apps.splice(e,1)[0].restoreElement(),!0)},ju=function(t){return w()(t.querySelectorAll(".".concat(zu))).filter(function(t){return!Fu.apps.find(function(e){return e.isAttachedTo(t)})}).map(function(t){return Yu(t)})},Zu=function(t){var e=Fu.apps.find(function(e){return e.isAttachedTo(t)});return e?Pu(e):null},Xu=function(){var t={};return it(Re(),function(e,n){t[e]=n[0]}),t},Ku=function(t){return et(t)&&(Fu.apps.forEach(function(e){e.setOptions(t)}),be(t)),Xu()}}n("96e3");var Ju=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"doka-container"},[n("div",[t._t("default")],2)])},tl=[],el=n("8bbf"),nl=n.n(el),rl=Bu(),il=L()(qu).filter(function(t){return/^on/.test(t)}),ol=["id","class"],al=["setOptions","on","off","onOnce","appendTo","insertAfter","insertBefore","isAttachedTo","replaceElement","restoreElement","destroy"],cl=L()(qu).filter(function(t){return!ol.includes(t)});cl.push("enabled");var ul=function(t){return L()(t).filter(function(e){return"undefined"!==typeof t[e]}).filter(function(t){return cl.find(function(e){return e.toLowerCase()===t.toLowerCase()})}).reduce(function(e,n){return e[/^on/.test(n)?n.toLocaleLowerCase():n]=t[n],e},{})},ll=function(t,e){return t.setOptions(ul(e))},sl=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(rl){var r=il.reduce(function(e,n){return e[n]=function(){for(var e=n.substr(2),r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];t.$emit.apply(t,[e].concat(i))},e},{}),i=[m()({},r,ul(n))];e&&i.unshift(e);var o=Yu.apply(void 0,i);return L()(o).filter(function(t){return!al.includes(t)}).forEach(function(e){t[e]=o[e]}),o}},fl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return{}};return nl.a.extend(m()(t,{props:cl,methods:{update:function(){var t=this.$props.enabled;t||"undefined"===typeof t?this.show():this.hide()},show:function(){var t=this;if(this._instance)return ll(this._instance,this.$props);this.$nextTick(function(){t._root=t.$el&&t.$el.classList?t.$el.classList.contains(".doka-container")?t.$el.firstChild:t.$el.querySelector(".doka-container > div"):null,t._instance=sl(t,t._root,m()({},t.$props,e(t)))})},hide:function(){this._instance&&this._instance.close()}},mounted:function(){var t=this;this.$watch("$props",function(){t.update()},{deep:!0}),this.update()},beforeDestroy:function(){this._instance&&this._instance.destroy()}}))},dl=fl({name:"Doka"}),hl=dl;function pl(t,e,n,r,i,o,a,c){var u,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=u):i&&(u=c?function(){i.call(this,this.$root.$options.shadowRoot)}:i),u)if(l.functional){l._injectStyles=u;var s=l.render;l.render=function(t,e){return u.call(e),s(t,e)}}else{var f=l.beforeCreate;l.beforeCreate=f?[].concat(f,u):[u]}return{exports:t,options:l}}var vl,gl,ml=pl(hl,Ju,tl,!1,null,null,null),yl=ml.exports,El=fl({name:"DokaModal",render:function(){return null}}),_l=El,wl=pl(_l,vl,gl,!1,null,null,null),Tl=wl.exports,xl=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"doka-overlay"},[t._t("default"),t._m(0)],2)},Rl=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"doka-container"},[n("div")])}],bl=fl({name:"DokaOverlay"},function(t){return{styleLayoutMode:"preview",outputData:!0,onclose:function(){t._instance.destroy(),t._instance=null}}}),Al=bl,Il=(n("68a3"),pl(Al,xl,Rl,!1,null,null,null)),Cl=Il.exports,Sl=function(t){return t instanceof Blob?URL.createObjectURL(t):t},Ol=Bu();n.d(e,"Doka",function(){return yl}),n.d(e,"DokaModal",function(){return Tl}),n.d(e,"DokaOverlay",function(){return Cl}),n.d(e,"toURL",function(){return Sl}),n.d(e,"isSupported",function(){return Ol})},fde4:function(t,e,n){n("bf90");var r=n("584a").Object;t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)}}})});
//# sourceMappingURL=Doka.umd.min.js.map